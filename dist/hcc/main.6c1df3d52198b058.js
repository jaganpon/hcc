"use strict";(self.webpackChunkMaterialpro=self.webpackChunkMaterialpro||[]).push([[792],{141:()=>{function Qs(t,e,n,r,o,i,s){try{var a=t[i](s),c=a.value}catch(l){return void n(l)}a.done?e(c):Promise.resolve(c).then(r,o)}function y(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function s(c){Qs(i,r,o,s,a,"next",c)}function a(c){Qs(i,r,o,s,a,"throw",c)}s(void 0)})}}let Le=null,Ys=!1,bp=1;const $e=Symbol("SIGNAL");function Y(t){const e=Le;return Le=t,e}const co={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function ui(t){if(Ys)throw new Error("");if(null===Le)return;Le.consumerOnSignalRead(t);const e=Le.nextProducerIndex++;Dl(Le),e<Le.producerNode.length&&Le.producerNode[e]!==t&&ea(Le)&&Sl(Le.producerNode[e],Le.producerIndexOfThis[e]),Le.producerNode[e]!==t&&(Le.producerNode[e]=t,Le.producerIndexOfThis[e]=ea(Le)?l_(t,Le,e):0),Le.producerLastReadVersion[e]=t.version}function Js(t){if((!ea(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==bp)){if(!t.producerMustRecompute(t)&&!Zs(t))return void wl(t);t.producerRecomputeValue(t),wl(t)}}function s_(t){if(void 0===t.liveConsumerNode)return;const e=Ys;Ys=!0;try{for(const n of t.liveConsumerNode)n.dirty||c_(n)}finally{Ys=e}}function c_(t){t.dirty=!0,s_(t),t.consumerMarkedDirty?.(t)}function wl(t){t.dirty=!1,t.lastCleanEpoch=bp}function lo(t){return t&&(t.nextProducerIndex=0),Y(t)}function di(t,e){if(Y(e),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(ea(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Sl(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function Zs(t){Dl(t);for(let e=0;e<t.producerNode.length;e++){const n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(Js(n),r!==n.version))return!0}return!1}function Xs(t){if(Dl(t),ea(t))for(let e=0;e<t.producerNode.length;e++)Sl(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function l_(t,e,n){if(u_(t),0===t.liveConsumerNode.length&&d_(t))for(let r=0;r<t.producerNode.length;r++)t.producerIndexOfThis[r]=l_(t.producerNode[r],t,r);return t.liveConsumerIndexOfThis.push(n),t.liveConsumerNode.push(e)-1}function Sl(t,e){if(u_(t),1===t.liveConsumerNode.length&&d_(t))for(let r=0;r<t.producerNode.length;r++)Sl(t.producerNode[r],t.producerIndexOfThis[r]);const n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){const r=t.liveConsumerIndexOfThis[e],o=t.liveConsumerNode[e];Dl(o),o.producerIndexOfThis[r]=e}}function ea(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Dl(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function u_(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function d_(t){return void 0!==t.producerNode}let f_=function R0(){throw new Error};function bl(t,e){(function a_(){return!1!==Le?.consumerAllowSignalWrites})()||function h_(){f_()}(),t.equal(t.value,e)||(t.value=e,function k0(t){t.version++,function D0(){bp++}(),s_(t)}(t))}const Mp={...co,equal:function Tl(t,e){return Object.is(t,e)},value:void 0,kind:"signal"};function we(t){return"function"==typeof t}function kp(t){const n=t(r=>{Error.call(r),r.stack=(new Error).stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}const Op=kp(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:\n${n.map((r,o)=>`${o+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=n});function Pp(t,e){if(t){const n=t.indexOf(e);0<=n&&t.splice(n,1)}}class gt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(const i of n)i.remove(this);else n.remove(this);const{initialTeardown:r}=this;if(we(r))try{r()}catch(i){e=i instanceof Op?i.errors:[i]}const{_finalizers:o}=this;if(o){this._finalizers=null;for(const i of o)try{v_(i)}catch(s){e=e??[],s instanceof Op?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Op(e)}}add(e){var n;if(e&&e!==this)if(this.closed)v_(e);else{if(e instanceof gt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(e)}}_hasParent(e){const{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){const{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){const{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Pp(n,e)}remove(e){const{_finalizers:n}=this;n&&Pp(n,e),e instanceof gt&&e._removeParent(this)}}gt.EMPTY=(()=>{const t=new gt;return t.closed=!0,t})();const m_=gt.EMPTY;function y_(t){return t instanceof gt||t&&"closed"in t&&we(t.remove)&&we(t.add)&&we(t.unsubscribe)}function v_(t){we(t)?t():t.unsubscribe()}const fo={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Rl={setTimeout(t,e,...n){const{delegate:r}=Rl;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){const{delegate:e}=Rl;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function C_(t){Rl.setTimeout(()=>{const{onUnhandledError:e}=fo;if(!e)throw t;e(t)})}function xp(){}const U0=Fp("C",void 0,void 0);function Fp(t,e,n){return{kind:t,value:e,error:n}}let ho=null;function Ml(t){if(fo.useDeprecatedSynchronousErrorHandling){const e=!ho;if(e&&(ho={errorThrown:!1,error:null}),t(),e){const{errorThrown:n,error:r}=ho;if(ho=null,n)throw r}}else t()}class Lp extends gt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,y_(e)&&e.add(this)):this.destination=G0}static create(e,n,r){return new Hp(e,n,r)}next(e){this.isStopped?Bp(function B0(t){return Fp("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Bp(function H0(t){return Fp("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Bp(U0,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const V0=Function.prototype.bind;function Up(t,e){return V0.call(t,e)}class $0{constructor(e){this.partialObserver=e}next(e){const{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Nl(r)}}error(e){const{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Nl(r)}else Nl(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Nl(n)}}}class Hp extends Lp{constructor(e,n,r){let o;if(super(),we(e)||!e)o={next:e??void 0,error:n??void 0,complete:r??void 0};else{let i;this&&fo.useDeprecatedNextContext?(i=Object.create(e),i.unsubscribe=()=>this.unsubscribe(),o={next:e.next&&Up(e.next,i),error:e.error&&Up(e.error,i),complete:e.complete&&Up(e.complete,i)}):o=e}this.destination=new $0(o)}}function Nl(t){fo.useDeprecatedSynchronousErrorHandling?function j0(t){fo.useDeprecatedSynchronousErrorHandling&&ho&&(ho.errorThrown=!0,ho.error=t)}(t):C_(t)}function Bp(t,e){const{onStoppedNotification:n}=fo;n&&Rl.setTimeout(()=>n(t,e))}const G0={closed:!0,next:xp,error:function z0(t){throw t},complete:xp},jp="function"==typeof Symbol&&Symbol.observable||"@@observable";function po(t){return t}let ze=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){const r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,o){const i=function W0(t){return t&&t instanceof Lp||function K0(t){return t&&we(t.next)&&we(t.error)&&we(t.complete)}(t)&&y_(t)}(n)?n:new Hp(n,r,o);return Ml(()=>{const{operator:s,source:a}=this;i.add(s?s.call(i,a):a?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return new(r=I_(r))((o,i)=>{const s=new Hp({next:a=>{try{n(a)}catch(c){i(c),s.unsubscribe()}},error:i,complete:o});this.subscribe(s)})}_subscribe(n){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(n)}[jp](){return this}pipe(...n){return function E_(t){return 0===t.length?po:1===t.length?t[0]:function(n){return t.reduce((r,o)=>o(r),n)}}(n)(this)}toPromise(n){return new(n=I_(n))((r,o)=>{let i;this.subscribe(s=>i=s,s=>o(s),()=>r(i))})}}return t.create=e=>new t(e),t})();function I_(t){var e;return null!==(e=t??fo.Promise)&&void 0!==e?e:Promise}const Q0=kp(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let mt=(()=>{class t extends ze{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){const r=new __(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Q0}next(n){Ml(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(n)}})}error(n){Ml(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;const{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Ml(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return(null===(n=this.observers)||void 0===n?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){const{hasError:r,isStopped:o,observers:i}=this;return r||o?m_:(this.currentObservers=null,i.push(n),new gt(()=>{this.currentObservers=null,Pp(i,n)}))}_checkFinalizedStatuses(n){const{hasError:r,thrownError:o,isStopped:i}=this;r?n.error(o):i&&n.complete()}asObservable(){const n=new ze;return n.source=this,n}}return t.create=(e,n)=>new __(e,n),t})();class __ extends mt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.next)||void 0===r||r.call(n,e)}error(e){var n,r;null===(r=null===(n=this.destination)||void 0===n?void 0:n.error)||void 0===r||r.call(n,e)}complete(){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===n||n.call(e)}_subscribe(e){var n,r;return null!==(r=null===(n=this.source)||void 0===n?void 0:n.subscribe(e))&&void 0!==r?r:m_}}class zt extends mt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){const{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function it(t){return e=>{if(function T_(t){return we(t?.lift)}(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function et(t,e,n,r,o){return new Y0(t,e,n,r,o)}class Y0 extends Lp{constructor(e,n,r,o,i,s){super(e),this.onFinalize=i,this.shouldUnsubscribe=s,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=o?function(a){try{o(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function oe(t,e){return it((n,r)=>{let o=0;n.subscribe(et(r,i=>{r.next(t.call(e,i,o++))}))})}class S extends Error{code;constructor(e,n){super(function go(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,n)),this.code=e}}const kl=Symbol("InputSignalNode#UNSET"),S_={...Mp,transformFn:void 0,applyValueToInputSignal(t,e){bl(t,e)}};function D_(t,e){const n=Object.create(S_);function r(){if(ui(n),n.value===kl)throw new S(-950,!1);return n.value}return n.value=t,n.transformFn=e?.transform,r[$e]=n,r}function er(t){return{toString:t}.toString()}function le(t){for(let e in t)if(t[e]===le)return e;throw Error("Could not find renamed property on target object.")}function Ge(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Ge).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function $p(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}globalThis;const Z0=le({__forward_ref__:le});function zp(t){return t.__forward_ref__=zp,t.toString=function(){return Ge(this())},t}function j(t){return function Ol(t){return"function"==typeof t&&t.hasOwnProperty(Z0)&&t.__forward_ref__===zp}(t)?t():t}function x(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Pl(t){return{providers:t.providers||[],imports:t.imports||[]}}function xl(t){return b_(t,Ll)||b_(t,R_)}function b_(t,e){return t.hasOwnProperty(e)?t[e]:null}function Fl(t){return t&&(t.hasOwnProperty(Gp)||t.hasOwnProperty(ox))?t[Gp]:null}const Ll=le({\u0275prov:le}),Gp=le({\u0275inj:le}),R_=le({ngInjectableDef:le}),ox=le({ngInjectorDef:le});class R{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,n){this._desc=e,this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=x({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Wp(t){return t&&!!t.\u0275providers}const yi=le({\u0275cmp:le}),Qp=le({\u0275dir:le}),Yp=le({\u0275pipe:le}),tr=le({\u0275fac:le}),ta=le({__NG_ELEMENT_ID__:le}),k_=le({__NG_ENV_ID__:le});function q(t){return"string"==typeof t?t:null==t?"":String(t)}function Jp(t,e){throw new S(-201,!1)}var te=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(te||{});let Zp;function O_(){return Zp}function Ot(t){const e=Zp;return Zp=t,e}function P_(t,e,n){const r=xl(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&te.Optional?null:void 0!==e?e:void Jp()}const na={},Bl="ngTempTokenPath",ux=/\n/gm,x_="__source";let vi;function Ir(t){const e=vi;return vi=t,e}function hx(t,e=te.Default){if(void 0===vi)throw new S(-203,!1);return null===vi?P_(t,void 0,e):vi.get(t,e&te.Optional?null:void 0,e)}function L(t,e=te.Default){return(O_()||hx)(j(t),e)}function _(t,e=te.Default){return L(t,jl(e))}function jl(t){return typeof t>"u"||"number"==typeof t?t:(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function eg(t){const e=[];for(let n=0;n<t.length;n++){const r=j(t[n]);if(Array.isArray(r)){if(0===r.length)throw new S(900,!1);let o,i=te.Default;for(let s=0;s<r.length;s++){const a=r[s],c=px(a);"number"==typeof c?-1===c?o=a.token:i|=c:o=a}e.push(L(o,i))}else e.push(L(r))}return e}function px(t){return t.__NG_DI_FLAG__}function mo(t,e){return t.hasOwnProperty(tr)?t[tr]:null}function Ci(t,e){t.forEach(n=>Array.isArray(n)?Ci(n,e):e(n))}function L_(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Vl(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}const On={},ie=[],en=new R(""),B_=new R("",-1),ig=new R("");class zl{get(e,n=na){if(n===na){const r=new Error(`NullInjectorError: No provider for ${Ge(e)}!`);throw r.name="NullInjectorError",r}return n}}function J(t){return t[yi]||null}function qe(t){return t[Qp]||null}function st(t){return t[Yp]||null}function Ix(...t){return{\u0275providers:sg(0,t),\u0275fromNgModule:!0}}function sg(t,...e){const n=[],r=new Set;let o;const i=s=>{n.push(s)};return Ci(e,s=>{const a=s;Gl(a,i,[],r)&&(o||=[],o.push(a))}),void 0!==o&&j_(o,i),n}function j_(t,e){for(let n=0;n<t.length;n++){const{ngModule:r,providers:o}=t[n];ag(o,i=>{e(i,r)})}}function Gl(t,e,n,r){if(!(t=j(t)))return!1;let o=null,i=Fl(t);const s=!i&&J(t);if(i||s){if(s&&!s.standalone)return!1;o=t}else{const c=t.ngModule;if(i=Fl(c),!i)return!1;o=c}const a=r.has(o);if(s){if(a)return!1;if(r.add(o),s.dependencies){const c="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const l of c)Gl(l,e,n,r)}}else{if(!i)return!1;{if(null!=i.imports&&!a){let l;r.add(o);try{Ci(i.imports,u=>{Gl(u,e,n,r)&&(l||=[],l.push(u))})}finally{}void 0!==l&&j_(l,e)}if(!a){const l=mo(o)||(()=>new o);e({provide:o,useFactory:l,deps:ie},o),e({provide:ig,useValue:o,multi:!0},o),e({provide:en,useValue:()=>L(o),multi:!0},o)}const c=i.providers;if(null!=c&&!a){const l=t;ag(c,u=>{e(u,l)})}}}return o!==t&&void 0!==t.providers}function ag(t,e){for(let n of t)Wp(n)&&(n=n.\u0275providers),Array.isArray(n)?ag(n,e):e(n)}const _x=le({provide:String,useValue:le});function cg(t){return null!==t&&"object"==typeof t&&_x in t}function yo(t){return"function"==typeof t}const lg=new R(""),ql={},wx={};let ug;function Kl(){return void 0===ug&&(ug=new zl),ug}class xt{}class vo extends xt{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,n,r,o){super(),this.parent=n,this.source=r,this.scopes=o,fg(e,s=>this.processProvider(s)),this.records.set(B_,Ii(void 0,this)),o.has("environment")&&this.records.set(xt,Ii(void 0,this));const i=this.records.get(lg);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(ig,ie,te.Self))}destroy(){oa(this),this._destroyed=!0;const e=Y(null);try{for(const r of this._ngOnDestroyHooks)r.ngOnDestroy();const n=this._onDestroyHooks;this._onDestroyHooks=[];for(const r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Y(e)}}onDestroy(e){return oa(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){oa(this);const n=Ir(this),r=Ot(void 0);try{return e()}finally{Ir(n),Ot(r)}}get(e,n=na,r=te.Default){if(oa(this),e.hasOwnProperty(k_))return e[k_](this);r=jl(r);const i=Ir(this),s=Ot(void 0);try{if(!(r&te.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function Rx(t){return"function"==typeof t||"object"==typeof t&&t instanceof R}(e)&&xl(e);c=l&&this.injectableDefInScope(l)?Ii(dg(e),ql):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(r&te.Self?Kl():this.parent).get(e,n=r&te.Optional&&n===na?null:n)}catch(a){if("NullInjectorError"===a.name){if((a[Bl]=a[Bl]||[]).unshift(Ge(e)),i)throw a;return function gx(t,e,n,r){const o=t[Bl];throw e[x_]&&o.unshift(e[x_]),t.message=function mx(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let o=Ge(e);if(Array.isArray(e))o=e.map(Ge).join(" -> ");else if("object"==typeof e){let i=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];i.push(s+":"+("string"==typeof a?JSON.stringify(a):Ge(a)))}o=`{${i.join(", ")}}`}return`${n}${r?"("+r+")":""}[${o}]: ${t.replace(ux,"\n  ")}`}("\n"+t.message,o,n,r),t.ngTokenPath=o,t[Bl]=null,t}(a,e,"R3InjectorError",this.source)}throw a}finally{Ot(s),Ir(i)}}resolveInjectorInitializers(){const e=Y(null),n=Ir(this),r=Ot(void 0);try{const i=this.get(en,ie,te.Self);for(const s of i)s()}finally{Ir(n),Ot(r),Y(e)}}toString(){const e=[],n=this.records;for(const r of n.keys())e.push(Ge(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){let n=yo(e=j(e))?e:j(e&&e.provide);const r=function Dx(t){return cg(t)?Ii(void 0,t.useValue):Ii(function z_(t,e,n){let r;if(yo(t)){const o=j(t);return mo(o)||dg(o)}if(cg(t))r=()=>j(t.useValue);else if(function $_(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...eg(t.deps||[]));else if(function V_(t){return!(!t||!t.useExisting)}(t))r=()=>L(j(t.useExisting));else{const o=j(t&&(t.useClass||t.provide));if(!function Ax(t){return!!t.deps}(t))return mo(o)||dg(o);r=()=>new o(...eg(t.deps))}return r}(t),ql)}(e);if(!yo(e)&&!0===e.multi){let o=this.records.get(n);o||(o=Ii(void 0,ql,!0),o.factory=()=>eg(o.multi),this.records.set(n,o)),n=e,o.multi.push(e)}this.records.set(n,r)}hydrate(e,n){const r=Y(null);try{return n.value===ql&&(n.value=wx,n.value=n.factory()),"object"==typeof n.value&&n.value&&function bx(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{Y(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;const n=j(e.providedIn);return"string"==typeof n?"any"===n||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){const n=this._onDestroyHooks.indexOf(e);-1!==n&&this._onDestroyHooks.splice(n,1)}}function dg(t){const e=xl(t),n=null!==e?e.factory:mo(t);if(null!==n)return n;if(t instanceof R)throw new S(204,!1);if(t instanceof Function)return function Sx(t){if(t.length>0)throw new S(204,!1);const n=function rx(t){return t&&(t[Ll]||t[R_])||null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new S(204,!1)}function oa(t){if(t.destroyed)throw new S(205,!1)}function Ii(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function fg(t,e){for(const n of t)Array.isArray(n)?fg(n,e):n&&Wp(n)?fg(n.\u0275providers,e):e(n)}function pn(t,e){t instanceof vo&&oa(t);const r=Ir(t),o=Ot(void 0);try{return e()}finally{Ir(r),Ot(o)}}const B=11,N=25;function Me(t){return Array.isArray(t)&&"object"==typeof t[1]}function We(t){return Array.isArray(t)&&!0===t[1]}function gg(t){return!!(4&t.flags)}function tn(t){return t.componentOffset>-1}function Zl(t){return!(1&~t.flags)}function nn(t){return!!t.template}function or(t){return!!(512&t[2])}function Sr(t){return!(256&~t[2])}class jx{previousValue;currentValue;firstChange;constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function X_(t,e,n,r){null!==e?e.applyValueToInputSignal(e,r):t[n]=r}const Ri=(()=>{const t=()=>eT;return t.ngInherit=!0,t})();function eT(t){return t.type.prototype.ngOnChanges&&(t.setInput=$x),Vx}function Vx(){const t=nT(this),e=t?.current;if(e){const n=t.previous;if(n===On)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function $x(t,e,n,r,o){const i=this.declaredInputs[r],s=nT(t)||function zx(t,e){return t[tT]=e}(t,{previous:On,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[i];a[i]=new jx(l&&l.currentValue,n,c===On),X_(t,e,o,n)}const tT="__ngSimpleChanges__";function nT(t){return t[tT]||null}function re(t){for(;Array.isArray(t);)t=t[0];return t}function vt(t,e){return re(e[t.index])}function _o(t,e){return t.data[e]}function Ct(t,e){const n=e[t];return Me(n)?n:n[0]}function vg(t){return!(128&~t[2])}function on(t,e){return null==e?null:t[e]}function iT(t){t[17]=0}function Cg(t){1024&t[2]||(t[2]|=1024,vg(t)&&sa(t))}function eu(t){return!!(9216&t[2]||t[24]?.dirty)}function Eg(t){t[10].changeDetectionScheduler?.notify(9),64&t[2]&&(t[2]|=1024),eu(t)&&sa(t)}function sa(t){t[10].changeDetectionScheduler?.notify(0);let e=ir(t);for(;null!==e&&!(8192&e[2])&&(e[2]|=8192,vg(e));)e=ir(e)}function tu(t,e){if(Sr(t))throw new S(911,!1);null===t[21]&&(t[21]=[]),t[21].push(e)}function ir(t){const e=t[3];return We(e)?e[3]:e}const $={lFrame:vT(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let Tg=!1;function lT(){return $.bindingsEnabled}function I(){return $.lFrame.lView}function V(){return $.lFrame.tView}function wg(t){return $.lFrame.contextLView=t,t[8]}function Sg(t){return $.lFrame.contextLView=null,t}function ee(){let t=uT();for(;null!==t&&64===t.type;)t=t.parent;return t}function uT(){return $.lFrame.currentTNode}function gn(t,e){const n=$.lFrame;n.currentTNode=t,n.isParent=e}function Dg(){return $.lFrame.isParent}function hT(){return Tg}function ru(t){const e=Tg;return Tg=t,e}function sn(){return $.lFrame.bindingIndex++}function iF(t,e){const n=$.lFrame;n.bindingIndex=n.bindingRootIndex=t,bg(e)}function bg(t){$.lFrame.currentDirectiveIndex=t}function ou(t){$.lFrame.currentQueryIndex=t}function aF(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[5]:null}function mT(t,e,n){if(n&te.SkipSelf){let o=e,i=t;for(;!(o=o.parent,null!==o||n&te.Host||(o=aF(i),null===o||(i=i[14],10&o.type))););if(null===o)return!1;e=o,t=i}const r=$.lFrame=yT();return r.currentTNode=e,r.lView=t,!0}function Ng(t){const e=yT(),n=t[1];$.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function yT(){const t=$.lFrame,e=null===t?null:t.child;return null===e?vT(t):e}function vT(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function CT(){const t=$.lFrame;return $.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const ET=CT;function kg(){const t=CT();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function at(){return $.lFrame.selectedIndex}function So(t){$.lFrame.selectedIndex=t}let _T=!0;function ca(){return _T}function Fn(t){_T=t}function iu(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const i=t.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=i;s&&(t.contentHooks??=[]).push(-n,s),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),l&&((t.viewHooks??=[]).push(n,l),(t.viewCheckHooks??=[]).push(n,l)),null!=u&&(t.destroyHooks??=[]).push(n,u)}}function su(t,e,n){TT(t,e,3,n)}function au(t,e,n,r){(3&t[2])===n&&TT(t,e,n,r)}function Og(t,e){let n=t[2];(3&n)===e&&(n&=16383,n+=1,t[2]=n)}function TT(t,e,n,r){const i=r??-1,s=e.length-1;let a=0;for(let c=void 0!==r?65535&t[17]:0;c<s;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=r&&a>=r)break}else e[c]<0&&(t[17]+=65536),(a<i||-1==i)&&(pF(t,n,e,c),t[17]=(4294901760&t[17])+c+2),c++}function wT(t,e){const n=Y(null);try{e.call(t)}finally{Y(n)}}function pF(t,e,n,r){const o=n[r]<0,i=n[r+1],a=t[o?-n[r]:n[r]];o?t[2]>>14<t[17]>>16&&(3&t[2])===e&&(t[2]+=16384,wT(a,i)):wT(a,i)}class la{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,n,r){this.factory=e,this.canSeeViewProviders=n,this.injectImpl=r}}function ST(t){return 3===t||4===t||6===t}function DT(t){return 64===t.charCodeAt(0)}function ki(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const o=e[r];"number"==typeof o?n=o:0===n||AT(t,n,o,null,-1===n||2===n?e[++r]:null)}}return t}function AT(t,e,n,r,o){let i=0,s=t.length;if(-1===e)s=-1;else for(;i<t.length;){const a=t[i++];if("number"==typeof a){if(a===e){s=-1;break}if(a>e){s=i-1;break}}}for(;i<t.length;){const a=t[i];if("number"==typeof a)break;if(a===n){if(null===r)return void(null!==o&&(t[i+1]=o));if(r===t[i+1])return void(t[i+2]=o)}i++,null!==r&&i++,null!==o&&i++}-1!==s&&(t.splice(s,0,e),i=s+1),t.splice(i++,0,n),null!==r&&t.splice(i++,0,r),null!==o&&t.splice(i++,0,o)}const Fg={};class Do{injector;parentInjector;constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=jl(r);const o=this.injector.get(e,Fg,r);return o!==Fg||n===Fg?o:this.parentInjector.get(e,n,r)}}function Lg(t){return-1!==t}function ua(t){return 32767&t}function da(t,e){let n=function EF(t){return t>>16}(t),r=e;for(;n>0;)r=r[14],n--;return r}let Ug=!0;function cu(t){const e=Ug;return Ug=t,e}let _F=0;const Ln={};function lu(t,e){const n=MT(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,Hg(r.data,t),Hg(e,null),Hg(r.blueprint,null));const o=uu(t,e),i=t.injectorIndex;if(Lg(o)){const s=ua(o),a=da(o,e),c=a[1].data;for(let l=0;l<8;l++)e[i+l]=a[s+l]|c[s+l]}return e[i+8]=o,i}function Hg(t,e){t.push(0,0,0,0,0,0,0,0,e)}function MT(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function uu(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,r=null,o=e;for(;null!==o;){if(r=LT(o),null===r)return-1;if(n++,o=o[14],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function Bg(t,e,n){!function TF(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(ta)&&(r=n[ta]),null==r&&(r=n[ta]=_F++);const o=255&r;e.data[t+(o>>5)]|=1<<o}(t,e,n)}function NT(t,e,n){if(n&te.Optional||void 0!==t)return t;Jp()}function kT(t,e,n,r){if(n&te.Optional&&void 0===r&&(r=null),!(n&(te.Self|te.Host))){const o=t[9],i=Ot(void 0);try{return o?o.get(e,r,n&te.Optional):P_(e,r,n&te.Optional)}finally{Ot(i)}}return NT(r,0,n)}function OT(t,e,n,r=te.Default,o){if(null!==t){if(2048&e[2]&&!(r&te.Self)){const s=function bF(t,e,n,r,o){let i=t,s=e;for(;null!==i&&null!==s&&2048&s[2]&&!or(s);){const a=PT(i,s,n,r|te.Self,Ln);if(a!==Ln)return a;let c=i.parent;if(!c){const l=s[20];if(l){const u=l.get(n,Ln,r);if(u!==Ln)return u}c=LT(s),s=s[14]}i=c}return o}(t,e,n,r,Ln);if(s!==Ln)return s}const i=PT(t,e,n,r,Ln);if(i!==Ln)return i}return kT(e,n,r,o)}function PT(t,e,n,r,o){const i=function DF(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(ta)?t[ta]:void 0;return"number"==typeof e?e>=0?255&e:AF:e}(n);if("function"==typeof i){if(!mT(e,t,r))return r&te.Host?NT(o,0,r):kT(e,n,r,o);try{let s;if(s=i(r),null!=s||r&te.Optional)return s;Jp()}finally{ET()}}else if("number"==typeof i){let s=null,a=MT(t,e),c=-1,l=r&te.Host?e[15][5]:null;for((-1===a||r&te.SkipSelf)&&(c=-1===a?uu(t,e):e[a+8],-1!==c&&FT(r,!1)?(s=e[1],a=ua(c),e=da(c,e)):a=-1);-1!==a;){const u=e[1];if(xT(i,a,u.data)){const d=SF(a,e,n,s,r,l);if(d!==Ln)return d}c=e[a+8],-1!==c&&FT(r,e[1].data[a+8]===l)&&xT(i,a,e)?(s=u,a=ua(c),e=da(c,e)):a=-1}}return o}function SF(t,e,n,r,o,i){const s=e[1],a=s.data[t+8],u=function du(t,e,n,r,o){const i=t.providerIndexes,s=e.data,a=1048575&i,c=t.directiveStart,u=i>>20,f=o?a+u:t.directiveEnd;for(let h=r?a:a+u;h<f;h++){const p=s[h];if(h<c&&n===p||h>=c&&p.type===n)return h}if(o){const h=s[c];if(h&&nn(h)&&h.type===n)return c}return null}(a,s,n,null==r?tn(a)&&Ug:r!=s&&!!(3&a.type),o&te.Host&&i===a);return null!==u?fa(e,s,u,a):Ln}function fa(t,e,n,r){let o=t[n];const i=e.data;if(function gF(t){return t instanceof la}(o)){const s=o;s.resolving&&function ax(t,e){throw e&&e.join(" > "),new S(-200,t)}(function ae(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():q(t)}(i[n]));const a=cu(s.canSeeViewProviders);s.resolving=!0;const l=s.injectImpl?Ot(s.injectImpl):null;mT(t,r,te.Default);try{o=t[n]=s.factory(void 0,i,t,r),e.firstCreatePass&&n>=r.directiveStart&&function hF(t,e,n){const{ngOnChanges:r,ngOnInit:o,ngDoCheck:i}=e.type.prototype;if(r){const s=eT(e);(n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s)}o&&(n.preOrderHooks??=[]).push(0-t,o),i&&((n.preOrderHooks??=[]).push(t,i),(n.preOrderCheckHooks??=[]).push(t,i))}(n,i[n],e)}finally{null!==l&&Ot(l),cu(a),s.resolving=!1,ET()}}return o}function xT(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function FT(t,e){return!(t&te.Self||t&te.Host&&e)}class Pe{_tNode;_lView;constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return OT(this._tNode,this._lView,e,jl(r),n)}}function AF(){return new Pe(ee(),I())}function LT(t){const e=t[1],n=e.type;return 2===n?e.declTNode:1===n?t[5]:null}function VT(t,e=null,n=null,r){const o=function $T(t,e=null,n=null,r,o=new Set){const i=[n||ie,Ix(t)];return r=r||("object"==typeof t?void 0:Ge(t)),new vo(i,e||Kl(),r||null,o)}(t,e,n,r);return o.resolveInjectorInitializers(),o}class Qe{static THROW_IF_NOT_FOUND=na;static NULL=new zl;static create(e,n){if(Array.isArray(e))return VT({name:""},n,e,"");{const r=e.name??"";return VT({name:r},e.parent,e.providers,r)}}static \u0275prov=x({token:Qe,providedIn:"any",factory:()=>L(B_)});static __NG_ELEMENT_ID__=-1}new R("").__NG_ELEMENT_ID__=t=>{const e=ee();if(null===e)throw new S(204,!1);if(2&e.type)return e.value;if(t&te.Optional)return null;throw new S(204,!1)};const zT=!1;let cr=(()=>class t{static __NG_ELEMENT_ID__=LF;static __NG_ENV_ID__=n=>n})();class GT extends cr{_lView;constructor(e){super(),this._lView=e}onDestroy(e){return tu(this._lView,e),()=>function Ig(t,e){if(null===t[21])return;const n=t[21].indexOf(e);-1!==n&&t[21].splice(n,1)}(this._lView,e)}}function LF(){return new GT(I())}class lr{}const pa=new R("",{providedIn:"root",factory:()=>!1}),qT=new R(""),zg=new R("");let Un=(()=>{class t{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new zt(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}has(n){return this.pendingTasks.has(n)}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=x({token:t,providedIn:"root",factory:()=>new t})}return t})();const Kt=class HF extends mt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,function G_(){return void 0!==O_()||null!=function fx(){return vi}()}()&&(this.destroyRef=_(cr,{optional:!0})??void 0,this.pendingTasks=_(Un,{optional:!0})??void 0)}emit(e){const n=Y(null);try{super.next(e)}finally{Y(n)}}subscribe(e,n,r){let o=e,i=n||(()=>null),s=r;if(e&&"object"==typeof e){const c=e;o=c.next?.bind(c),i=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(i=this.wrapInTimeout(i),o&&(o=this.wrapInTimeout(o)),s&&(s=this.wrapInTimeout(s)));const a=super.subscribe({next:o,error:i,complete:s});return e instanceof gt&&e.add(a),a}wrapInTimeout(e){return n=>{const r=this.pendingTasks?.add();setTimeout(()=>{e(n),void 0!==r&&this.pendingTasks?.remove(r)})}}};function ga(...t){}function KT(t){let e,n;function r(){t=ga;try{void 0!==n&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(n),void 0!==e&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{t(),r()}),"function"==typeof requestAnimationFrame&&(n=requestAnimationFrame(()=>{t(),r()})),()=>r()}function WT(t){return queueMicrotask(()=>t()),()=>{t=ga}}const Gg="isAngularZone",hu=Gg+"_ID";let BF=0;class ce{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Kt(!1);onMicrotaskEmpty=new Kt(!1);onStable=new Kt(!1);onError=new Kt(!1);constructor(e){const{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:o=!1,scheduleInRootZone:i=zT}=e;if(typeof Zone>"u")throw new S(908,!1);Zone.assertZonePatched();const s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!o&&r,s.shouldCoalesceRunChangeDetection=o,s.callbackScheduled=!1,s.scheduleInRootZone=i,function $F(t){const e=()=>{!function VF(t){function e(){KT(()=>{t.callbackScheduled=!1,Kg(t),t.isCheckStableRunning=!0,qg(t),t.isCheckStableRunning=!1})}t.isCheckStableRunning||t.callbackScheduled||(t.callbackScheduled=!0,t.scheduleInRootZone?Zone.root.run(()=>{e()}):t._outer.run(()=>{e()}),Kg(t))}(t)},n=BF++;t._inner=t._inner.fork({name:"angular",properties:{[Gg]:!0,[hu]:n,[hu+n]:!0},onInvokeTask:(r,o,i,s,a,c)=>{if(function zF(t){return JT(t,"__ignore_ng_zone__")}(c))return r.invokeTask(i,s,a,c);try{return QT(t),r.invokeTask(i,s,a,c)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),YT(t)}},onInvoke:(r,o,i,s,a,c,l)=>{try{return QT(t),r.invoke(i,s,a,c,l)}finally{t.shouldCoalesceRunChangeDetection&&!t.callbackScheduled&&!function GF(t){return JT(t,"__scheduler_tick__")}(c)&&e(),YT(t)}},onHasTask:(r,o,i,s)=>{r.hasTask(i,s),o===i&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,Kg(t),qg(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,o,i,s)=>(r.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(Gg)}static assertInAngularZone(){if(!ce.isInAngularZone())throw new S(909,!1)}static assertNotInAngularZone(){if(ce.isInAngularZone())throw new S(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,o){const i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+o,e,jF,ga,ga);try{return i.runTask(s,n,r)}finally{i.cancelTask(s)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}}const jF={};function qg(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Kg(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&!0===t.callbackScheduled)}function QT(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function YT(t){t._nesting--,qg(t)}class Wg{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Kt;onMicrotaskEmpty=new Kt;onStable=new Kt;onError=new Kt;run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,o){return e.apply(n,r)}}function JT(t,e){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0]?.data?.[e]}class Hn{_console=console;handleError(e){this._console.error("ERROR",e)}}const KF=new R("",{providedIn:"root",factory:()=>{const t=_(ce),e=_(Hn);return n=>t.runOutsideAngular(()=>e.handleError(n))}});function XT(t,e){return D_(t,e)}const QF=(XT.required=function WF(t){return D_(kl,t)},XT);function YF(){return Oi(ee(),I())}function Oi(t,e){return new Ar(vt(t,e))}let Ar=(()=>class t{nativeElement;constructor(n){this.nativeElement=n}static __NG_ELEMENT_ID__=YF})();const tw=new Set;function ya(t){return!(128&~t.flags)}Symbol;var gu=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(gu||{});const mu=new Map;let eL=0;function Yg(t){mu.delete(t[19])}const yu="__ngContext__";function _t(t,e){Me(e)?(t[yu]=e[19],function nL(t){mu.set(t[19],t)}(e)):t[yu]=e}function hw(t){return gw(t[12])}function pw(t){return gw(t[4])}function gw(t){for(;null!==t&&!We(t);)t=t[4];return t}let Xg;const bo=new R("",{providedIn:"root",factory:()=>EL}),EL="ng",em=new R(""),Ro=new R("",{providedIn:"platform",factory:()=>"unknown"}),Tw=new R("",{providedIn:"root",factory:()=>function Bn(){if(void 0!==Xg)return Xg;if(typeof document<"u")return document;throw new S(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null}),Aw=new R("",{providedIn:"root",factory:()=>!1});var dm=function(t){return t[t.CHANGE_DETECTION=0]="CHANGE_DETECTION",t[t.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",t}(dm||{});const Fi=new R("");let fm=(()=>{class t{impl=null;execute(){this.impl?.execute()}static \u0275prov=x({token:t,providedIn:"root",factory:()=>new t})}return t})();function rS(t,e){const n=t.contentQueries;if(null!==n){const r=Y(null);try{for(let o=0;o<n.length;o+=2){const s=n[o+1];if(-1!==s){const a=t.data[s];ou(n[o]),a.contentQueries(2,e[s],s)}}}finally{Y(r)}}}function wm(t,e,n){ou(0);const r=Y(null);try{e(t,n)}finally{Y(r)}}function Sm(t,e,n){if(gg(e)){const r=Y(null);try{const i=e.directiveEnd;for(let s=e.directiveStart;s<i;s++){const a=t.data[s];a.contentQueries&&a.contentQueries(1,n[s],s)}}finally{Y(r)}}}var an=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(an||{}),kr=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(kr||{});function q1(t,e,n){let r=t.length;for(;;){const o=t.indexOf(e,n);if(-1===o)return o;if(0===o||t.charCodeAt(o-1)<=32){const i=e.length;if(o+i===r||t.charCodeAt(o+i)<=32)return o}n=o+1}}const AS="ng-template";function K1(t,e,n,r){let o=0;if(r){for(;o<e.length&&"string"==typeof e[o];o+=2)if("class"===e[o]&&-1!==q1(e[o+1].toLowerCase(),n,0))return!0}else if(Pm(t))return!1;if(o=e.indexOf(1,o),o>-1){let i;for(;++o<e.length&&"string"==typeof(i=e[o]);)if(i.toLowerCase()===n)return!0}return!1}function Pm(t){return 4===t.type&&t.value!==AS}function W1(t,e,n){return e===(4!==t.type||n?t.value:AS)}function Q1(t,e,n){let r=4;const o=t.attrs,i=null!==o?function Z1(t){for(let e=0;e<t.length;e++)if(ST(t[e]))return e;return t.length}(o):0;let s=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!s)if(4&r){if(r=2|1&r,""!==c&&!W1(t,c,n)||""===c&&1===e.length){if(mn(r))return!1;s=!0}}else if(8&r){if(null===o||!K1(t,o,c,n)){if(mn(r))return!1;s=!0}}else{const l=e[++a],u=Y1(c,o,Pm(t),n);if(-1===u){if(mn(r))return!1;s=!0;continue}if(""!==l){let d;if(d=u>i?"":o[u+1].toLowerCase(),2&r&&l!==d){if(mn(r))return!1;s=!0}}}}else{if(!s&&!mn(r)&&!mn(c))return!1;if(s&&mn(c))continue;s=!1,r=c|1&r}}return mn(r)||s}function mn(t){return!(1&t)}function Y1(t,e,n,r){if(null===e)return-1;let o=0;if(r||!n){let i=!1;for(;o<e.length;){const s=e[o];if(s===t)return o;if(3===s||6===s)i=!0;else{if(1===s||2===s){let a=e[++o];for(;"string"==typeof a;)a=e[++o];continue}if(4===s)break;if(0===s){o+=4;continue}}o+=i?1:2}return-1}return function X1(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function bS(t,e,n=!1){for(let r=0;r<e.length;r++)if(Q1(t,e[r],n))return!0;return!1}function RS(t,e){return t?":not("+e.trim()+")":e}function tU(t){let e=t[0],n=1,r=2,o="",i=!1;for(;n<t.length;){let s=t[n];if("string"==typeof s)if(2&r){const a=t[++n];o+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?o+="."+s:4&r&&(o+=" "+s);else""!==o&&!mn(s)&&(e+=RS(i,o),o=""),r=s,i=i||!mn(r);n++}return""!==o&&(e+=RS(i,o)),e}const K={};function Lu(t,e,n){return t.createElement(e,n)}function ko(t,e,n,r,o){t.insertBefore(e,n,r,o)}function NS(t,e,n){t.appendChild(e,n)}function kS(t,e,n,r,o){null!==r?ko(t,e,n,r,o):NS(t,e,n)}function PS(t,e,n){const{mergedAttrs:r,classes:o,styles:i}=n;null!==r&&function CF(t,e,n){let r=0;for(;r<n.length;){const o=n[r];if("number"==typeof o){if(0!==o)break;r++;const i=n[r++],s=n[r++],a=n[r++];t.setAttribute(e,s,a,i)}else{const i=o,s=n[++r];DT(i)?t.setProperty(e,i,s):t.setAttribute(e,i,s),r++}}}(t,e,r),null!==o&&function iU(t,e,n){""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}(t,e,o),null!==i&&function oU(t,e,n){t.setAttribute(e,"style",n)}(t,e,i)}function Uu(t=1){xS(V(),I(),at()+t,!1)}function xS(t,e,n,r){if(!r)if(3&~e[2]){const i=t.preOrderHooks;null!==i&&au(e,i,0,n)}else{const i=t.preOrderCheckHooks;null!==i&&su(e,i,n)}So(n)}function z(t,e=te.Default){const n=I();return null===n?L(t,e):OT(ee(),n,j(t),e)}function FS(t,e,n,r,o,i){const s=Y(null);try{let a=null;!!(o&kr.SignalBased)&&(a=e[r][$e]),null!==a&&void 0!==a.transformFn&&(i=a.transformFn(i)),!!(o&kr.HasDecoratorInputTransform)&&(i=t.inputTransforms[r].call(e,i)),null!==t.setInput?t.setInput(e,a,i,n,r):X_(e,a,r,i)}finally{Y(s)}}function Hu(t,e,n,r,o,i,s,a,c,l,u){const d=e.blueprint.slice();return d[0]=o,d[2]=1228|r,(null!==l||t&&2048&t[2])&&(d[2]|=2048),iT(d),d[3]=d[14]=t,d[8]=n,d[10]=s||t&&t[10],d[B]=a||t&&t[B],d[9]=c||t&&t[9]||null,d[5]=i,d[19]=function tL(){return eL++}(),d[6]=u,d[20]=l,d[15]=2==e.type?t[15]:d,d}function Oa(t,e,n,r){if(0===n)return-1;const o=e.length;for(let i=0;i<n;i++)e.push(r),t.blueprint.push(r),t.data.push(null);return o}function LS(t,e,n,r,o){const i=at(),s=2&r;try{So(-1),s&&e.length>N&&xS(t,e,N,!1),n(r,o)}finally{So(i)}}function Lm(t,e,n){lT()&&(_t(vt(n,e),e),US(t,e,n))}function US(t,e,n){(function vU(t,e,n){const r=n.directiveStart,o=n.directiveEnd;tn(n)&&function AU(t,e,n){const r=vt(e,t),o=function HS(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Hm(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}(n),i=t[10].rendererFactory,s=Vm(t,Hu(t,o,null,function GS(t){let e=16;return t.signals?e=4096:t.onPush&&(e=64),e}(n),r,e,null,i.createRenderer(r,n),null,null,null));t[e.index]=s}(e,n,t.data[r+n.componentOffset]),t.firstCreatePass||lu(n,e);const i=n.initialInputs;for(let s=r;s<o;s++){const a=t.data[s],c=fa(e,t,s,n);_t(c,e),null!==i&&bU(0,s-r,c,a,0,i),nn(a)&&(Ct(n.index,e)[8]=fa(e,t,s,n))}})(t,e,n),!(64&~n.flags)&&function CU(t,e,n){const r=n.directiveStart,o=n.directiveEnd,i=n.index,s=function sF(){return $.lFrame.currentDirectiveIndex}();try{So(i);for(let a=r;a<o;a++){const c=t.data[a],l=e[a];bg(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&EU(c,l)}}finally{So(-1),bg(s)}}(t,e,n)}function Um(t,e,n=vt){const r=e.localNames;if(null!==r){let o=e.index+1;for(let i=0;i<r.length;i+=2){const s=r[i+1],a=-1===s?n(e,t):t[s];t[o++]=a}}}function Hm(t,e,n,r,o,i,s,a,c,l,u){const d=N+r,f=d+o,h=function aU(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:K);return n}(d,f),p="function"==typeof l?l():l;return h[1]={type:t,blueprint:h,template:n,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:u}}let BS=()=>null;function jS(t,e,n,r,o){for(let i in e){if(!e.hasOwnProperty(i))continue;const s=e[i];if(void 0===s)continue;r??={};let a,c=kr.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let l=i;if(null!==o){if(!o.hasOwnProperty(i))continue;l=o[i]}0===t?VS(r,n,l,a,c):VS(r,n,l,a)}return r}function VS(t,e,n,r,o){let i;t.hasOwnProperty(n)?(i=t[n]).push(e,r):i=t[n]=[e,r],void 0!==o&&i.push(o)}function Bm(t,e,n,r){if(lT()){const o=null===r?null:{"":-1},i=function IU(t,e){const n=t.directiveRegistry;let r=null;if(n)for(let o=0;o<n.length;o++){const i=n[o];bS(e,i.selectors,!1)&&(r??=[],nn(i)?r.unshift(i):r.push(i))}return r}(t,n);if(null!==i){const[s,a]=zS(t,n,i);$S(t,e,n,s,o,a)}o&&function TU(t,e,n){if(e){const r=t.localNames=[];for(let o=0;o<e.length;o+=2){const i=n[e[o+1]];if(null==i)throw new S(-301,!1);r.push(e[o],i)}}}(n,r,o)}n.mergedAttrs=ki(n.mergedAttrs,n.attrs)}function $S(t,e,n,r,o,i){for(let l=0;l<r.length;l++)Bg(lu(n,e),t,r[l].type);!function SU(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}(n,t.data.length,r.length);for(let l=0;l<r.length;l++){const u=r[l];u.providersResolver&&u.providersResolver(u)}let s=!1,a=!1,c=Oa(t,e,r.length,null);for(let l=0;l<r.length;l++){const u=r[l];n.mergedAttrs=ki(n.mergedAttrs,u.hostAttrs),DU(t,n,e,c,u),wU(c,u,o),null!==u.contentQueries&&(n.flags|=4),(null!==u.hostBindings||null!==u.hostAttrs||0!==u.hostVars)&&(n.flags|=64);const d=u.type.prototype;!s&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),s=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}!function fU(t,e,n){const o=e.directiveEnd,i=t.data,s=e.attrs,a=[];let c=null,l=null;for(let u=e.directiveStart;u<o;u++){const d=i[u],f=n?n.get(d):null,p=f?f.outputs:null;c=jS(0,d.inputs,u,c,f?f.inputs:null),l=jS(1,d.outputs,u,l,p);const m=null===c||null===s||Pm(e)?null:RU(c,u,s);a.push(m)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(t,n,i)}function EU(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function zS(t,e,n){const r=[];let o=null;for(const i of n)null!==i.findHostDirectiveDefs&&(o??=new Map,i.findHostDirectiveDefs(i,r,o)),nn(i)&&(r.push(i),_U(t,e,r.length-1));return tn(e)?r.push(...n.slice(1)):r.push(...n),[r,o]}function _U(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function wU(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;nn(e)&&(n[""]=t)}}function DU(t,e,n,r,o){t.data[r]=o;const i=o.factory||(o.factory=mo(o.type)),s=new la(i,nn(o),z);t.blueprint[r]=s,n[r]=s,function mU(t,e,n,r,o){const i=o.hostBindings;if(i){let s=t.hostBindingOpCodes;null===s&&(s=t.hostBindingOpCodes=[]);const a=~e.index;(function yU(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(s)!=a&&s.push(a),s.push(n,r,i)}}(t,e,r,Oa(t,n,o.hostVars,K),o)}function bU(t,e,n,r,o,i){const s=i[e];if(null!==s)for(let a=0;a<s.length;)FS(r,n,s[a++],s[a++],s[a++],s[a++])}function RU(t,e,n){let r=null,o=0;for(;o<n.length;){const i=n[o];if(0!==i)if(5!==i){if("number"==typeof i)break;if(t.hasOwnProperty(i)){null===r&&(r=[]);const s=t[i];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(i,s[a+1],s[a+2],n[o+1]);break}}o+=2}else o+=2;else o+=4}return r}function qS(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function Vm(t,e){return t[12]?t[13][4]=e:t[12]=e,t[13]=e,e}function Bu(t,e){const n=t[9],r=n?n.get(Hn,null):null;r&&r.handleError(e)}function $m(t,e,n,r,o){for(let i=0;i<n.length;){const s=n[i++],a=n[i++],c=n[i++];FS(t.data[s],e[s],r,a,c,o)}}function MU(t,e){const n=Ct(e,t),r=n[1];!function NU(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n);const o=n[0];null!==o&&null===n[6]&&(n[6]=null),ju(r,n,n[8])}function ju(t,e,n){Ng(e);try{const r=t.viewQuery;null!==r&&wm(1,r,n);const o=t.template;null!==o&&LS(t,e,o,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[18]?.finishViewCreation(t),t.staticContentQueries&&rS(t,e),t.staticViewQueries&&wm(2,t.viewQuery,n);const i=t.components;null!==i&&function kU(t,e){for(let n=0;n<e.length;n++)MU(t,e[n])}(e,i)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[2]&=-5,kg()}}var Or=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Or||{});function Gm(t,e){return undefined(t,e)}function Pr(t){return!(32&~t.flags)}function Wi(t,e,n,r,o){if(null!=r){let i,s=!1;We(r)?i=r:Me(r)&&(s=!0,r=r[0]);const a=re(r);0===t&&null!==n?null==o?NS(e,n,a):ko(e,n,a,o||null,!0):1===t&&null!==n?ko(e,n,a,o||null,!0):2===t?function ka(t,e,n){t.removeChild(null,e,n)}(e,a,s):3===t&&e.destroyNode(a),null!=i&&function BU(t,e,n,r,o){const i=n[7];i!==re(n)&&Wi(e,t,r,i,o);for(let a=10;a<n.length;a++){const c=n[a];$u(c[1],c,t,e,r,i)}}(e,t,i,n,o)}}function QS(t,e){e[10].changeDetectionScheduler?.notify(10),$u(t,e,e[B],2,null,null)}function YS(t,e){const n=t[9],r=e[3];(Me(r)||e[15]!==r[3][15])&&(t[2]|=2),null===n?t[9]=[e]:n.push(e)}function qm(t,e){const n=t[9],r=n.indexOf(e);n.splice(r,1)}function Pa(t,e){if(t.length<=10)return;const n=10+e,r=t[n];if(r){const o=r[16];null!==o&&o!==t&&qm(o,r),e>0&&(t[n-1][4]=r[4]);const i=Vl(t,10+e);!function WS(t,e){QS(t,e),e[0]=null,e[5]=null}(r[1],r);const s=i[18];null!==s&&s.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function xa(t,e){if(Sr(e))return;const n=e[B];n.destroyNode&&$u(t,e,n,3,null,null),function xU(t){let e=t[12];if(!e)return Km(t[1],t);for(;e;){let n=null;if(Me(e))n=e[12];else{const r=e[10];r&&(n=r)}if(!n){for(;e&&!e[4]&&e!==t;)Me(e)&&Km(e[1],e),e=e[3];null===e&&(e=t),Me(e)&&Km(e[1],e),n=e&&e[4]}e=n}}(e)}function Km(t,e){if(Sr(e))return;const n=Y(null);try{e[2]&=-129,e[2]|=256,e[24]&&Xs(e[24]),function UU(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const o=e[n[r]];if(!(o instanceof la)){const i=n[r+1];if(Array.isArray(i))for(let s=0;s<i.length;s+=2){const a=o[i[s]],c=i[s+1];try{c.call(a)}finally{}}else try{i.call(o)}finally{}}}}(t,e),function LU(t,e){const n=t.cleanup,r=e[7];if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const a=n[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else n[s].call(r[n[s+1]]);null!==r&&(e[7]=null);const o=e[21];if(null!==o){e[21]=null;for(let s=0;s<o.length;s++)(0,o[s])()}const i=e[23];if(null!==i){e[23]=null;for(const s of i)s.destroy()}}(t,e),1===e[1].type&&e[B].destroy();const r=e[16];if(null!==r&&We(e[3])){r!==e[3]&&qm(r,e);const o=e[18];null!==o&&o.detachView(t)}Yg(e)}finally{Y(n)}}function Wm(t,e,n){return function JS(t,e,n){let r=e;for(;null!==r&&168&r.type;)r=(e=r).parent;if(null===r)return n[0];if(tn(r)){const{encapsulation:o}=t.data[r.directiveStart+r.componentOffset];if(o===an.None||o===an.Emulated)return null}return vt(r,n)}(t,e.parent,n)}let eD=function XS(t,e,n){return 40&t.type?vt(t,n):null};function Vu(t,e,n,r){const o=Wm(t,r,e),i=e[B],a=function ZS(t,e,n){return eD(t,e,n)}(r.parent||e[5],r,e);if(null!=o)if(Array.isArray(n))for(let c=0;c<n.length;c++)kS(i,o,n[c],a,!1);else kS(i,o,n,a,!1)}function Oo(t,e){if(null!==e){const n=e.type;if(3&n)return vt(e,t);if(4&n)return Ym(-1,t[e.index]);if(8&n){const r=e.child;if(null!==r)return Oo(t,r);{const o=t[e.index];return We(o)?Ym(-1,o):re(o)}}if(128&n)return Oo(t,e.next);if(32&n)return Gm(e,t)()||re(t[e.index]);{const r=nD(t,e);return null!==r?Array.isArray(r)?r[0]:Oo(ir(t[15]),r):Oo(t,e.next)}}return null}function nD(t,e){return null!==e?t[15][5].projection[e.projection]:null}function Ym(t,e){const n=10+t+1;if(n<e.length){const r=e[n],o=r[1].firstChild;if(null!==o)return Oo(r,o)}return e[7]}function Jm(t,e,n,r,o,i,s){for(;null!=n;){if(128===n.type){n=n.next;continue}const a=r[n.index],c=n.type;if(s&&0===e&&(a&&_t(re(a),r),n.flags|=2),!Pr(n))if(8&c)Jm(t,e,n.child,r,o,i,!1),Wi(e,t,o,a,i);else if(32&c){const l=Gm(n,r);let u;for(;u=l();)Wi(e,t,o,u,i);Wi(e,t,o,a,i)}else 16&c?rD(t,e,r,n,o,i):Wi(e,t,o,a,i);n=s?n.projectionNext:n.next}}function $u(t,e,n,r,o,i){Jm(n,r,t.firstChild,e,o,i,!1)}function rD(t,e,n,r,o,i){const s=n[15],c=s[5].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)Wi(e,t,o,c[l],i);else{let l=c;const u=s[3];ya(r)&&(l.flags|=128),Jm(t,e,l,u,o,i,!0)}}function Po(t,e){return!e||null===e.firstChild||ya(t)}function Ji(t,e,n,r,o=!1){for(;null!==n;){if(128===n.type){n=o?n.projectionNext:n.next;continue}const i=e[n.index];null!==i&&r.push(re(i)),We(i)&&Xm(i,r);const s=n.type;if(8&s)Ji(t,e,n.child,r);else if(32&s){const a=Gm(n,e);let c;for(;c=a();)r.push(c)}else if(16&s){const a=nD(e,n);if(Array.isArray(a))r.push(...a);else{const c=ir(e[15]);Ji(c[1],c,a,r,!0)}}n=o?n.projectionNext:n.next}return r}function Xm(t,e){for(let n=10;n<t.length;n++){const r=t[n],o=r[1].firstChild;null!==o&&Ji(r[1],r,o,e)}t[7]!==t[0]&&e.push(t[7])}let iD=[];const GU={...co,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{sa(t.lView)},consumerOnSignalRead(){this.lView[24]=this}},KU={...co,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:t=>{let e=ir(t.lView);for(;e&&!sD(e[1]);)e=ir(e);e&&Cg(e)},consumerOnSignalRead(){this.lView[24]=this}};function sD(t){return 2!==t.type}function aD(t){if(null===t[23])return;let e=!0;for(;e;){let n=!1;for(const r of t[23])r.dirty&&(n=!0,null===r.zone||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=n&&!!(8192&t[2])}}function zu(t,e=!0,n=0){const o=t[10].rendererFactory;o.begin?.();try{!function QU(t,e){const n=hT();try{ru(!0),ey(t,e);let r=0;for(;eu(t);){if(100===r)throw new S(103,!1);r++,ey(t,1)}}finally{ru(n)}}(t,n)}catch(s){throw e&&Bu(t,s),s}finally{o.end?.()}}function lD(t,e,n,r){if(Sr(e))return;const o=e[2];Ng(e);let a=!0,c=null,l=null;sD(t)?(l=function VU(t){return t[24]??function $U(t){const e=iD.pop()??Object.create(GU);return e.lView=t,e}(t)}(e),c=lo(l)):null===function Rp(){return Le}()?(a=!1,l=function qU(t){const e=t[24]??Object.create(KU);return e.lView=t,e}(e),c=lo(l)):e[24]&&(Xs(e[24]),e[24]=null);try{iT(e),function pT(t){return $.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==n&&LS(t,e,n,2,r);const u=!(3&~o);if(u){const h=t.preOrderCheckHooks;null!==h&&su(e,h,null)}else{const h=t.preOrderHooks;null!==h&&au(e,h,0,null),Og(e,0)}if(function YU(t){for(let e=hw(t);null!==e;e=pw(e)){if(!(2&e[2]))continue;const n=e[9];for(let r=0;r<n.length;r++)Cg(n[r])}}(e),aD(e),uD(e,0),null!==t.contentQueries&&rS(t,e),u){const h=t.contentCheckHooks;null!==h&&su(e,h)}else{const h=t.contentHooks;null!==h&&au(e,h,1),Og(e,1)}!function ZU(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const o=n[r];if(o<0)So(~o);else{const i=o,s=n[++r],a=n[++r];iF(s,i);const c=e[i];a(2,c)}}}finally{So(-1)}}(t,e);const d=t.components;null!==d&&fD(e,d,0);const f=t.viewQuery;if(null!==f&&wm(2,f,r),u){const h=t.viewCheckHooks;null!==h&&su(e,h)}else{const h=t.viewHooks;null!==h&&au(e,h,2),Og(e,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),e[22]){for(const h of e[22])h();e[22]=null}e[2]&=-73}catch(u){throw sa(e),u}finally{null!==l&&(di(l,c),a&&function zU(t){t.lView[24]!==t&&(t.lView=null,iD.push(t))}(l)),kg()}}function uD(t,e){for(let n=hw(t);null!==n;n=pw(n))for(let r=10;r<n.length;r++)dD(n[r],e)}function JU(t,e,n){dD(Ct(e,t),n)}function dD(t,e){vg(t)&&ey(t,e)}function ey(t,e){const r=t[1],o=t[2],i=t[24];let s=!!(0===e&&16&o);if(s||=!!(64&o&&0===e),s||=!!(1024&o),s||=!(!i?.dirty||!Zs(i)),s||=!1,i&&(i.dirty=!1),t[2]&=-9217,s)lD(r,t,r.template,t[8]);else if(8192&o){aD(t),uD(t,1);const a=r.components;null!==a&&fD(t,a,1)}}function fD(t,e,n){for(let r=0;r<e.length;r++)JU(t,e[r],n)}function Fa(t,e){const n=hT()?64:1088;for(t[10].changeDetectionScheduler?.notify(e);t;){t[2]|=n;const r=ir(t);if(or(t)&&!r)return t;t=r}return null}class La{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){const e=this._lView,n=e[1];return Ji(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r}get context(){return this._lView[8]}get dirty(){return!!(9280&this._lView[2])||!!this._lView[24]?.dirty}set context(e){this._lView[8]=e}get destroyed(){return Sr(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(We(e)){const n=e[8],r=n?n.indexOf(this):-1;r>-1&&(Pa(e,r),Vl(n,r))}this._attachedToViewContainer=!1}xa(this._lView[1],this._lView)}onDestroy(e){tu(this._lView,e)}markForCheck(){Fa(this._cdRefInjectingView||this._lView,4)}markForRefresh(){Cg(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){Eg(this._lView),this._lView[2]|=128}detectChanges(){this._lView[2]|=1024,zu(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new S(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const e=or(this._lView),n=this._lView[16];null!==n&&!e&&qm(n,this._lView),QS(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new S(902,!1);this._appRef=e;const n=or(this._lView),r=this._lView[16];null!==r&&!n&&YS(r,this._lView),Eg(this._lView)}}let dr=(()=>class t{static __NG_ELEMENT_ID__=tH})();const XU=dr,eH=class extends XU{_declarationLView;_declarationTContainer;elementRef;constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){const o=function Qi(t,e,n,r){const o=Y(null);try{const i=e.tView,c=Hu(t,i,n,4096&t[2]?4096:16,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null);c[16]=t[e.index];const u=t[18];return null!==u&&(c[18]=u.createEmbeddedView(i)),ju(i,c,n),c}finally{Y(o)}}(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:r});return new La(o)}};function tH(){return function Gu(t,e){return 4&t.type?new eH(e,t,Oi(t,e)):null}(ee(),I())}function xo(t,e,n,r,o){let i=t.data[e];if(null===i)i=function oy(t,e,n,r,o){const i=uT(),s=Dg(),c=t.data[e]=function dH(t,e,n,r,o,i){let s=e?e.injectorIndex:-1,a=0;return function wo(){return null!==$.skipHydrationRootTNode}()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?i:i&&i.parent,n,e,r,o);return function uH(t,e,n,r){null===t.firstChild&&(t.firstChild=e),null!==n&&(r?null==n.child&&null!==e.parent&&(n.child=e):null===n.next&&(n.next=e,e.prev=n))}(t,c,i,s),c}(t,e,n,r,o),function oF(){return $.lFrame.inI18n}()&&(i.flags|=32);else if(64&i.type){i.type=n,i.value=r,i.attrs=o;const s=function aa(){const t=$.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();i.injectorIndex=null===s?-1:s.injectorIndex}return gn(i,!0),i}class JH{}class PD{}class ZH{resolveComponentFactory(e){throw Error(`No component factory found for ${Ge(e)}.`)}}class Ju{static NULL=new ZH}class hy{}let eB=(()=>{class t{static \u0275prov=x({token:t,providedIn:"root",factory:()=>null})}return t})();function ed(t,e,n){let r=n?t.styles:null,o=n?t.classes:null,i=0;if(null!==e)for(let s=0;s<e.length;s++){const a=e[s];"number"==typeof a?i=a:1==i?o=$p(o,a):2==i&&(r=$p(r,a+": "+e[++s]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=o:t.classesWithoutHost=o}class LD extends Ju{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const n=J(e);return new Ka(n,this.ngModule)}}function UD(t,e){const n=[];for(const r in t){if(!t.hasOwnProperty(r))continue;const o=t[r];if(void 0===o)continue;const i=Array.isArray(o),s=i?o[0]:o;n.push(e?{propName:s,templateName:r,isSignal:!!((i?o[1]:kr.None)&kr.SignalBased)}:{propName:s,templateName:r})}return n}class Ka extends PD{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){const e=this.componentDef,n=e.inputTransforms,r=UD(e.inputs,!0);if(null!==n)for(const o of r)n.hasOwnProperty(o.propName)&&(o.transform=n[o.propName]);return r}get outputs(){return UD(this.componentDef.outputs,!1)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=function nU(t){return t.map(tU).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!n}create(e,n,r,o){const i=Y(null);try{let s=(o=o||this.ngModule)instanceof xt?o:o?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const a=s?new Do(e,s):e,c=a.get(hy,null);if(null===c)throw new S(407,!1);const d={rendererFactory:c,sanitizer:a.get(eB,null),changeDetectionScheduler:a.get(lr,null)},f=c.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",p=r?function cU(t,e,n,r){const i=r.get(Aw,!1)||n===an.ShadowDom,s=t.selectRootElement(e,i);return function lU(t){BS(t)}(s),s}(f,r,this.componentDef.encapsulation,a):Lu(f,h,function rB(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(h));let m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let v=null;null!==p&&(v=null);const E=Hm(0,null,null,1,0,null,null,null,null,null,null),C=Hu(null,E,null,m,null,null,d,f,a,null,v);C[N]=p,Ng(C);let A=null;try{const P=r?["ng-version","19.1.4"]:function rU(t){const e=[],n=[];let r=1,o=2;for(;r<t.length;){let i=t[r];if("string"==typeof i)2===o?""!==i&&e.push(i,t[++r]):8===o&&n.push(i);else{if(!mn(o))break;o=i}r++}return n.length&&e.push(1,...n),e}(this.componentDef.selectors[0]),O=xo(E,N,2,"#host",P),[De,dt]=zS(E,O,[this.componentDef]);$S(E,C,O,De,{},dt);for(const li of De)O.mergedAttrs=ki(O.mergedAttrs,li.hostAttrs);O.mergedAttrs=ki(O.mergedAttrs,P),ed(O,O.mergedAttrs,!0),p&&(PS(f,p,O),_t(p,C)),void 0!==n&&function iB(t,e,n){const r=t.projection=[];for(let o=0;o<e.length;o++){const i=n[o];r.push(null!=i&&i.length?Array.from(i):null)}}(O,this.ngContentSelectors,n),US(E,C,O),Sm(E,O,C),iu(E,O),A=Ct(O.index,C),C[8]=A[8],ju(E,C,null)}catch(P){throw null!==A&&Yg(A),Yg(C),P}finally{kg()}return new oB(this.componentType,C)}finally{Y(i)}}}class oB extends JH{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,n){super(),this._rootLView=n,this._tNode=_o(n[1],N),this.location=Oi(this._tNode,n),this.instance=Ct(this._tNode.index,n)[8],this.hostView=this.changeDetectorRef=new La(n,void 0,!1),this.componentType=e}setInput(e,n){const r=this._tNode.inputs;let o;if(null!==r&&(o=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;const i=this._rootLView;$m(i[1],i,o,e,n),this.previousInputValues.set(e,n),Fa(Ct(this._tNode.index,i),1)}}get injector(){return new Pe(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}let yn=(()=>class t{static __NG_ELEMENT_ID__=sB})();function sB(){return function jD(t,e){let n;const r=e[t.index];return We(r)?n=r:(n=qS(r,e,null,t),e[t.index]=n,Vm(e,n)),VD(n,e,t,r),new HD(n,t,e)}(ee(),I())}const aB=yn,HD=class extends aB{_lContainer;_hostTNode;_hostLView;constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Oi(this._hostTNode,this._hostLView)}get injector(){return new Pe(this._hostTNode,this._hostLView)}get parentInjector(){const e=uu(this._hostTNode,this._hostLView);if(Lg(e)){const n=da(e,this._hostLView),r=ua(e);return new Pe(n[1].data[r+8],n)}return new Pe(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const n=BD(this._lContainer);return null!==n&&n[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,n,r){let o,i;"number"==typeof r?o=r:null!=r&&(o=r.index,i=r.injector);const a=e.createEmbeddedViewImpl(n||{},i,null);return this.insertImpl(a,o,Po(this._hostTNode,null)),a}createComponent(e,n,r,o,i){const s=e&&!function ia(t){return"function"==typeof t}(e);let a;if(s)a=n;else{const p=n||{};a=p.index,r=p.injector,o=p.projectableNodes,i=p.environmentInjector||p.ngModuleRef}const c=s?e:new Ka(J(e)),l=r||this.parentInjector;if(!i&&null==c.ngModule){const m=(s?l:this.parentInjector).get(xt,null);m&&(i=m)}J(c.componentType??{});const h=c.create(l,o,null,i);return this.insertImpl(h.hostView,a,Po(this._hostTNode,null)),h}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){const o=e._lView;if(function Wx(t){return We(t[3])}(o)){const a=this.indexOf(e);if(-1!==a)this.detach(a);else{const c=o[3],l=new HD(c,c[5],c[3]);l.detach(l.indexOf(e))}}const i=this._adjustIndex(n),s=this._lContainer;return function Yi(t,e,n,r=!0){const o=e[1];if(function FU(t,e,n,r){const o=10+r,i=n.length;r>0&&(n[o-1][4]=e),r<i-10?(e[4]=n[o],L_(n,10+r,e)):(n.push(e),e[4]=null),e[3]=n;const s=e[16];null!==s&&n!==s&&YS(s,e);const a=e[18];null!==a&&a.insertView(t),Eg(e),e[2]|=128}(o,e,t,n),r){const s=Ym(n,t),a=e[B],c=a.parentNode(t[7]);null!==c&&function PU(t,e,n,r,o,i){r[0]=o,r[5]=e,$u(t,r,n,1,o,i)}(o,t[5],a,e,c,s)}const i=e[6];null!==i&&null!==i.firstChild&&(i.firstChild=null)}(s,o,i,r),e.attachToViewContainerRef(),L_(my(s),i,e),e}move(e,n){return this.insert(e,n)}indexOf(e){const n=BD(this._lContainer);return null!==n?n.indexOf(e):-1}remove(e){const n=this._adjustIndex(e,-1),r=Pa(this._lContainer,n);r&&(Vl(my(this._lContainer),n),xa(r[1],r))}detach(e){const n=this._adjustIndex(e,-1),r=Pa(this._lContainer,n);return r&&null!=Vl(my(this._lContainer),n)?new La(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function BD(t){return t[8]}function my(t){return t[8]||(t[8]=[])}let VD=function zD(t,e,n,r){if(t[7])return;let o;o=8&n.type?re(r):function cB(t,e){const n=t[B],r=n.createComment(""),o=vt(e,t),i=n.parentNode(o);return ko(n,i,r,n.nextSibling(o),!1),r}(e,n),t[7]=o};class Lo{}class lA extends Lo{injector;componentFactoryResolver=new LD(this);instance=null;constructor(e){super();const n=new vo([...e.providers,{provide:Lo,useValue:this},{provide:Ju,useValue:this.componentFactoryResolver}],e.parent||Kl(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}let RB=(()=>{class t{_injector;cachedInjectors=new Map;constructor(n){this._injector=n}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const r=sg(0,n.type),o=r.length>0?function by(t,e,n=null){return new lA({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,o)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=x({token:t,providedIn:"environment",factory:()=>new t(L(xt))})}return t})();function Ry(t){return er(()=>{const e=dA(t),n={...e,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===gu.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:e.standalone?o=>o.get(RB).getOrCreateStandaloneInjector(n):null,getExternalStyles:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||an.Emulated,styles:t.styles||ie,_:null,schemas:t.schemas||null,tView:null,id:""};e.standalone&&function nt(t){tw.has(t)||(tw.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}("NgStandalone"),fA(n);const r=t.dependencies;return n.directiveDefs=nd(r,!1),n.pipeDefs=nd(r,!0),n.id=function OB(t){let e=0;const r=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,"function"==typeof t.consts?"":t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery];for(const i of r.join("|"))e=Math.imul(31,e)+i.charCodeAt(0)|0;return e+=2147483648,"c"+e}(n),n})}function MB(t){return J(t)||qe(t)}function NB(t){return null!==t}function My(t){return er(()=>({type:t.type,bootstrap:t.bootstrap||ie,declarations:t.declarations||ie,imports:t.imports||ie,exports:t.exports||ie,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function uA(t,e){if(null==t)return On;const n={};for(const r in t)if(t.hasOwnProperty(r)){const o=t[r];let i,s,a=kr.None;Array.isArray(o)?(a=o[0],i=o[1],s=o[2]??i):(i=o,s=o),e?(n[i]=a!==kr.None?[r,a]:r,e[i]=s):n[i]=r}return n}function Tt(t){return er(()=>{const e=dA(t);return fA(e),e})}function dA(t){const e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||On,exportAs:t.exportAs||null,standalone:t.standalone??!0,signals:!0===t.signals,selectors:t.selectors||ie,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:uA(t.inputs,e),outputs:uA(t.outputs),debugInfo:null}}function fA(t){t.features?.forEach(e=>e(t))}function nd(t,e){if(!t)return null;const n=e?st:MB;return()=>("function"==typeof t?t():t).map(r=>n(r)).filter(NB)}function xe(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Oy(t,e,n,r,o,i,s,a){const c=I(),l=V();return function Ya(t,e,n,r,o,i,s,a,c,l){const u=n+N,d=e.firstCreatePass?function KB(t,e,n,r,o,i,s,a,c){const l=e.consts,u=xo(e,t,4,s||null,a||null);Bm(e,n,u,on(l,c)),iu(e,u);const d=u.tView=Hm(2,u,r,o,i,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,e,t,r,o,i,s,a,c):e.data[u];gn(d,!1);const f=EA(e,t,d,n);ca()&&Vu(e,t,f,d),_t(f,t);const h=qS(f,t,f,d);return t[u]=h,Vm(t,h),Zl(d)&&Lm(e,t,d),null!=c&&Um(t,d,l),d}(c,l,t,e,n,r,o,on(l.consts,i),s,a),Oy}let EA=function IA(t,e,n,r){return Fn(!0),e[B].createComment("")};const xA=new R("");function ud(t){return!!t&&"function"==typeof t.then}function FA(t){return!!t&&"function"==typeof t.subscribe}const LA=new R("");let UA=(()=>{class t{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r});appInits=_(LA,{optional:!0})??[];injector=_(Qe);constructor(){}runInitializers(){if(this.initialized)return;const n=[];for(const o of this.appInits){const i=pn(this.injector,o);if(ud(i))n.push(i);else if(FA(i)){const s=new Promise((a,c)=>{i.subscribe({complete:a,error:c})});n.push(s)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(o=>{this.reject(o)}),0===n.length&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||t)};static \u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Vy=(()=>{class t{static \u0275prov=x({token:t,providedIn:"root",factory:()=>new HA})}return t})();class HA{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){const r=this.queues.get(e.zone);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){const n=e.zone;this.queues.has(n)||this.queues.set(n,new Set);const r=this.queues.get(n);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(const[e,n]of this.queues)null===e?this.flushQueue(n):e.run(()=>this.flushQueue(n))}flushQueue(e){for(const n of e)e.delete(n),this.queuedEffectCount--,n.run()}}const dd=new R("");let ln=(()=>{class t{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=_(KF);afterRenderManager=_(fm);zonelessEnabled=_(pa);rootEffectScheduler=_(Vy);dirtyFlags=0;deferredDirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new mt;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=_(Un).hasPendingTasks.pipe(oe(n=>!n));constructor(){_(Fi,{optional:!0})}whenStable(){let n;return new Promise(r=>{n=this.isStable.subscribe({next:o=>{o&&r()}})}).finally(()=>{n.unsubscribe()})}_injector=_(xt);_rendererFactory=null;get injector(){return this._injector}bootstrap(n,r){const o=n instanceof PD;if(!this._injector.get(UA).done)throw!o&&function _r(t){const e=J(t)||qe(t)||st(t);return null!==e&&e.standalone}(n),new S(405,!1);let s;s=o?n:this._injector.get(Ju).resolveComponentFactory(n),this.componentTypes.push(s.componentType);const a=function Kj(t){return t.isBoundToModule}(s)?void 0:this._injector.get(Lo),l=s.create(Qe.NULL,[],r||s.selector,a),u=l.location.nativeElement,d=l.injector.get(xA,null);return d?.registerApplication(u),l.onDestroy(()=>{this.detachView(l.hostView),fd(this.components,l),d?.unregisterApplication(u)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick=()=>{if(null!==this.tracingSnapshot){const r=this.tracingSnapshot;return this.tracingSnapshot=null,r.run(dm.CHANGE_DETECTION,this._tick),void r.dispose()}if(this._runningTick)throw new S(101,!1);const n=Y(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,Y(n),this.afterTick.next()}};synchronize(){null===this._rendererFactory&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(hy,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let n=0;for(;0!==this.dirtyFlags&&n++<10;)this.synchronizeOnce()}synchronizeOnce(){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,16&this.dirtyFlags&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),7&this.dirtyFlags){const n=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:o}of this.allViews)Yj(r,o,n,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),23&this.dirtyFlags)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:n})=>eu(n))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;fd(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n),this._injector.get(dd,[]).forEach(o=>o(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>fd(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new S(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||t)};static \u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function fd(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function Yj(t,e,n,r){(n||eu(t))&&zu(t,e,n&&!r?0:1)}function pd(t,e,n){const r=I();return xe(r,sn(),e)&&function Ut(t,e,n,r,o,i,s,a){const c=vt(e,n);let u,l=e.inputs;!a&&null!=l&&(u=l[r])?($m(t,n,u,r,o),tn(e)&&function pU(t,e){const n=Ct(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(r=function hU(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),o=null!=s?s(o,e.value||"",r):o,i.setProperty(c,r,o))}(V(),function he(){const t=$.lFrame;return _o(t.tView,t.selectedIndex)}(),r,t,e,r[B],n,!1),pd}function Yy(t,e,n,r,o){const s=o?"class":"style";$m(t,n,e.inputs[s],s,r)}function jr(t,e,n,r){const o=I(),i=V(),s=N+t,a=o[B],c=i.firstCreatePass?function C$(t,e,n,r,o,i){const s=e.consts,c=xo(e,t,2,r,on(s,o));return Bm(e,n,c,on(s,i)),null!==c.attrs&&ed(c,c.attrs,!1),null!==c.mergedAttrs&&ed(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(s,i,o,e,n,r):i.data[s],l=Eb(i,o,c,a,e,t);o[s]=l;const u=Zl(c);return gn(c,!0),PS(a,l,c),!Pr(c)&&ca()&&Vu(i,o,l,c),0===function Yx(){return $.lFrame.elementDepthCount}()&&_t(l,o),function Jx(){$.lFrame.elementDepthCount++}(),u&&(Lm(i,o,c),Sm(i,c,o)),null!==r&&Um(o,c),jr}function jo(){let t=ee();Dg()?function Ag(){$.lFrame.isParent=!1}():(t=t.parent,gn(t,!1));const e=t;(function Xx(t){return $.skipHydrationRootTNode===t})(e)&&function rF(){$.skipHydrationRootTNode=null}(),function Zx(){$.lFrame.elementDepthCount--}();const n=V();return n.firstCreatePass&&(iu(n,t),gg(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function yF(t){return!!(8&t.flags)}(e)&&Yy(n,e,I(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function vF(t){return!!(16&t.flags)}(e)&&Yy(n,e,I(),e.stylesWithoutHost,!1),jo}function yd(t,e,n,r){return jr(t,e,n,r),jo(),yd}let Eb=(t,e,n,r,o,i)=>(Fn(!0),Lu(r,o,function IT(){return $.lFrame.currentNamespace}()));function rv(){return I()}const vd="en-US";let Ab=vd;function ic(t,e,n,r){const o=I(),i=V(),s=ee();return function sv(t,e,n,r,o,i,s){const a=Zl(r),l=t.firstCreatePass&&function cT(t){return t.cleanup??=[]}(t),u=e[8],d=function aT(t){return t[7]??=[]}(e);let f=!0;if(3&r.type||s){const m=vt(r,e),v=s?s(m):m,E=d.length,C=s?P=>s(re(P[r.index])):r.index;let A=null;if(!s&&a&&(A=function g2(t,e,n,r){const o=t.cleanup;if(null!=o)for(let i=0;i<o.length-1;i+=2){const s=o[i];if(s===n&&o[i+1]===r){const a=e[7],c=o[i+2];return a.length>c?a[c]:null}"string"==typeof s&&(i+=2)}return null}(t,e,o,r.index)),null!==A)(A.__ngLastListenerFn__||A).__ngNextListenerFn__=i,A.__ngLastListenerFn__=i,f=!1;else{i=Qb(r,e,u,i);const P=n.listen(v,o,i);d.push(i,P),l&&l.push(o,C,E,E+1)}}else i=Qb(r,e,u,i);const h=r.outputs;let p;if(f&&null!==h&&(p=h[o])){const m=p.length;if(m)for(let v=0;v<m;v+=2){const O=e[p[v]][p[v+1]].subscribe(i),De=d.length;d.push(i,O),l&&l.push(o,r.index,De,-(De+1))}}}(i,o,o[B],s,t,e,r),ic}function Wb(t,e,n,r){const o=Y(null);try{return!1!==n(r)}catch(i){return Bu(t,i),!1}finally{Y(o)}}function Qb(t,e,n,r){return function o(i){if(i===Function)return r;Fa(tn(t)?Ct(t.index,e):e,5);let a=Wb(e,0,r,i),c=o.__ngNextListenerFn__;for(;c;)a=Wb(e,0,c,i)&&a,c=c.__ngNextListenerFn__;return a}}function _d(t=1){return function cF(t){return($.lFrame.contextLView=function sT(t,e){for(;t>0;)e=e[14],t--;return e}(t,$.lFrame.contextLView))[8]}(t)}function sc(t,e=""){const n=I(),r=V(),o=t+N,i=r.firstCreatePass?xo(r,o,1,e,null):r.data[o],s=yR(r,n,i,e,t);n[o]=s,ca()&&Vu(r,n,s,i),gn(i,!1)}let yR=(t,e,n,r,o)=>(Fn(!0),function xm(t,e){return t.createText(e)}(e[B],r));function Td(t,e,n){const r=I(),o=function os(t,e,n,r){return xe(t,sn(),n)?e+q(n)+r:K}(r,t,e,n);return o!==K&&function fr(t,e,n){const r=function Mi(t,e){return re(e[t])}(e,t);!function MS(t,e,n){t.setValue(e,n)}(t[B],r,n)}(r,at(),o),Td}let $z=(()=>{class t{zone=_(ce);changeDetectionScheduler=_(lr);applicationRef=_(ln);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function yv({ngZoneFactory:t,ignoreChangesOutsideZone:e,scheduleInRootZone:n}){return t??=()=>new ce({...vv(),scheduleInRootZone:n}),[{provide:ce,useFactory:t},{provide:en,multi:!0,useFactory:()=>{const r=_($z,{optional:!0});return()=>r.initialize()}},{provide:en,multi:!0,useFactory:()=>{const r=_(Gz);return()=>{r.initialize()}}},!0===e?{provide:qT,useValue:!0}:[],{provide:zg,useValue:n??zT}]}function vv(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}let Gz=(()=>{class t{subscription=new gt;initialized=!1;zone=_(ce);pendingTasks=_(Un);initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ce.assertNotInAngularZone(),queueMicrotask(()=>{null!==n&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ce.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),uc=(()=>{class t{appRef=_(ln);taskService=_(Un);ngZone=_(ce);zonelessEnabled=_(pa);tracing=_(Fi,{optional:!0});disableScheduling=_(qT,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new gt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(hu):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(_(zg,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Wg||!this.zoneIsDefined)}notify(n){if(!this.zonelessEnabled&&5===n)return;let r=!1;switch(n){case 0:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 8:this.appRef.deferredDirtyFlags|=8;break;case 6:case 14:this.appRef.dirtyFlags|=2,r=!0;break;case 13:this.appRef.dirtyFlags|=16,r=!0;break;case 12:r=!0;break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;const o=this.useMicrotaskScheduler?WT:KT;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>o(()=>this.tick())):this.ngZone.runOutsideAngular(()=>o(()=>this.tick()))}shouldScheduleTick(n){return!(this.disableScheduling&&!n||this.appRef.destroyed||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(hu+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(0===this.appRef.dirtyFlags)return void this.cleanup();!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const n=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(n),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,WT(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(n)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Vr=new R("",{providedIn:"root",factory:()=>_(Vr,te.Optional|te.SkipSelf)||function qz(){return typeof $localize<"u"&&$localize.locale||vd}()}),bd=new R(""),Zz=new R("");function dc(t){return!t.moduleRef}let $r=null;let Rd=(()=>class t{static __NG_ELEMENT_ID__=rG})();function rG(t){return function oG(t,e,n){if(tn(t)&&!n){const r=Ct(t.index,e);return new La(r,r)}return 175&t.type?new La(e[15],e):null}(ee(),I(),!(16&~t))}function AG(t){try{const{rootComponent:e,appProviders:n,platformProviders:r}=t,o=function nG(t=[]){if($r)return $r;const e=function sM(t=[],e){return Qe.create({name:e,providers:[{provide:lg,useValue:"platform"},{provide:bd,useValue:new Set([()=>$r=null])},...t]})}(t);return $r=e,function BA(){!function M0(t){f_=t}(()=>{throw new S(600,!1)})}(),function aM(t){const e=t.get(em,null);pn(t,()=>{e?.forEach(n=>n())})}(e),e}(r),i=[yv({}),{provide:lr,useExisting:uc},...n||[]];return function rM(t){const e=dc(t)?t.r3Injector:t.moduleRef.injector,n=e.get(ce);return n.run(()=>{dc(t)?t.r3Injector.resolveInjectorInitializers():t.moduleRef.resolveInjectorInitializers();const r=e.get(Hn,null);let o;if(n.runOutsideAngular(()=>{o=n.onError.subscribe({next:i=>{r.handleError(i)}})}),dc(t)){const i=()=>e.destroy(),s=t.platformInjector.get(bd);s.add(i),e.onDestroy(()=>{o.unsubscribe(),s.delete(i)})}else{const i=()=>t.moduleRef.destroy(),s=t.platformInjector.get(bd);s.add(i),t.moduleRef.onDestroy(()=>{fd(t.allPlatformModules,t.moduleRef),o.unsubscribe(),s.delete(i)})}return function Qj(t,e,n){try{const r=n();return ud(r)?r.catch(o=>{throw e.runOutsideAngular(()=>t.handleError(o)),o}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(r,n,()=>{const i=e.get(UA);return i.runInitializers(),i.donePromise.then(()=>{if(function N$(t){"string"==typeof t&&(Ab=t.toLowerCase().replace(/_/g,"-"))}(e.get(Vr,vd)||vd),!e.get(Zz,!0))return dc(t)?e.get(ln):(t.allPlatformModules.push(t.moduleRef),t.moduleRef);if(dc(t)){const c=e.get(ln);return void 0!==t.rootComponent&&c.bootstrap(t.rootComponent),c}return function Xz(t,e){const n=t.injector.get(ln);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>n.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new S(-403,!1);t.instance.ngDoBootstrap(n)}e.push(t)}(t.moduleRef,t.allPlatformModules),t.moduleRef})})})}({r3Injector:new lA({providers:i,parent:o,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:o,rootComponent:e})}catch(e){return Promise.reject(e)}}let QM=null;function ms(){return QM}class Cq{}const En=new R("");let YM=(()=>{class t{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||t)};static \u0275prov=x({token:t,factory:()=>_(Eq),providedIn:"platform"})}return t})(),Eq=(()=>{class t extends YM{_location;_history;_doc=_(En);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ms().getBaseHref(this._doc)}onPopState(n){const r=ms().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=ms().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,o){this._history.pushState(n,r,o)}replaceState(n,r,o){this._history.replaceState(n,r,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||t)};static \u0275prov=x({token:t,factory:()=>new t,providedIn:"platform"})}return t})();function JM(t,e){return t?e?t.endsWith("/")?e.startsWith("/")?t+e.slice(1):t+e:e.startsWith("/")?t+e:`${t}/${e}`:t:e}function ZM(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function zo(t){return t&&"?"!==t[0]?"?"+t:t}let Vd=(()=>{class t{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||t)};static \u0275prov=x({token:t,factory:()=>_(_q),providedIn:"root"})}return t})();const Iq=new R("");let _q=(()=>{class t extends Vd{_platformLocation;_baseHref;_removeListenerFns=[];constructor(n,r){super(),this._platformLocation=n,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??_(En).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return JM(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+zo(this._platformLocation.search),o=this._platformLocation.hash;return o&&n?`${r}${o}`:r}pushState(n,r,o,i){const s=this.prepareExternalUrl(o+zo(i));this._platformLocation.pushState(n,r,s)}replaceState(n,r,o,i){const s=this.prepareExternalUrl(o+zo(i));this._platformLocation.replaceState(n,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(r){return new(r||t)(L(YM),L(Iq,8))};static \u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),ys=(()=>{class t{_subject=new mt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(n){this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._basePath=function Sq(t){if(new RegExp("^(https?:)?//").test(t)){const[,n]=t.split(/\/\/[^\/]+/);return n}return t}(ZM(XM(r))),this._locationStrategy.onPopState(o=>{this._subject.next({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+zo(r))}normalize(n){return t.stripTrailingSlash(function wq(t,e){if(!t||!e.startsWith(t))return e;const n=e.substring(t.length);return""===n||["/",";","?","#"].includes(n[0])?n:e}(this._basePath,XM(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",o=null){this._locationStrategy.pushState(o,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+zo(r)),o)}replaceState(n,r="",o=null){this._locationStrategy.replaceState(o,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+zo(r)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(o=>o(n,r))}subscribe(n,r,o){return this._subject.subscribe({next:n,error:r??void 0,complete:o??void 0})}static normalizeQueryParams=zo;static joinWithSlash=JM;static stripTrailingSlash=ZM;static \u0275fac=function(r){return new(r||t)(L(Vd))};static \u0275prov=x({token:t,factory:()=>function Tq(){return new ys(L(Vd))}(),providedIn:"root"})}return t})();function XM(t){return t.replace(/\/index.html$/,"")}function cN(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const r=n.indexOf("="),[o,i]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(o.trim()===e)return decodeURIComponent(i)}return null}let fN=(()=>{class t{_viewContainer;_context=new hK;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(n,r){this._viewContainer=n,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){hN("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){hN("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(n,r){return!0}static \u0275fac=function(r){return new(r||t)(z(yn),z(dr))};static \u0275dir=Tt({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return t})();class hK{$implicit=null;ngIf=null}function hN(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Ge(e)}'.`)}let UK=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=My({type:t});static \u0275inj=Pl({})}return t})();function yN(t){return"server"===t}class vN{}class p8 extends Cq{supportsDOMEvents=!0}class Wv extends p8{static makeCurrent(){!function vq(t){QM??=t}(new Wv)}onAndCancel(e,n,r,o){return e.addEventListener(n,r,o),()=>{e.removeEventListener(n,r,o)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.remove()}createElement(e,n){return(n=n||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return"window"===n?window:"document"===n?e:"body"===n?e.body:null}getBaseHref(e){const n=function g8(){return Ic=Ic||document.querySelector("base"),Ic?Ic.getAttribute("href"):null}();return null==n?null:function m8(t){return new URL(t,document.baseURI).pathname}(n)}resetBaseElement(){Ic=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return cN(document.cookie,e)}}let Ic=null,v8=(()=>{class t{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||t)};static \u0275prov=x({token:t,factory:t.\u0275fac})}return t})();const Qv=new R("");let RN=(()=>{class t{_zone;_plugins;_eventNameToPlugin=new Map;constructor(n,r){this._zone=r,n.forEach(o=>{o.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,o,i){return this._findPluginFor(r).addEventListener(n,r,o,i)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(i=>i.supports(n)),!r)throw new S(5101,!1);return this._eventNameToPlugin.set(n,r),r}static \u0275fac=function(r){return new(r||t)(L(Qv),L(ce))};static \u0275prov=x({token:t,factory:t.\u0275fac})}return t})();class MN{_doc;constructor(e){this._doc=e}manager}const rf="ng-app-id";function NN(t){for(const e of t)e.remove()}function kN(t,e){const n=e.createElement("style");return n.textContent=t,n}function Yv(t,e){const n=e.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",t),n}let ON=(()=>{class t{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(n,r,o,i={}){this.doc=n,this.appId=r,this.nonce=o,this.isServer=yN(i),function C8(t,e,n,r){const o=t.head?.querySelectorAll(`style[${rf}="${e}"],link[${rf}="${e}"]`);if(o)for(const i of o)i.removeAttribute(rf),i instanceof HTMLLinkElement?r.set(i.href.slice(i.href.lastIndexOf("/")+1),{usage:0,elements:[i]}):i.textContent&&n.set(i.textContent,{usage:0,elements:[i]})}(n,r,this.inline,this.external),this.hosts.add(n.head)}addStyles(n,r){for(const o of n)this.addUsage(o,this.inline,kN);r?.forEach(o=>this.addUsage(o,this.external,Yv))}removeStyles(n,r){for(const o of n)this.removeUsage(o,this.inline);r?.forEach(o=>this.removeUsage(o,this.external))}addUsage(n,r,o){const i=r.get(n);i?i.usage++:r.set(n,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,o(n,this.doc)))})}removeUsage(n,r){const o=r.get(n);o&&(o.usage--,o.usage<=0&&(NN(o.elements),r.delete(n)))}ngOnDestroy(){for(const[,{elements:n}]of[...this.inline,...this.external])NN(n);this.hosts.clear()}addHost(n){this.hosts.add(n);for(const[r,{elements:o}]of this.inline)o.push(this.addElement(n,kN(r,this.doc)));for(const[r,{elements:o}]of this.external)o.push(this.addElement(n,Yv(r,this.doc)))}removeHost(n){this.hosts.delete(n)}addElement(n,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(rf,this.appId),n.appendChild(r)}static \u0275fac=function(r){return new(r||t)(L(En),L(bo),L(Tw,8),L(Ro))};static \u0275prov=x({token:t,factory:t.\u0275fac})}return t})();const Jv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Zv=/%COMP%/g,S8=new R("",{providedIn:"root",factory:()=>!0});function xN(t,e){return e.map(n=>n.replace(Zv,t))}let FN=(()=>{class t{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(n,r,o,i,s,a,c,l=null,u=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=i,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=l,this.tracingService=u,this.platformIsServer=yN(a),this.defaultRenderer=new Xv(n,s,c,this.platformIsServer,this.tracingService)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===an.ShadowDom&&(r={...r,encapsulation:an.Emulated});const o=this.getOrCreateRenderer(n,r);return o instanceof UN?o.applyToHost(n):o instanceof eC&&o.applyStyles(),o}getOrCreateRenderer(n,r){const o=this.rendererByCompId;let i=o.get(r.id);if(!i){const s=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer,f=this.tracingService;switch(r.encapsulation){case an.Emulated:i=new UN(c,l,r,this.appId,u,s,a,d,f);break;case an.ShadowDom:return new R8(c,l,n,r,s,a,this.nonce,d,f);default:i=new eC(c,l,r,u,s,a,d,f)}o.set(r.id,i)}return i}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(n){this.rendererByCompId.delete(n)}static \u0275fac=function(r){return new(r||t)(L(RN),L(ON),L(bo),L(S8),L(En),L(Ro),L(ce),L(Tw),L(Fi,8))};static \u0275prov=x({token:t,factory:t.\u0275fac})}return t})();class Xv{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,n,r,o,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=o,this.tracingService=i}destroy(){}destroyNode=null;createElement(e,n){return n?this.doc.createElementNS(Jv[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(LN(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(LN(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){n.remove()}selectRootElement(e,n){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new S(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,o){if(o){n=o+":"+n;const i=Jv[o];i?e.setAttributeNS(i,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){const o=Jv[r];o?e.removeAttributeNS(o,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,o){o&(Or.DashCase|Or.Important)?e.style.setProperty(n,r,o&Or.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Or.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){null!=e&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r,o){if("string"==typeof e&&!(e=ms().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${n}`);let i=this.decoratePreventDefault(r);return null!==this.tracingService&&this.tracingService.wrapEventListener&&(i=this.tracingService.wrapEventListener(e,n,i)),this.eventManager.addEventListener(e,n,i,o)}decoratePreventDefault(e){return n=>{if("__ngUnwrap__"===n)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))&&n.preventDefault()}}}function LN(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class R8 extends Xv{sharedStylesHost;hostEl;shadowRoot;constructor(e,n,r,o,i,s,a,c,l){super(e,i,s,c,l),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=o.styles;u=xN(o.id,u);for(const f of u){const h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=f,this.shadowRoot.appendChild(h)}const d=o.getExternalStyles?.();if(d)for(const f of d){const h=Yv(f,i);a&&h.setAttribute("nonce",a),this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(null,n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class eC extends Xv{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,n,r,o,i,s,a,c,l){super(e,i,s,a,c),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=o;let u=r.styles;this.styles=l?xN(l,u):u,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}}class UN extends eC{contentAttr;hostAttr;constructor(e,n,r,o,i,s,a,c,l){const u=o+"-"+r.id;super(e,n,r,i,s,a,c,l,u),this.contentAttr=function D8(t){return"_ngcontent-%COMP%".replace(Zv,t)}(u),this.hostAttr=function A8(t){return"_nghost-%COMP%".replace(Zv,t)}(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){const r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}}const HN=["alt","control","meta","shift"],N8={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},k8={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};function BN(t){return{appProviders:[...B8,...t?.providers??[]],platformProviders:U8}}const U8=[{provide:Ro,useValue:"browser"},{provide:em,useValue:function x8(){Wv.makeCurrent()},multi:!0},{provide:En,useFactory:function L8(){return function CL(t){Xg=t}(document),document},deps:[]}],B8=[{provide:lg,useValue:"root"},{provide:Hn,useFactory:function F8(){return new Hn},deps:[]},{provide:Qv,useClass:(()=>{class t extends MN{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,o,i){return n.addEventListener(r,o,i),()=>this.removeEventListener(n,r,o,i)}removeEventListener(n,r,o,i){return n.removeEventListener(r,o,i)}static \u0275fac=function(r){return new(r||t)(L(En))};static \u0275prov=x({token:t,factory:t.\u0275fac})}return t})(),multi:!0,deps:[En,ce,Ro]},{provide:Qv,useClass:(()=>{class t extends MN{constructor(n){super(n)}supports(n){return null!=t.parseEventName(n)}addEventListener(n,r,o,i){const s=t.parseEventName(r),a=t.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ms().onAndCancel(n,s.domEventName,a,i))}static parseEventName(n){const r=n.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const i=t._normalizeKey(r.pop());let s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),HN.forEach(l=>{const u=r.indexOf(l);u>-1&&(r.splice(u,1),s+=l+".")}),s+=i,0!=r.length||0===i.length)return null;const c={};return c.domEventName=o,c.fullKey=s,c}static matchEventFullKeyCode(n,r){let o=N8[n.key]||n.key,i="";return r.indexOf("code.")>-1&&(o=n.code,i="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),HN.forEach(s=>{s!==o&&(0,k8[s])(n)&&(i+=s+".")}),i+=o,i===r)}static eventCallback(n,r,o){return i=>{t.matchEventFullKeyCode(i,n)&&o.runGuarded(()=>r(i))}}static _normalizeKey(n){return"esc"===n?"escape":n}static \u0275fac=function(r){return new(r||t)(L(En))};static \u0275prov=x({token:t,factory:t.\u0275fac})}return t})(),multi:!0,deps:[En]},FN,ON,RN,{provide:hy,useExisting:FN},{provide:vN,useClass:v8,deps:[]},[]];function Gr(t){return this instanceof Gr?(this.v=t,this):new Gr(t)}function qN(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function iC(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(s){return new Promise(function(a,c){!function o(i,s,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},s)}(a,c,(s=t[i](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const KN=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function WN(t){return we(t?.then)}function QN(t){return we(t[jp])}function YN(t){return Symbol.asyncIterator&&we(t?.[Symbol.asyncIterator])}function JN(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ZN=function E4(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function XN(t){return we(t?.[ZN])}function ek(t){return function GN(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(t,e||[]),i=[];return o=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function s(h){return function(p){return Promise.resolve(p).then(h,d)}}),o[Symbol.asyncIterator]=function(){return this},o;function a(h,p){r[h]&&(o[h]=function(m){return new Promise(function(v,E){i.push([h,m,v,E])>1||c(h,m)})},p&&(o[h]=p(o[h])))}function c(h,p){try{!function l(h){h.value instanceof Gr?Promise.resolve(h.value.v).then(u,d):f(i[0][2],h)}(r[h](p))}catch(m){f(i[0][3],m)}}function u(h){c("next",h)}function d(h){c("throw",h)}function f(h,p){h(p),i.shift(),i.length&&c(i[0][0],i[0][1])}}(this,arguments,function*(){const n=t.getReader();try{for(;;){const{value:r,done:o}=yield Gr(n.read());if(o)return yield Gr(void 0);yield yield Gr(r)}}finally{n.releaseLock()}})}function tk(t){return we(t?.getReader)}function gr(t){if(t instanceof ze)return t;if(null!=t){if(QN(t))return function I4(t){return new ze(e=>{const n=t[jp]();if(we(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(KN(t))return function _4(t){return new ze(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}(t);if(WN(t))return function T4(t){return new ze(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,C_)})}(t);if(YN(t))return nk(t);if(XN(t))return function w4(t){return new ze(e=>{for(const n of t)if(e.next(n),e.closed)return;e.complete()})}(t);if(tk(t))return function S4(t){return nk(ek(t))}(t)}throw JN(t)}function nk(t){return new ze(e=>{(function D4(t,e){var n,r,o,i;return function $N(t,e,n,r){return new(n||(n=Promise))(function(i,s){function a(u){try{l(r.next(u))}catch(d){s(d)}}function c(u){try{l(r.throw(u))}catch(d){s(d)}}function l(u){u.done?i(u.value):function o(i){return i instanceof n?i:new n(function(s){s(i)})}(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){try{for(n=qN(t);!(r=yield n.next()).done;)if(e.next(r.value),e.closed)return}catch(s){o={error:s}}finally{try{r&&!r.done&&(i=n.return)&&(yield i.call(n))}finally{if(o)throw o.error}}e.complete()})})(t,e).catch(n=>e.error(n))})}function mr(t,e,n,r=0,o=!1){const i=e.schedule(function(){n(),o?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(i),!o)return i}function rk(t,e=0){return it((n,r)=>{n.subscribe(et(r,o=>mr(r,t,()=>r.next(o),e),()=>mr(r,t,()=>r.complete(),e),o=>mr(r,t,()=>r.error(o),e)))})}function ok(t,e=0){return it((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function ik(t,e){if(!t)throw new Error("Iterable cannot be null");return new ze(n=>{mr(n,e,()=>{const r=t[Symbol.asyncIterator]();mr(n,e,()=>{r.next().then(o=>{o.done?n.complete():n.next(o.value)})},0,!0)})})}function Ee(t,e){return e?function k4(t,e){if(null!=t){if(QN(t))return function A4(t,e){return gr(t).pipe(ok(e),rk(e))}(t,e);if(KN(t))return function R4(t,e){return new ze(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}(t,e);if(WN(t))return function b4(t,e){return gr(t).pipe(ok(e),rk(e))}(t,e);if(YN(t))return ik(t,e);if(XN(t))return function M4(t,e){return new ze(n=>{let r;return mr(n,e,()=>{r=t[ZN](),mr(n,e,()=>{let o,i;try{({value:o,done:i}=r.next())}catch(s){return void n.error(s)}i?n.complete():n.next(o)},0,!0)}),()=>we(r?.return)&&r.return()})}(t,e);if(tk(t))return function N4(t,e){return ik(ek(t),e)}(t,e)}throw JN(t)}(t,e):gr(t)}function Q(...t){return Ee(t,function sf(t){return function G8(t){return t&&we(t.schedule)}(function tC(t){return t[t.length-1]}(t))?t.pop():void 0}(t))}function At(t,e,n=1/0){return we(e)?At((r,o)=>oe((i,s)=>e(r,i,o,s))(gr(t(r,o))),n):("number"==typeof e&&(n=e),it((r,o)=>function O4(t,e,n,r,o,i,s,a){const c=[];let l=0,u=0,d=!1;const f=()=>{d&&!c.length&&!l&&e.complete()},h=m=>l<r?p(m):c.push(m),p=m=>{i&&e.next(m),l++;let v=!1;gr(n(m,u++)).subscribe(et(e,E=>{o?.(E),i?h(E):e.next(E)},()=>{v=!0},void 0,()=>{if(v)try{for(l--;c.length&&l<r;){const E=c.shift();s?mr(e,s,()=>p(E)):p(E)}f()}catch(E){e.error(E)}}))};return t.subscribe(et(e,h,()=>{d=!0,f()})),()=>{a?.()}}(r,o,t,n)))}class cf{}class lf{}class fn{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(n=>{const r=n.indexOf(":");if(r>0){const o=n.slice(0,r),i=n.slice(r+1).trim();this.addHeaderEntry(o,i)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,r)=>{this.addHeaderEntry(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof fn?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){const n=new fn;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof fn?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){const n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,n);const o=("a"===e.op?this.headers.get(n):void 0)||[];o.push(...r),this.headers.set(n,o);break;case"d":const i=e.value;if(i){let s=this.headers.get(n);if(!s)return;s=s.filter(a=>-1===i.indexOf(a)),0===s.length?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,s)}else this.headers.delete(n),this.normalizedNames.delete(n)}}addHeaderEntry(e,n){const r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(n):this.headers.set(r,[n])}setHeaderEntries(e,n){const r=(Array.isArray(n)?n:[n]).map(i=>i.toString()),o=e.toLowerCase();this.headers.set(o,r),this.maybeSetNormalizedName(e,o)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}}class P4{encodeKey(e){return sk(e)}encodeValue(e){return sk(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const F4=/%(\d[a-f0-9])/gi,L4={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function sk(t){return encodeURIComponent(t).replace(F4,(e,n)=>L4[n]??e)}function uf(t){return`${t}`}class Kr{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new P4,e.fromString){if(e.fromObject)throw new S(2805,!1);this.map=function x4(t,e){const n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(o=>{const i=o.indexOf("="),[s,a]=-1==i?[e.decodeKey(o),""]:[e.decodeKey(o.slice(0,i)),e.decodeValue(o.slice(i+1))],c=n.get(s)||[];c.push(a),n.set(s,c)}),n}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{const r=e.fromObject[n],o=Array.isArray(r)?r.map(uf):[uf(r)];this.map.set(n,o)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){const n=[];return Object.keys(e).forEach(r=>{const o=e[r];Array.isArray(o)?o.forEach(i=>{n.push({param:r,value:i,op:"a"})}):n.push({param:r,value:o,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const n=new Kr({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const n=("a"===e.op?this.map.get(e.param):void 0)||[];n.push(uf(e.value)),this.map.set(e.param,n);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const o=r.indexOf(uf(e.value));-1!==o&&r.splice(o,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class U4{map=new Map;set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function ak(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function ck(t){return typeof Blob<"u"&&t instanceof Blob}function lk(t){return typeof FormData<"u"&&t instanceof FormData}const wc="Content-Type",aC="X-Request-URL",uk="text/plain",dk="application/json",fk=`${dk}, ${uk}, */*`;class Sc{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,n,r,o){let i;if(this.url=n,this.method=e.toUpperCase(),function H4(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||o?(this.body=void 0!==r?r:null,i=o):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params),this.transferCache=i.transferCache),this.headers??=new fn,this.context??=new U4,this.params){const s=this.params.toString();if(0===s.length)this.urlWithParams=n;else{const a=n.indexOf("?");this.urlWithParams=n+(-1===a?"?":a<n.length-1?"&":"")+s}}else this.params=new Kr,this.urlWithParams=n}serializeBody(){return null===this.body?null:"string"==typeof this.body||ak(this.body)||ck(this.body)||lk(this.body)||function B4(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}(this.body)?this.body:this.body instanceof Kr?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||lk(this.body)?null:ck(this.body)?this.body.type||null:ak(this.body)?null:"string"==typeof this.body?uk:this.body instanceof Kr?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?dk:null}clone(e={}){const n=e.method||this.method,r=e.url||this.url,o=e.responseType||this.responseType,i=e.transferCache??this.transferCache,s=void 0!==e.body?e.body:this.body,a=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress;let l=e.headers||this.headers,u=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((f,h)=>f.set(h,e.setHeaders[h]),l)),e.setParams&&(u=Object.keys(e.setParams).reduce((f,h)=>f.set(h,e.setParams[h]),u)),new Sc(n,r,s,{params:u,headers:l,context:d,reportProgress:c,responseType:o,withCredentials:a,transferCache:i})}}var Wr=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(Wr||{});class cC{headers;status;statusText;url;ok;type;constructor(e,n=200,r="OK"){this.headers=e.headers||new fn,this.status=void 0!==e.status?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class ff extends cC{constructor(e={}){super(e)}type=Wr.ResponseHeader;clone(e={}){return new ff({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Go extends cC{body;constructor(e={}){super(e),this.body=void 0!==e.body?e.body:null}type=Wr.Response;clone(e={}){return new Go({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Es extends cC{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function lC(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}let $4=(()=>{class t{handler;constructor(n){this.handler=n}request(n,r,o={}){let i;if(n instanceof Sc)i=n;else{let c,l;c=o.headers instanceof fn?o.headers:new fn(o.headers),o.params&&(l=o.params instanceof Kr?o.params:new Kr({fromObject:o.params})),i=new Sc(n,r,void 0!==o.body?o.body:null,{headers:c,context:o.context,params:l,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache})}const s=Q(i).pipe(function Tc(t,e){return we(e)?At(t,e,1):At(t,1)}(c=>this.handler.handle(c)));if(n instanceof Sc||"events"===o.observe)return s;const a=s.pipe(function qr(t,e){return it((n,r)=>{let o=0;n.subscribe(et(r,i=>t.call(e,i,o++)&&r.next(i)))})}(c=>c instanceof Go));switch(o.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return a.pipe(oe(c=>{if(null!==c.body&&!(c.body instanceof ArrayBuffer))throw new S(2806,!1);return c.body}));case"blob":return a.pipe(oe(c=>{if(null!==c.body&&!(c.body instanceof Blob))throw new S(2807,!1);return c.body}));case"text":return a.pipe(oe(c=>{if(null!==c.body&&"string"!=typeof c.body)throw new S(2808,!1);return c.body}));default:return a.pipe(oe(c=>c.body))}case"response":return a;default:throw new S(2809,!1)}}delete(n,r={}){return this.request("DELETE",n,r)}get(n,r={}){return this.request("GET",n,r)}head(n,r={}){return this.request("HEAD",n,r)}jsonp(n,r){return this.request("JSONP",n,{params:(new Kr).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,r={}){return this.request("OPTIONS",n,r)}patch(n,r,o={}){return this.request("PATCH",n,lC(o,r))}post(n,r,o={}){return this.request("POST",n,lC(o,r))}put(n,r,o={}){return this.request("PUT",n,lC(o,r))}static \u0275fac=function(r){return new(r||t)(L(cf))};static \u0275prov=x({token:t,factory:t.\u0275fac})}return t})();const gk=new R("");function mk(t,e){return e(t)}const Dc=new R(""),yk=new R(""),vk=new R("",{providedIn:"root",factory:()=>!0});let Ck=(()=>{class t extends cf{backend;injector;chain=null;pendingTasks=_(Un);contributeToStability=_(vk);constructor(n,r){super(),this.backend=n,this.injector=r}handle(n){if(null===this.chain){const r=Array.from(new Set([...this.injector.get(Dc),...this.injector.get(yk,[])]));this.chain=r.reduceRight((o,i)=>function W4(t,e,n){return(r,o)=>pn(n,()=>e(r,i=>t(i,o)))}(o,i,this.injector),mk)}if(this.contributeToStability){const r=this.pendingTasks.add();return this.chain(n,o=>this.backend.handle(o)).pipe(function af(t){return it((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}(()=>this.pendingTasks.remove(r)))}return this.chain(n,r=>this.backend.handle(r))}static \u0275fac=function(r){return new(r||t)(L(lf),L(xt))};static \u0275prov=x({token:t,factory:t.\u0275fac})}return t})();const t3=/^\)\]\}',?\n/,n3=RegExp(`^${aC}:`,"m");let Ik=(()=>{class t{xhrFactory;constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new S(-2800,!1);const r=this.xhrFactory;return(r.\u0275loadImpl?Ee(r.\u0275loadImpl()):Q(null)).pipe(function Gn(t,e){return it((n,r)=>{let o=null,i=0,s=!1;const a=()=>s&&!o&&r.complete();n.subscribe(et(r,c=>{o?.unsubscribe();let l=0;const u=i++;gr(t(c,u)).subscribe(o=et(r,d=>r.next(e?e(c,d,u,l++):d),()=>{o=null,a()}))},()=>{s=!0,a()}))})}(()=>new ze(i=>{const s=r.build();if(s.open(n.method,n.urlWithParams),n.withCredentials&&(s.withCredentials=!0),n.headers.forEach((m,v)=>s.setRequestHeader(m,v.join(","))),n.headers.has("Accept")||s.setRequestHeader("Accept",fk),!n.headers.has(wc)){const m=n.detectContentTypeHeader();null!==m&&s.setRequestHeader(wc,m)}if(n.responseType){const m=n.responseType.toLowerCase();s.responseType="json"!==m?m:"text"}const a=n.serializeBody();let c=null;const l=()=>{if(null!==c)return c;const m=s.statusText||"OK",v=new fn(s.getAllResponseHeaders()),E=function r3(t){return"responseURL"in t&&t.responseURL?t.responseURL:n3.test(t.getAllResponseHeaders())?t.getResponseHeader(aC):null}(s)||n.url;return c=new ff({headers:v,status:s.status,statusText:m,url:E}),c},u=()=>{let{headers:m,status:v,statusText:E,url:C}=l(),A=null;204!==v&&(A=typeof s.response>"u"?s.responseText:s.response),0===v&&(v=A?200:0);let P=v>=200&&v<300;if("json"===n.responseType&&"string"==typeof A){const O=A;A=A.replace(t3,"");try{A=""!==A?JSON.parse(A):null}catch(De){A=O,P&&(P=!1,A={error:De,text:A})}}P?(i.next(new Go({body:A,headers:m,status:v,statusText:E,url:C||void 0})),i.complete()):i.error(new Es({error:A,headers:m,status:v,statusText:E,url:C||void 0}))},d=m=>{const{url:v}=l(),E=new Es({error:m,status:s.status||0,statusText:s.statusText||"Unknown Error",url:v||void 0});i.error(E)};let f=!1;const h=m=>{f||(i.next(l()),f=!0);let v={type:Wr.DownloadProgress,loaded:m.loaded};m.lengthComputable&&(v.total=m.total),"text"===n.responseType&&s.responseText&&(v.partialText=s.responseText),i.next(v)},p=m=>{let v={type:Wr.UploadProgress,loaded:m.loaded};m.lengthComputable&&(v.total=m.total),i.next(v)};return s.addEventListener("load",u),s.addEventListener("error",d),s.addEventListener("timeout",d),s.addEventListener("abort",d),n.reportProgress&&(s.addEventListener("progress",h),null!==a&&s.upload&&s.upload.addEventListener("progress",p)),s.send(a),i.next({type:Wr.Sent}),()=>{s.removeEventListener("error",d),s.removeEventListener("abort",d),s.removeEventListener("load",u),s.removeEventListener("timeout",d),n.reportProgress&&(s.removeEventListener("progress",h),null!==a&&s.upload&&s.upload.removeEventListener("progress",p)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(r){return new(r||t)(L(vN))};static \u0275prov=x({token:t,factory:t.\u0275fac})}return t})();const fC=new R(""),_k=new R("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Tk=new R("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class wk{}let a3=(()=>{class t{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(n,r,o){this.doc=n,this.platform=r,this.cookieName=o}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=cN(n,this.cookieName),this.lastCookieString=n),this.lastToken}static \u0275fac=function(r){return new(r||t)(L(En),L(Ro),L(_k))};static \u0275prov=x({token:t,factory:t.\u0275fac})}return t})();function c3(t,e){const n=t.url.toLowerCase();if(!_(fC)||"GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e(t);const r=_(wk).getToken(),o=_(Tk);return null!=r&&!t.headers.has(o)&&(t=t.clone({headers:t.headers.set(o,r)})),e(t)}function l3(...t){const e=[$4,Ik,Ck,{provide:cf,useExisting:Ck},{provide:lf,useFactory:()=>_(gk,{optional:!0})??_(Ik)},{provide:Dc,useValue:c3,multi:!0},{provide:fC,useValue:!0},{provide:wk,useClass:a3}];for(const n of t)e.push(...n.\u0275providers);return function Tr(t){return{\u0275providers:t}}(e)}kp(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});new ze(t=>t.complete());const Ac=Symbol("RouteTitle");class V3{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){const n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function Ts(t){return new V3(t)}class NW{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return function Pc(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){const n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new xc(this.rootInjector)}}let xc=(()=>{class t{rootInjector;contexts=new Map;constructor(n){this.rootInjector=n}onChildOutletCreated(n,r){const o=this.getOrCreateContext(n);o.outlet=r,this.contexts.set(n,o)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new NW(this.rootInjector),this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static \u0275fac=function(r){return new(r||t)(L(xt))};static \u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class Ds{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,n,r,o,i,s,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=o,this.dataSubject=i,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(oe(l=>l[Ac]))??Q(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=o,this.data=i}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(oe(e=>Ts(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(oe(e=>Ts(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}const OW=new R("");let NC=(()=>{class t{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name="primary";activateEvents=new Kt;deactivateEvents=new Kt;attachEvents=new Kt;detachEvents=new Kt;routerOutletData=QF(void 0);parentContexts=_(xc);location=_(yn);changeDetector=_(Rd);inputBinder=_(Af,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(n){if(n.name){const{firstChange:r,previousValue:o}=n.name;if(r)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new S(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new S(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new S(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new S(4013,!1);this._activatedRoute=n;const o=this.location,s=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new kC(n,a,o.injector,this.routerOutletData);this.activated=o.createComponent(s,{index:o.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||t)};static \u0275dir=Tt({type:t,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Ri]})}return t})();class kC{route;childContexts;parent;outletData;__ngOutletInjector(e){return new kC(this.route,this.childContexts,e,this.outletData)}constructor(e,n,r,o){this.route=e,this.childContexts=n,this.parent=r,this.outletData=o}get(e,n){return e===Ds?this.route:e===xc?this.childContexts:e===OW?this.outletData:this.parent.get(e,n)}}const Af=new R("");Error;const J6={auth:{clientId:"fb2b3471-e81a-4a45-94e1-9acafa5fee05",authority:"https://login.microsoftonline.com/d21da106-c49f-4232-beb2-392b49819418",redirectUri:"http://localhost:4200/"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}},Z6={scopes:["User.Read"]},w={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Ms=[w.OPENID_SCOPE,w.PROFILE_SCOPE,w.OFFLINE_ACCESS_SCOPE],kO=[...Ms,w.EMAIL_SCOPE],ct={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},$C="appmetadata",lt={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},de={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},hn_CHANNEL_ID="53ee284d-920a-4b59-9d30-a60315b26836";var U=function(t){return t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none",t}(U||{});const UO={scopes:Ms},GC="msal.db",o5=`${GC}.keys`,i5=[0,5,4];class s5{static getInteractionStatusFromEvent(e,n){switch(e.eventType){case"msal:loginStart":return"login";case"msal:ssoSilentStart":return"ssoSilent";case"msal:acquireTokenStart":if(e.interactionType===U.Redirect||e.interactionType===U.Popup)return"acquireToken";break;case"msal:handleRedirectStart":return"handleRedirect";case"msal:logoutStart":return"logout";case"msal:ssoSilentSuccess":case"msal:ssoSilentFailure":if(n&&"ssoSilent"!==n)break;return"none";case"msal:logoutEnd":if(n&&"logout"!==n)break;return"none";case"msal:handleRedirectEnd":if(n&&"handleRedirect"!==n)break;return"none";case"msal:loginSuccess":case"msal:loginFailure":case"msal:acquireTokenSuccess":case"msal:acquireTokenFailure":case"msal:restoreFromBFCache":if(e.interactionType===U.Redirect||e.interactionType===U.Popup){if(n&&"login"!==n&&"acquireToken"!==n)break;return"none"}}return null}}const BO={now:()=>(BO.delegate||Date).now(),delegate:void 0};class a5 extends mt{constructor(e=1/0,n=1/0,r=BO){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){const{isStopped:n,_buffer:r,_infiniteTimeWindow:o,_timestampProvider:i,_windowTime:s}=this;n||(r.push(e),!o&&r.push(i.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:o}=this,i=o.slice();for(let s=0;s<i.length&&!e.closed;s+=r?1:2)e.next(i[s]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){const{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:o}=this,i=(o?1:2)*e;if(e<1/0&&i<r.length&&r.splice(0,r.length-i),!o){const s=n.now();let a=0;for(let c=1;c<r.length&&r[c]<=s;c+=2)a=c;a&&r.splice(0,a+1)}}}const jf="@azure/msal-angular",zc="4.0.19",qC=new R("MSAL_INSTANCE"),c5=(new R("MSAL_GUARD_CONFIG"),new R("MSAL_INTERCEPTOR_CONFIG"),new R("MSAL_BROADCAST_CONFIG"));let jO=(()=>{class t{constructor(n,r){this.msalInstance=n,this.msalBroadcastConfig=r,this.msalBroadcastConfig&&this.msalBroadcastConfig.eventsToReplay>0?(this.msalInstance.getLogger().clone(jf,zc).verbose(`BroadcastService - eventsToReplay set on BroadcastConfig, replaying the last ${this.msalBroadcastConfig.eventsToReplay} events`),this._msalSubject=new a5(this.msalBroadcastConfig.eventsToReplay)):this._msalSubject=new mt,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new zt("startup"),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(o=>{this._msalSubject.next(o);const i=s5.getInteractionStatusFromEvent(o,this._inProgress.value);null!==i&&(this.msalInstance.getLogger().clone(jf,zc).verbose(`BroadcastService - ${o.eventType} results in setting inProgress from ${this._inProgress.value} to ${i}`),this._inProgress.next(i))})}resetInProgressEvent(){"startup"===this._inProgress.value&&this._inProgress.next("none")}}return t.\u0275fac=function(n){return new(n||t)(L(qC),L(c5,8))},t.\u0275prov=x({token:t,factory:t.\u0275fac}),t})(),VO=(()=>{class t{constructor(n,r,o){this.instance=n,this.location=r,this.injector=o;const i=this.location.path(!0).split("#").pop();i&&(this.redirectHash=`#${i}`),this.instance.initializeWrapperLibrary("@azure/msal-angular",zc)}initialize(){return Ee(this.instance.initialize())}acquireTokenPopup(n){return Ee(this.instance.acquireTokenPopup(n))}acquireTokenRedirect(n){return Ee(this.instance.acquireTokenRedirect(n))}acquireTokenSilent(n){return Ee(this.instance.acquireTokenSilent(n))}handleRedirectObservable(n){return Ee(this.instance.initialize().then(()=>this.instance.handleRedirectPromise(n||this.redirectHash)).finally(()=>{this.injector.get(jO).resetInProgressEvent()}))}loginPopup(n){return Ee(this.instance.loginPopup(n))}loginRedirect(n){return Ee(this.instance.loginRedirect(n))}logout(n){return Ee(this.instance.logout(n))}logoutRedirect(n){return Ee(this.instance.logoutRedirect(n))}logoutPopup(n){return Ee(this.instance.logoutPopup(n))}ssoSilent(n){return Ee(this.instance.ssoSilent(n))}getLogger(){return this.logger||(this.logger=this.instance.getLogger().clone(jf,zc)),this.logger}setLogger(n){this.logger=n.clone(jf,zc),this.instance.setLogger(n)}}return t.\u0275fac=function(n){return new(n||t)(L(qC),L(ys),L(Qe))},t.\u0275prov=x({token:t,factory:t.\u0275fac}),t})();function l5(t,e){if(1&t){const n=rv();jr(0,"button",3),ic("click",function(){return wg(n),Sg(_d().login())}),sc(1,"Login with Microsoft"),jo()}}function u5(t,e){if(1&t){const n=rv();jr(0,"span"),sc(1),jr(2,"button",3),ic("click",function(){return wg(n),Sg(_d().logout())}),sc(3,"Logout"),jo()()}if(2&t){const n=_d();Uu(),Td(" Welcome, ",n.userName," ")}}let d5=(()=>{class t{constructor(n){this.msal=n,this.userName=null}login(){this.msal.loginPopup(Z6).subscribe({next:n=>{this.userName=n.account?.username||null,console.log("Login success:",n)},error:n=>console.error(n)})}logout(){this.msal.logoutPopup().subscribe({next:n=>{this.userName=null,console.log("Logout success:",n)},error:n=>console.error(n)})}static{this.\u0275fac=function(r){return new(r||t)(z(VO))}}static{this.\u0275cmp=Ry({type:t,selectors:[["app-root"]],decls:8,vars:2,consts:[[2,"padding","10px","background","#f4f4f4","display","flex","justify-content","space-between","align-items","center"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"]],template:function(r,o){1&r&&(jr(0,"header",0)(1,"div")(2,"strong"),sc(3,"HR Connect"),jo()(),jr(4,"div"),Oy(5,l5,2,0,"button",1)(6,u5,4,1,"span",2),jo()(),yd(7,"router-outlet")),2&r&&(Uu(5),pd("ngIf",!o.userName),Uu(),pd("ngIf",o.userName))},dependencies:[NC,UK,fN],encapsulation:2})}}return t})();var Ne=function(t){return t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace",t}(Ne||{});class to{constructor(e,n,r){this.level=Ne.Info;const i=e||to.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||(()=>{}),this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level="number"==typeof i.logLevel?i.logLevel:Ne.Info,this.correlationId=i.correlationId||w.EMPTY_STRING,this.packageName=n||w.EMPTY_STRING,this.packageVersion=r||w.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Ne.Info}}clone(e,n,r){return new to({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,n)}logMessage(e,n){if(n.logLevel>this.level||!this.piiLoggingEnabled&&n.containsPii)return;const i=`[${(new Date).toUTCString()}] : [${n.correlationId||this.correlationId||""}] : ${this.packageName}@${this.packageVersion} : ${Ne[n.logLevel]} - ${e}`;this.executeCallback(n.logLevel,i,n.containsPii||!1)}executeCallback(e,n,r){this.localCallback&&this.localCallback(e,n,r)}error(e,n){this.logMessage(e,{logLevel:Ne.Error,containsPii:!1,correlationId:n||w.EMPTY_STRING})}errorPii(e,n){this.logMessage(e,{logLevel:Ne.Error,containsPii:!0,correlationId:n||w.EMPTY_STRING})}warning(e,n){this.logMessage(e,{logLevel:Ne.Warning,containsPii:!1,correlationId:n||w.EMPTY_STRING})}warningPii(e,n){this.logMessage(e,{logLevel:Ne.Warning,containsPii:!0,correlationId:n||w.EMPTY_STRING})}info(e,n){this.logMessage(e,{logLevel:Ne.Info,containsPii:!1,correlationId:n||w.EMPTY_STRING})}infoPii(e,n){this.logMessage(e,{logLevel:Ne.Info,containsPii:!0,correlationId:n||w.EMPTY_STRING})}verbose(e,n){this.logMessage(e,{logLevel:Ne.Verbose,containsPii:!1,correlationId:n||w.EMPTY_STRING})}verbosePii(e,n){this.logMessage(e,{logLevel:Ne.Verbose,containsPii:!0,correlationId:n||w.EMPTY_STRING})}trace(e,n){this.logMessage(e,{logLevel:Ne.Trace,containsPii:!1,correlationId:n||w.EMPTY_STRING})}tracePii(e,n){this.logMessage(e,{logLevel:Ne.Trace,containsPii:!0,correlationId:n||w.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const ks="unexpected_error",WC="post_request_failed",Vf={[ks]:"Unexpected error in authentication.",[WC]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class me extends Error{constructor(e,n,r){super(n?`${e}: ${n}`:e),Object.setPrototypeOf(this,me.prototype),this.errorCode=e||w.EMPTY_STRING,this.errorMessage=n||w.EMPTY_STRING,this.subError=r||w.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function QC(t,e){return new me(t,e?`${Vf[t]} ${e}`:Vf[t])}const Gc="client_info_decoding_error",$f="client_info_empty_error",qc="token_parsing_error",zf="null_or_empty_token",Dn="endpoints_resolution_error",Gf="network_error",qf="openid_config_error",Kf="hash_not_deserialized",no="invalid_state",Wf="state_mismatch",Kc="state_not_found",Qf="nonce_mismatch",Wc="auth_time_not_found",Yf="max_age_transpired",YC="multiple_matching_tokens",JC="multiple_matching_accounts",Jf="multiple_matching_appMetadata",Zf="request_cannot_be_made",Xf="cannot_remove_empty_scope",eh="cannot_append_scopeset",Qc="empty_input_scopeset",ZC="device_code_polling_cancelled",XC="device_code_expired",eE="device_code_unknown_error",Yc="no_account_in_silent_request",th="invalid_cache_record",Jc="invalid_cache_environment",Zc="no_account_found",Xc="no_crypto_object",tE="unexpected_credential_type",nE="invalid_assertion",rE="invalid_client_credential",Qn="token_refresh_required",oE="user_timeout_reached",nh="token_claims_cnf_required_for_signedjwt",rh="authorization_code_missing_from_server_response",oh="binding_key_not_removed",ih="end_session_endpoint_not_supported",el="key_id_missing",iE="no_network_connectivity",sE="user_canceled",aE="missing_tenant_id_error",X="method_not_implemented",cE="nested_app_auth_bridge_disabled",W={[Gc]:"The client info could not be parsed/decoded correctly",[$f]:"The client info was empty",[qc]:"Token cannot be parsed",[zf]:"The token is null or empty",[Dn]:"Endpoints cannot be resolved",[Gf]:"Network request failed",[qf]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Kf]:"The hash parameters could not be deserialized",[no]:"State was not the expected format",[Wf]:"State mismatch error",[Kc]:"State not found",[Qf]:"Nonce mismatch error",[Wc]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Yf]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[YC]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[JC]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Jf]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Zf]:"Token request cannot be made without authorization code or refresh token.",[Xf]:"Cannot remove null or empty scope from ScopeSet",[eh]:"Cannot append ScopeSet",[Qc]:"Empty input ScopeSet cannot be processed",[ZC]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[XC]:"Device code is expired.",[eE]:"Device code stopped polling for unknown reasons.",[Yc]:"Please pass an account object, silent flow is not supported without account information",[th]:"Cache record object was null or undefined.",[Jc]:"Invalid environment when attempting to create cache entry",[Zc]:"No account found in cache for given key.",[Xc]:"No crypto object detected.",[tE]:"Unexpected credential type.",[nE]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[rE]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Qn]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[oE]:"User defined timeout for device code polling reached",[nh]:"Cannot generate a POP jwt if the token_claims are not populated",[rh]:"Server response does not contain an authorization code to proceed",[oh]:"Could not remove the credential's binding key from storage.",[ih]:"The provided authority does not support logout",[el]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[iE]:"No network connectivity. Check your internet connection.",[sE]:"User cancelled the flow.",[aE]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[X]:"This method has not been implemented",[cE]:"The nested app auth bridge is disabled"};class lE extends me{constructor(e,n){super(e,n?`${W[e]}: ${n}`:W[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,lE.prototype)}}function b(t,e){return new lE(t,e)}const sh={createNewGuid:()=>{throw b(X)},base64Decode:()=>{throw b(X)},base64Encode:()=>{throw b(X)},base64UrlEncode:()=>{throw b(X)},encodeKid:()=>{throw b(X)},getPublicKeyThumbprint:()=>y(function*(){throw b(X)})(),removeTokenBindingKey:()=>y(function*(){throw b(X)})(),clearKeystore:()=>y(function*(){throw b(X)})(),signJwt:()=>y(function*(){throw b(X)})(),hashString:()=>y(function*(){throw b(X)})()},$O="@azure/msal-common",uE="15.12.0",ah="redirect_uri_empty",dE="claims_request_parsing_error",ch="authority_uri_insecure",ti="url_parse_error",lh="empty_url_error",uh="empty_input_scopes_error",tl="invalid_claims",dh="token_request_empty",fh="logout_request_empty",fE="invalid_code_challenge_method",nl="pkce_params_missing",rl="invalid_cloud_discovery_metadata",hh="invalid_authority_metadata",ph="untrusted_authority",Os="missing_ssh_jwk",gh="missing_ssh_kid",hE="missing_nonce_authentication_header",pE="invalid_authentication_header",mh="cannot_set_OIDCOptions",yh="cannot_allow_platform_broker",vh="authority_mismatch",Ch="invalid_request_method_for_EAR",Eh="invalid_authorize_post_body_parameters",Re={[ah]:"A redirect URI is required for all calls, and none has been set.",[dE]:"Could not parse the given claims request object.",[ch]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[ti]:"URL could not be parsed into appropriate segments.",[lh]:"URL was empty or null.",[uh]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[tl]:"Given claims parameter must be a stringified JSON object.",[dh]:"Token request was empty and not found in cache.",[fh]:"The logout request was null or undefined.",[fE]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[nl]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[rl]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[hh]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[ph]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Os]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[gh]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[hE]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[pE]:"Invalid authentication header provided",[mh]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[yh]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[vh]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[Eh]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[Ch]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST."};class gE extends me{constructor(e){super(e,Re[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,gE.prototype)}}function Ie(t){return new gE(t)}class Zt{static isEmptyObj(e){if(e)try{const n=JSON.parse(e);return 0===Object.keys(n).length}catch{}return!0}static startsWith(e,n){return 0===e.indexOf(n)}static endsWith(e,n){return e.length>=n.length&&e.lastIndexOf(n)===e.length-n.length}static queryStringToObject(e){const n={},r=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return r.forEach(i=>{if(i.trim()){const[s,a]=i.split(/=(.+)/g,2);s&&a&&(n[o(s)]=o(a))}}),n}static trimArrayEntries(e){return e.map(n=>n.trim())}static removeEmptyStringsFromArray(e){return e.filter(n=>!!n)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,n){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(n)}}class Xe{constructor(e){const n=e?Zt.trimArrayEntries([...e]):[],r=n?Zt.removeEmptyStringsFromArray(n):[];if(!r||!r.length)throw Ie(uh);this.scopes=new Set,r.forEach(o=>this.scopes.add(o))}static fromString(e){const r=(e||w.EMPTY_STRING).split(" ");return new Xe(r)}static createSearchScopes(e){const n=e&&e.length>0?e:[...Ms],r=new Xe(n);return r.containsOnlyOIDCScopes()?r.removeScope(w.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r}containsScope(e){const n=this.printScopesLowerCase().split(" "),r=new Xe(n);return!!e&&r.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(n=>this.containsScope(n))}containsOnlyOIDCScopes(){let e=0;return kO.forEach(n=>{this.containsScope(n)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(n=>this.appendScope(n))}catch{throw b(eh)}}removeScope(e){if(!e)throw b(Xf);this.scopes.delete(e.trim())}removeOIDCScopes(){kO.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw b(Qc);const n=new Set;return e.scopes.forEach(r=>n.add(r.toLowerCase())),this.scopes.forEach(r=>n.add(r.toLowerCase())),n}intersectingScopeSets(e){if(!e)throw b(Qc);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const n=this.unionScopeSets(e),r=e.getScopeCount(),o=this.getScopeCount();return n.size<o+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(n=>e.push(n)),e}printScopes(){return this.scopes?this.asArray().join(" "):w.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function zO(t,e){return!!t&&!!e&&t===e.split(".")[1]}function mE(t,e,n,r){if(r){const{oid:o,sub:i,tid:s,name:a,tfp:c,acr:l,preferred_username:u,upn:d,login_hint:f}=r,h=s||c||l||"";return{tenantId:h,localAccountId:o||i||"",name:a,username:u||d||"",loginHint:f,isHomeTenant:zO(h,t)}}return{tenantId:n,localAccountId:e,username:"",isHomeTenant:zO(n,t)}}function yE(t,e,n,r){let o=t;if(e){const{isHomeTenant:i,...s}=e;o={...t,...s}}if(n){const{isHomeTenant:i,...s}=mE(t.homeAccountId,t.localAccountId,t.tenantId,n);return o={...o,...s,idTokenClaims:n,idToken:r},o}return o}function Ps(t,e){const n=function f5(t){if(!t)throw b(zf);const n=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!n||n.length<4)throw b(qc);return n[2]}(t);try{const r=e(n);return JSON.parse(r)}catch{throw b(qc)}}function GO(t,e){if(0===e||Date.now()-3e5>t+e)throw b(Yf)}function qO(t){if(!t)return t;let e=t.toLowerCase();return Zt.endsWith(e,"?")?e=e.slice(0,-1):Zt.endsWith(e,"?/")&&(e=e.slice(0,-2)),Zt.endsWith(e,"/")||(e+="/"),e}function KO(t){return t.startsWith("#/")?t.substring(2):t.startsWith("#")||t.startsWith("?")?t.substring(1):t}function Ih(t){if(!t||t.indexOf("=")<0)return null;try{const e=KO(t),n=Object.fromEntries(new URLSearchParams(e));if(n.code||n.ear_jwe||n.error||n.error_description||n.state)return n}catch{throw b(Kf)}return null}function ol(t,e=!0,n){const r=new Array;return t.forEach((o,i)=>{r.push(!e&&n&&i in n?`${i}=${o}`:`${i}=${encodeURIComponent(o)}`)}),r.join("&")}function WO(t){if(!t)return t;const e=t.split("#")[0];try{const n=new URL(e);return qO(n.origin+n.pathname+n.search)}catch{return qO(e)}}class se{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Ie(lh);e.includes("#")||(this._urlString=se.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let n=e.toLowerCase();return Zt.endsWith(n,"?")?n=n.slice(0,-1):Zt.endsWith(n,"?/")&&(n=n.slice(0,-2)),Zt.endsWith(n,"/")||(n+="/"),n}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Ie(ti)}if(!e.HostNameAndPort||!e.PathSegments)throw Ie(ti);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Ie(ch)}static appendQueryString(e,n){return n?e.indexOf("?")<0?`${e}?${n}`:`${e}&${n}`:e}static removeHashFromUrl(e){return se.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const n=this.getUrlComponents(),r=n.PathSegments;return e&&0!==r.length&&("common"===r[0]||"organizations"===r[0])&&(r[0]=e),se.constructAuthorityUriFromObject(n)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=this.urlString.match(e);if(!n)throw Ie(ti);const r={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5],QueryString:n[7]};let o=r.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),r.PathSegments=o,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const n=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(n);if(!r)throw Ie(ti);return r[2]}static getAbsoluteUrl(e,n){if(e[0]===w.FORWARD_SLASH){const o=new se(n).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new se(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Ih(e)}}const YO={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},vE={metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},JO=new Set;function ZO(t,e,n,r){if(r?.trace(`getAliasesFromMetadata called with source: ${n}`),t&&e){const o=_h(e,t);if(o)return r?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${n}, returning aliases`),o.aliases;r?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${n}`)}return null}function _h(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(r.aliases.includes(e))return r}return null}vE.metadata.forEach(t=>{t.aliases.forEach(e=>{JO.add(e)})});const Th="cache_quota_exceeded",CE="cache_error_unknown",EE={[Th]:"Exceeded cache storage capacity.",[CE]:"Unexpected error occurred when using cache storage."};class xs extends me{constructor(e,n){const r=n||(EE[e]?EE[e]:EE[CE]);super(`${e}: ${r}`),Object.setPrototypeOf(this,xs.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}function IE(t){return t instanceof Error?"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name||t.message.includes("exceeded the quota")?new xs(Th):new xs(t.name,t.message):new xs(CE)}class _E{constructor(e,n,r,o,i){this.clientId=e,this.cryptoImpl=n,this.commonLogger=r.clone($O,uE),this.staticAuthorityOptions=i,this.performanceClient=o}getAllAccounts(e,n){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,n),n,e)}getAccountInfoFilteredBy(e,n){if(0===Object.keys(e).length||Object.values(e).every(o=>!o))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;const r=this.getAllAccounts(e,n);return r.length>1?r.sort(i=>i.idTokenClaims?-1:1)[0]:1===r.length?r[0]:null}getBaseAccountInfo(e,n){const r=this.getAccountsFilteredBy(e,n);return r.length>0?r[0].getAccountInfo():null}buildTenantProfiles(e,n,r){return e.flatMap(o=>this.getTenantProfilesFromAccountEntity(o,n,r?.tenantId,r))}getTenantedAccountInfoByFilter(e,n,r,o,i){let a,s=null;if(i&&!this.tenantProfileMatchesFilter(r,i))return null;const c=this.getIdToken(e,o,n,r.tenantId);return c&&(a=Ps(c.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(a,i))?null:(s=yE(e,r,a,c?.secret),s)}getTenantProfilesFromAccountEntity(e,n,r,o){const i=e.getAccountInfo();let s=i.tenantProfiles||new Map;const a=this.getTokenKeys();if(r){const l=s.get(r);if(!l)return[];s=new Map([[r,l]])}const c=[];return s.forEach(l=>{const u=this.getTenantedAccountInfoByFilter(i,a,l,n,o);u&&c.push(u)}),c}tenantProfileMatchesFilter(e,n){return!(n.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,n.localAccountId)||n.name&&e.name!==n.name||void 0!==n.isHomeTenant&&e.isHomeTenant!==n.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,n){return!(n&&(n.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,n.localAccountId)||n.loginHint&&!this.matchLoginHintFromTokenClaims(e,n.loginHint)||n.username&&!this.matchUsername(e.preferred_username,n.username)||n.name&&!this.matchName(e,n.name)||n.sid&&!this.matchSid(e,n.sid)))}saveCacheRecord(e,n,r){var o=this;return y(function*(){if(!e)throw b(th);try{e.account&&(yield o.setAccount(e.account,n)),e.idToken&&!1!==r?.idToken&&(yield o.setIdTokenCredential(e.idToken,n)),e.accessToken&&!1!==r?.accessToken&&(yield o.saveAccessToken(e.accessToken,n)),e.refreshToken&&!1!==r?.refreshToken&&(yield o.setRefreshTokenCredential(e.refreshToken,n)),e.appMetadata&&o.setAppMetadata(e.appMetadata,n)}catch(i){throw o.commonLogger?.error("CacheManager.saveCacheRecord: failed"),i instanceof me?i:IE(i)}})()}saveAccessToken(e,n){var r=this;return y(function*(){const o={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},i=r.getTokenKeys(),s=Xe.fromString(e.target);i.accessToken.forEach(a=>{if(!r.accessTokenKeyMatchesFilter(a,o,!1))return;const c=r.getAccessTokenCredential(a,n);c&&r.credentialMatchesFilter(c,o)&&Xe.fromString(c.target).intersectingScopeSets(s)&&r.removeAccessToken(a,n)}),yield r.setAccessTokenCredential(e,n)})()}getAccountsFilteredBy(e,n){const r=this.getAccountKeys(),o=[];return r.forEach(i=>{const s=this.getAccount(i,n);if(!s||e.homeAccountId&&!this.matchHomeAccountId(s,e.homeAccountId)||e.username&&!this.matchUsername(s.username,e.username)||e.environment&&!this.matchEnvironment(s,e.environment)||e.realm&&!this.matchRealm(s,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(s,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(s,e.authorityType))return;const a={localAccountId:e?.localAccountId,name:e?.name},c=s.tenantProfiles?.filter(l=>this.tenantProfileMatchesFilter(l,a));c&&0===c.length||o.push(s)}),o}credentialMatchesFilter(e,n){return!(n.clientId&&!this.matchClientId(e,n.clientId)||n.userAssertionHash&&!this.matchUserAssertionHash(e,n.userAssertionHash)||"string"==typeof n.homeAccountId&&!this.matchHomeAccountId(e,n.homeAccountId)||n.environment&&!this.matchEnvironment(e,n.environment)||n.realm&&!this.matchRealm(e,n.realm)||n.credentialType&&!this.matchCredentialType(e,n.credentialType)||n.familyId&&!this.matchFamilyId(e,n.familyId)||n.target&&!this.matchTarget(e,n.target)||(n.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==n.requestedClaimsHash||e.credentialType===ct.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(n.tokenType&&!this.matchTokenType(e,n.tokenType)||n.tokenType===de.SSH&&n.keyId&&!this.matchKeyId(e,n.keyId)))}getAppMetadataFilteredBy(e){const n=this.getKeys(),r={};return n.forEach(o=>{if(!this.isAppMetadata(o))return;const i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(r[o]=i))}),r}getAuthorityMetadataByAlias(e){const n=this.getAuthorityMetadataKeys();let r=null;return n.forEach(o=>{if(!this.isAuthorityMetadata(o)||-1===o.indexOf(this.clientId))return;const i=this.getAuthorityMetadata(o);i&&-1!==i.aliases.indexOf(e)&&(r=i)}),r}removeAllAccounts(e){this.getAllAccounts({},e).forEach(r=>{this.removeAccount(r,e)})}removeAccount(e,n){this.removeAccountContext(e,n),this.getAccountKeys().filter(i=>i.includes(e.homeAccountId)&&i.includes(e.environment)).forEach(i=>{this.removeItem(i,n),this.performanceClient.incrementFields({accountsRemoved:1},n)})}removeAccountContext(e,n){const r=this.getTokenKeys(),o=i=>i.includes(e.homeAccountId)&&i.includes(e.environment);r.idToken.filter(o).forEach(i=>{this.removeIdToken(i,n)}),r.accessToken.filter(o).forEach(i=>{this.removeAccessToken(i,n)}),r.refreshToken.filter(o).forEach(i=>{this.removeRefreshToken(i,n)})}removeAccessToken(e,n){const r=this.getAccessTokenCredential(e,n);if(this.removeItem(e,n),this.performanceClient.incrementFields({accessTokensRemoved:1},n),!r||r.credentialType.toLowerCase()!==ct.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||r.tokenType!==de.POP)return;const o=r.keyId;o&&this.cryptoImpl.removeTokenBindingKey(o).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${o}`,n),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},n)})}removeAppMetadata(e){return this.getKeys().forEach(r=>{this.isAppMetadata(r)&&this.removeItem(r,e)}),!0}getIdToken(e,n,r,o,i){this.commonLogger.trace("CacheManager - getIdToken called");const a=this.getIdTokensByFilter({homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ct.ID_TOKEN,clientId:this.clientId,realm:o},n,r),c=a.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){let l=a;if(!o){const u=new Map;a.forEach((f,h)=>{f.realm===e.tenantId&&u.set(h,f)});const d=u.size;if(d<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(1===d)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),u.values().next().value;l=u}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),l.forEach((u,d)=>{this.removeIdToken(d,n)}),i&&n&&i.addFields({multiMatchedID:a.size},n),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,n,r){const o=r&&r.idToken||this.getTokenKeys().idToken,i=new Map;return o.forEach(s=>{if(!this.idTokenKeyMatchesFilter(s,{clientId:this.clientId,...e}))return;const a=this.getIdTokenCredential(s,n);a&&this.credentialMatchesFilter(a,e)&&i.set(s,a)}),i}idTokenKeyMatchesFilter(e,n){const r=e.toLowerCase();return!(n.clientId&&-1===r.indexOf(n.clientId.toLowerCase())||n.homeAccountId&&-1===r.indexOf(n.homeAccountId.toLowerCase()))}removeIdToken(e,n){this.removeItem(e,n)}removeRefreshToken(e,n){this.removeItem(e,n)}getAccessToken(e,n,r,o){const i=n.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",i);const s=Xe.createSearchScopes(n.scopes),a=n.authenticationScheme||de.BEARER,c=a&&a.toLowerCase()!==de.BEARER.toLowerCase()?ct.ACCESS_TOKEN_WITH_AUTH_SCHEME:ct.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:o||e.tenantId,target:s,tokenType:a,keyId:n.sshKid,requestedClaimsHash:n.requestedClaimsHash},u=r&&r.accessToken||this.getTokenKeys().accessToken,d=[];u.forEach(h=>{if(this.accessTokenKeyMatchesFilter(h,l,!0)){const p=this.getAccessTokenCredential(h,i);p&&this.credentialMatchesFilter(p,l)&&d.push(p)}});const f=d.length;return f<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",i),null):f>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",i),d.forEach(h=>{this.removeAccessToken(this.generateCredentialKey(h),i)}),this.performanceClient.addFields({multiMatchedAT:d.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",i),d[0])}accessTokenKeyMatchesFilter(e,n,r){const o=e.toLowerCase();if(n.clientId&&-1===o.indexOf(n.clientId.toLowerCase())||n.homeAccountId&&-1===o.indexOf(n.homeAccountId.toLowerCase())||n.realm&&-1===o.indexOf(n.realm.toLowerCase())||n.requestedClaimsHash&&-1===o.indexOf(n.requestedClaimsHash.toLowerCase()))return!1;if(n.target){const i=n.target.asArray();for(let s=0;s<i.length;s++){if(r&&!o.includes(i[s].toLowerCase()))return!1;if(!r&&o.includes(i[s].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,n){const r=this.getTokenKeys(),o=[];return r.accessToken.forEach(i=>{if(!this.accessTokenKeyMatchesFilter(i,e,!0))return;const s=this.getAccessTokenCredential(i,n);s&&this.credentialMatchesFilter(s,e)&&o.push(s)}),o}getRefreshToken(e,n,r,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:ct.REFRESH_TOKEN,clientId:this.clientId,familyId:n?"1":void 0},c=o&&o.refreshToken||this.getTokenKeys().refreshToken,l=[];c.forEach(d=>{if(this.refreshTokenKeyMatchesFilter(d,a)){const f=this.getRefreshTokenCredential(d,r);f&&this.credentialMatchesFilter(f,a)&&l.push(f)}});const u=l.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&i&&r&&i.addFields({multiMatchedRT:u},r),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,n){const r=e.toLowerCase();return!(n.familyId&&-1===r.indexOf(n.familyId.toLowerCase())||!n.familyId&&n.clientId&&-1===r.indexOf(n.clientId.toLowerCase())||n.homeAccountId&&-1===r.indexOf(n.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){const r=this.getAppMetadataFilteredBy({environment:e,clientId:this.clientId}),o=Object.keys(r).map(s=>r[s]),i=o.length;if(i<1)return null;if(i>1)throw b(Jf);return o[0]}isAppMetadataFOCI(e){const n=this.readAppMetadataFromCache(e);return!(!n||"1"!==n.familyId)}matchHomeAccountId(e,n){return"string"==typeof e.homeAccountId&&n===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,n){return n===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,n){return e.localAccountId===n}matchName(e,n){return n.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,n){return!(!e||"string"!=typeof e||n?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,n){return!(!e.userAssertionHash||n!==e.userAssertionHash)}matchEnvironment(e,n){if(this.staticAuthorityOptions){const o=function h5(t,e){let n;const r=t.canonicalAuthority;if(r){const o=new se(r).getUrlComponents().HostNameAndPort;n=ZO(o,t.cloudDiscoveryMetadata?.metadata,"config",e)||ZO(o,vE.metadata,"hardcoded_values",e)||t.knownAuthorities}return n||[]}(this.staticAuthorityOptions,this.commonLogger);if(o.includes(n)&&o.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(n);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,n){return e.credentialType&&n.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,n){return!(!e.clientId||n!==e.clientId)}matchFamilyId(e,n){return!(!e.familyId||n!==e.familyId)}matchRealm(e,n){return e.realm?.toLowerCase()===n.toLowerCase()}matchNativeAccountId(e,n){return!(!e.nativeAccountId||n!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,n){return e.login_hint===n||e.preferred_username===n||e.upn===n}matchSid(e,n){return e.sid===n}matchAuthorityType(e,n){return!(!e.authorityType||n.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,n){return!(e.credentialType!==ct.ACCESS_TOKEN&&e.credentialType!==ct.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)&&Xe.fromString(e.target).containsScopeSet(n)}matchTokenType(e,n){return!(!e.tokenType||e.tokenType!==n)}matchKeyId(e,n){return!(!e.keyId||e.keyId!==n)}isAppMetadata(e){return-1!==e.indexOf($C)}isAuthorityMetadata(e){return-1!==e.indexOf("authority-metadata")}generateAuthorityMetadataCacheKey(e){return`authority-metadata-${this.clientId}-${e}`}static toObject(e,n){for(const r in n)e[r]=n[r];return e}}class g5 extends _E{setAccount(){return y(function*(){throw b(X)})()}getAccount(){throw b(X)}setIdTokenCredential(){return y(function*(){throw b(X)})()}getIdTokenCredential(){throw b(X)}setAccessTokenCredential(){return y(function*(){throw b(X)})()}getAccessTokenCredential(){throw b(X)}setRefreshTokenCredential(){return y(function*(){throw b(X)})()}getRefreshTokenCredential(){throw b(X)}setAppMetadata(){throw b(X)}getAppMetadata(){throw b(X)}setServerTelemetry(){throw b(X)}getServerTelemetry(){throw b(X)}setAuthorityMetadata(){throw b(X)}getAuthorityMetadata(){throw b(X)}getAuthorityMetadataKeys(){throw b(X)}setThrottlingCache(){throw b(X)}getThrottlingCache(){throw b(X)}removeItem(){throw b(X)}getKeys(){throw b(X)}getAccountKeys(){throw b(X)}getTokenKeys(){throw b(X)}generateCredentialKey(){throw b(X)}generateAccountKey(){throw b(X)}}class XO{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class eP{generateId(){return"callback-id"}startMeasurement(e,n){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:1,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:n||""},measurement:new XO}}startPerformanceMeasurement(){return new XO}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const tP={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},y5={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Ne.Info,correlationId:w.EMPTY_STRING},v5={claimsBasedCachingEnabled:!1},C5={sendGetRequestAsync:()=>y(function*(){throw b(X)})(),sendPostRequestAsync:()=>y(function*(){throw b(X)})()},E5={sku:w.SKU,version:uE,cpu:w.EMPTY_STRING,os:w.EMPTY_STRING},I5={clientSecret:w.EMPTY_STRING,clientAssertion:void 0},_5={azureCloudInstance:"none",tenant:`${w.DEFAULT_COMMON_TENANT}`},T5={application:{appName:"",appVersion:""}};function S5(t){return{clientCapabilities:[],azureCloudOptions:_5,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...t}}function nP(t){return"OIDC"===t.authOptions.authority.options.protocolMode}const D5={sendGetRequestAsync:()=>Promise.reject(b(X)),sendPostRequestAsync:()=>Promise.reject(b(X))},il="pkce_not_created",TE="ear_jwk_empty",rP="ear_jwe_empty",sl="crypto_nonexistent",Fs="empty_navigate_uri",wh="hash_empty_error",al="no_state_in_hash",Sh="hash_does_not_contain_known_properties",Dh="unable_to_parse_state",Ah="state_interaction_type_mismatch",bh="interaction_in_progress",Rh="popup_window_error",Mh="empty_window_error",ni="user_cancelled",wE="monitor_popup_timeout",Nh="monitor_window_timeout",kh="redirect_in_iframe",Oh="block_iframe_reload",Ph="block_nested_popups",SE="iframe_closed_prematurely",Ls="silent_logout_unsupported",xh="no_account_error",DE="silent_prompt_value_error",Fh="no_token_request_cache_error",Lh="unable_to_parse_token_request_cache_error",AE="auth_request_not_set_error",bE="invalid_cache_type",Us="non_browser_environment",ro="database_not_open",Hs="no_network_connectivity",Uh="post_request_failed",Hh="get_request_failed",cl="failed_to_parse_response",Bh="unable_to_load_token",ll="crypto_key_not_found",jh="auth_code_required",Vh="auth_code_or_nativeAccountId_required",$h="spa_code_and_nativeAccountId_present",ul="database_unavailable",zh="unable_to_acquire_token_from_native_platform",Gh="native_handshake_timeout",qh="native_extension_not_installed",dl="native_connection_not_established",ri="uninitialized_public_client_application",Kh="native_prompt_not_supported",Wh="invalid_base64_string",Qh="invalid_pop_token_request",oP="failed_to_build_headers",iP="failed_to_parse_headers",Yh="failed_to_decrypt_ear_response",Jh="timed_out",yr="For more visit: aka.ms/msaljs/browser-errors",G={[il]:"The PKCE code challenge and verifier could not be generated.",[TE]:"No EAR encryption key provided. This is unexpected.",[rP]:"Server response does not contain ear_jwe property. This is unexpected.",[sl]:"The crypto object or function is not available.",[Fs]:"Navigation URI is empty. Please check stack trace for more info.",[wh]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${yr}`,[al]:"Hash does not contain state. Please verify that the request originated from msal.",[Sh]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${yr}`,[Dh]:"Unable to parse state. Please verify that the request originated from msal.",[Ah]:"Hash contains state but the interaction type does not match the caller.",[bh]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${yr}`,[Rh]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Mh]:"window.open returned null or undefined window object.",[ni]:"User cancelled the flow.",[wE]:`Token acquisition in popup failed due to timeout.  ${yr}`,[Nh]:`Token acquisition in iframe failed due to timeout.  ${yr}`,[kh]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Oh]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${yr}`,[Ph]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[SE]:"The iframe being monitored was closed prematurely.",[Ls]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[xh]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[DE]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Fh]:"No token request found in cache.",[Lh]:"The cached token request could not be parsed.",[AE]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[bE]:"Invalid cache type",[Us]:"Login and token requests are not supported in non-browser environments.",[ro]:"Database is not open!",[Hs]:"No network connectivity. Check your internet connection.",[Uh]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Hh]:"Network request failed. Please check the network trace to determine root cause.",[cl]:"Failed to parse network response. Check network trace.",[Bh]:"Error loading token to cache.",[ll]:"Cryptographic Key or Keypair not found in browser storage.",[jh]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Vh]:"An authorization code or nativeAccountId must be provided to this flow.",[$h]:"Request cannot contain both spa code and native account id.",[ul]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[zh]:`Unable to acquire token from native platform.  ${yr}`,[Gh]:"Timed out while attempting to establish connection to browser extension",[qh]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[dl]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${yr}`,[ri]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${yr}`,[Kh]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Wh]:"Invalid base64 encoded string.",[Qh]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[oP]:"Failed to build request headers object.",[iP]:"Failed to parse response headers",[Yh]:"Failed to decrypt ear response",[Jh]:"The request timed out."};class fl extends me{constructor(e,n){super(e,G[e],n),Object.setPrototypeOf(this,fl.prototype),this.name="BrowserAuthError"}}function M(t,e){return new fl(t,e)}class Zh{navigateInternal(e,n){return Zh.defaultNavigateWindow(e,n)}navigateExternal(e,n){return Zh.defaultNavigateWindow(e,n)}static defaultNavigateWindow(e,n){return n.noHistory?window.location.replace(e):window.location.assign(e),new Promise((r,o)=>{setTimeout(()=>{o(M(Jh,"failed_to_redirect"))},n.timeout)})}}class Xh extends me{constructor(e,n,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Xh.prototype),this.name="NetworkError",this.error=e,this.httpStatus=n,this.responseHeaders=r}}function hl(t,e,n,r){return t.errorMessage=`${t.errorMessage}, additionalErrorInfo: error.name:${r?.name}, error.message:${r?.message}`,new Xh(t,e,n)}class A5{sendGetRequestAsync(e,n){return y(function*(){let r,o={},i=0;const s=sP(n);try{r=yield fetch(e,{method:"GET",headers:s})}catch(a){throw hl(M(window.navigator.onLine?Hh:Hs),void 0,void 0,a)}o=aP(r.headers);try{return i=r.status,{headers:o,body:yield r.json(),status:i}}catch(a){throw hl(M(cl),i,o,a)}})()}sendPostRequestAsync(e,n){return y(function*(){const r=n&&n.body||"",o=sP(n);let i,s=0,a={};try{i=yield fetch(e,{method:"POST",headers:o,body:r})}catch(c){throw hl(M(window.navigator.onLine?Uh:Hs),void 0,void 0,c)}a=aP(i.headers);try{return s=i.status,{headers:a,body:yield i.json(),status:s}}catch(c){throw hl(M(cl),s,a,c)}})()}}function sP(t){try{const e=new Headers;return t&&t.headers?(Object.entries(t.headers).forEach(([r,o])=>{e.append(r,o)}),e):e}catch(e){throw hl(M(oP),void 0,void 0,e)}}function aP(t){try{const e={};return t.forEach((n,r)=>{e[r]=n}),e}catch{throw M(iP)}}const oi="client_id",cP="redirect_uri",lP="token_type",uP="req_cnf",dP="return_spa_code",aQ="x-client-xtra-sku",ep="brk_client_id",tp="brk_redirect_uri",RE="instance_aware";function np(t,e,n){if(!e)return;const r=t.get(oi);r&&t.has(ep)&&n?.addFields({embeddedClientId:r,embeddedRedirectUri:t.get(cP)},e)}function ME(t,e){t.set("response_type",e)}function NE(t,e,n=!0,r=Ms){n&&!r.includes("openid")&&!e.includes("openid")&&r.push("openid");const o=n?[...e||[],...r]:e||[],i=new Xe(o);t.set("scope",i.printScopes())}function kE(t,e){t.set(oi,e)}function OE(t,e){t.set(cP,e)}function rp(t,e){t.set("login_hint",e)}function op(t,e){t.set("X-AnchorMailbox",`UPN:${e}`)}function pl(t,e){t.set("X-AnchorMailbox",`Oid:${e.uid}@${e.utid}`)}function fP(t,e){t.set("sid",e)}function PE(t,e,n){const r=function EP(t,e){let n;if(t)try{n=JSON.parse(t)}catch{throw Ie(tl)}else n={};return e&&e.length>0&&(n.hasOwnProperty("access_token")||(n.access_token={}),n.access_token.xms_cc={values:e}),JSON.stringify(n)}(e,n);try{JSON.parse(r)}catch{throw Ie(tl)}t.set("claims",r)}function xE(t,e){t.set("client-request-id",e)}function FE(t,e){t.set("x-client-SKU",e.sku),t.set("x-client-VER",e.version),e.os&&t.set("x-client-OS",e.os),e.cpu&&t.set("x-client-CPU",e.cpu)}function LE(t,e){e?.appName&&t.set("x-app-name",e.appName),e?.appVersion&&t.set("x-app-ver",e.appVersion)}function hP(t,e){e&&t.set("state",e)}function pP(t,e,n){if(!e||!n)throw Ie(nl);t.set("code_challenge",e),t.set("code_challenge_method",n)}function gP(t,e){t.set("client_secret",e)}function mP(t,e){e&&t.set("client_assertion",e)}function yP(t,e){e&&t.set("client_assertion_type",e)}function vP(t,e){t.set("grant_type",e)}function UE(t){t.set("client_info","1")}function CP(t){t.has(RE)||t.set(RE,"true")}function oo(t,e){Object.entries(e).forEach(([n,r])=>{!t.has(n)&&r&&t.set(n,r)})}function HE(t,e){e&&(t.set(lP,de.POP),t.set(uP,e))}function IP(t,e){e&&(t.set(lP,de.SSH),t.set(uP,e))}function _P(t,e){t.set("x-client-current-telemetry",e.generateCurrentRequestHeaderValue()),t.set("x-client-last-telemetry",e.generateLastRequestHeaderValue())}function TP(t){t.set("x-ms-lib-capability","retry-after, h429")}function ip(t,e,n){t.has(ep)||t.set(ep,e),t.has(tp)||t.set(tp,n)}function sp(t){return encodeURIComponent(gl(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function io(t){return wP(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function gl(t){return wP((new TextEncoder).encode(t))}function wP(t){const e=Array.from(t,n=>String.fromCodePoint(n)).join("");return btoa(e)}function An(t){return(new TextDecoder).decode(so(t))}function so(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw M(Wh)}const n=atob(e);return Uint8Array.from(n,r=>r.codePointAt(0)||0)}const Bs="AES-GCM",BE="SHA-256",SQ=new Uint8Array([1,0,1]),DP="0123456789abcdef",AP=new Uint32Array(1),bP="encrypt",VE="decrypt",$E={name:"RSASSA-PKCS1-v1_5",hash:BE,modulusLength:2048,publicExponent:SQ};function RP(t,e,n){return zE.apply(this,arguments)}function zE(){return(zE=y(function*(t,e,n){e?.addQueueMeasurement("sha256Digest",n);const o=(new TextEncoder).encode(t);return window.crypto.subtle.digest(BE,o)})).apply(this,arguments)}function RQ(t){return window.crypto.getRandomValues(t)}function GE(){return window.crypto.getRandomValues(AP),AP[0]}function bn(){const t=Date.now(),e=1024*GE()+(1023&GE()),n=new Uint8Array(16),r=Math.trunc(e/2**30),o=e&2**30-1,i=GE();n[0]=t/2**40,n[1]=t/2**32,n[2]=t/2**24,n[3]=t/65536,n[4]=t/256,n[5]=t,n[6]=112|r>>>8,n[7]=r,n[8]=128|o>>>24,n[9]=o>>>16,n[10]=o>>>8,n[11]=o,n[12]=i>>>24,n[13]=i>>>16,n[14]=i>>>8,n[15]=i;let s="";for(let a=0;a<n.length;a++)s+=DP.charAt(n[a]>>>4),s+=DP.charAt(15&n[a]),(3===a||5===a||7===a||9===a)&&(s+="-");return s}function qE(){return(qE=y(function*(t,e){return window.crypto.subtle.generateKey($E,t,e)})).apply(this,arguments)}function KE(t){return WE.apply(this,arguments)}function WE(){return(WE=y(function*(t){return window.crypto.subtle.exportKey("jwk",t)})).apply(this,arguments)}function QE(){return(QE=y(function*(t,e,n){return window.crypto.subtle.importKey("jwk",t,$E,e,n)})).apply(this,arguments)}function YE(){return(YE=y(function*(t,e){return window.crypto.subtle.sign($E,t,e)})).apply(this,arguments)}function JE(){return ZE.apply(this,arguments)}function ZE(){return(ZE=y(function*(){const t=yield MP(),n={alg:"dir",kty:"oct",k:io(new Uint8Array(t))};return gl(JSON.stringify(n))})).apply(this,arguments)}function XE(){return(XE=y(function*(t){const e=An(t),o=so(JSON.parse(e).k);return window.crypto.subtle.importKey("raw",o,Bs,!1,[VE])})).apply(this,arguments)}function PQ(t,e){return eI.apply(this,arguments)}function eI(){return eI=y(function*(t,e){const n=e.split(".");if(5!==n.length)throw M(Yh,"jwe_length");const r=yield function OQ(t){return XE.apply(this,arguments)}(t).catch(()=>{throw M(Yh,"import_key")});try{const o=(new TextEncoder).encode(n[0]),i=so(n[2]),s=so(n[3]),a=so(n[4]),c=8*a.byteLength,l=new Uint8Array(s.length+a.length);l.set(s),l.set(a,s.length);const u=yield window.crypto.subtle.decrypt({name:Bs,iv:i,tagLength:c,additionalData:o},r,l);return(new TextDecoder).decode(u)}catch{throw M(Yh,"decrypt")}}),eI.apply(this,arguments)}function MP(){return tI.apply(this,arguments)}function tI(){return(tI=y(function*(){const t=yield window.crypto.subtle.generateKey({name:Bs,length:256},!0,[bP,VE]);return window.crypto.subtle.exportKey("raw",t)})).apply(this,arguments)}function NP(t){return nI.apply(this,arguments)}function nI(){return(nI=y(function*(t){return window.crypto.subtle.importKey("raw",t,"HKDF",!1,["deriveKey"])})).apply(this,arguments)}function kP(t,e,n){return rI.apply(this,arguments)}function rI(){return(rI=y(function*(t,e,n){return window.crypto.subtle.deriveKey({name:"HKDF",salt:e,hash:BE,info:(new TextEncoder).encode(n)},t,{name:Bs,length:256},!1,[bP,VE])})).apply(this,arguments)}function xQ(t,e,n){return oI.apply(this,arguments)}function oI(){return(oI=y(function*(t,e,n){const r=(new TextEncoder).encode(e),o=window.crypto.getRandomValues(new Uint8Array(16)),i=yield kP(t,o,n),s=yield window.crypto.subtle.encrypt({name:Bs,iv:new Uint8Array(12)},i,r);return{data:io(new Uint8Array(s)),nonce:io(o)}})).apply(this,arguments)}function OP(t,e,n,r){return iI.apply(this,arguments)}function iI(){return(iI=y(function*(t,e,n,r){const o=so(r),i=yield kP(t,so(e),n),s=yield window.crypto.subtle.decrypt({name:Bs,iv:new Uint8Array(12)},i,o);return(new TextDecoder).decode(s)})).apply(this,arguments)}function PP(t){return sI.apply(this,arguments)}function sI(){return(sI=y(function*(t){const e=yield RP(t);return io(new Uint8Array(e))})).apply(this,arguments)}const ml="storage_not_supported",aI="stubbed_public_client_application_called",ap="in_mem_redirect_unavailable",cp={[ml]:"Given storage configuration option was not supported.",[aI]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[ap]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class cI extends me{constructor(e,n){super(e,n),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,cI.prototype)}}function lI(t){return new cI(t,cp[t])}function xP(t){t.location.hash="","function"==typeof t.history.replaceState&&t.history.replaceState(null,"",`${t.location.origin}${t.location.pathname}${t.location.search}`)}function uI(){return window.parent!==window}function vr(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function FP(){if(typeof window>"u")throw M(Us)}function LP(t){if(!t)throw M(ri)}function dI(t){FP(),function HQ(){if(se.hashContainsKnownProperties(window.location.hash)&&uI())throw M(Oh)}(),function jQ(){if(function LQ(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf("msal.")}())throw M(Ph)}(),LP(t)}function UP(t,e){if(dI(t),function BQ(t){if(uI()&&!t)throw M(kh)}(e.system.allowRedirectInIframe),"memoryStorage"===e.cache.cacheLocation&&!e.cache.storeAuthStateInCookie)throw lI(ap)}function HP(t){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(t).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}const ii="4.22.1",ot="msal",hI="browser",KQ=`${ot}.${hI}.log.level`,WQ=`${ot}.${hI}.log.pii`,QQ=`${ot}.${hI}.platform.auth.dom`,jP=`${ot}.version`,VP="account.keys",$P="token.keys";function Yn(t=1){return t<1?`${ot}.${VP}`:`${ot}.${t}.${VP}`}function si(t,e=1){return e<1?`${ot}.${$P}.${t}`:`${ot}.${e}.${$P}.${t}`}class mI{static loggerCallback(e,n){switch(e){case Ne.Error:return void console.error(n);case Ne.Info:return void console.info(n);case Ne.Verbose:return void console.debug(n);case Ne.Warning:return void console.warn(n);default:return void console.log(n)}}constructor(e){let n;this.browserEnvironment=typeof window<"u",this.config=function GQ({auth:t,cache:e,system:n,telemetry:r},o){const i={clientId:w.EMPTY_STRING,authority:`${w.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:w.EMPTY_STRING,authorityMetadata:w.EMPTY_STRING,redirectUri:typeof window<"u"?vr():"",postLogoutRedirectUri:w.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:"AAD",OIDCOptions:{serverResponseType:"fragment",defaultScopes:[w.OPENID_SCOPE,w.PROFILE_SCOPE,w.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:"none",tenant:w.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},s={cacheLocation:"sessionStorage",cacheRetentionDays:5,temporaryCacheLocation:"sessionStorage",storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!e||"localStorage"!==e.cacheLocation),claimsBasedCachingEnabled:!1},a={loggerCallback:()=>{},logLevel:Ne.Info,piiLoggingEnabled:!1},l={...{...tP,loggerOptions:a,networkClient:o?new A5:D5,navigationClient:new Zh,loadFrameTimeout:0,windowHashTimeout:n?.loadFrameTimeout||6e4,iframeHashTimeout:n?.loadFrameTimeout||1e4,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:n?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:30},...n,loggerOptions:n?.loggerOptions||a},u={application:{appName:w.EMPTY_STRING,appVersion:w.EMPTY_STRING},client:new eP};if("OIDC"!==t?.protocolMode&&t?.OIDCOptions&&new to(l.loggerOptions).warning(JSON.stringify(Ie(mh))),t?.protocolMode&&"OIDC"===t.protocolMode&&l?.allowPlatformBroker)throw Ie(yh);return{auth:{...i,...t,OIDCOptions:{...i.OIDCOptions,...t?.OIDCOptions}},cache:{...s,...e},system:l,telemetry:{...u,...r}}}(e,this.browserEnvironment);try{n=window.sessionStorage}catch{}const r=n?.getItem(KQ),o=n?.getItem(WQ)?.toLowerCase(),i="true"===o||"false"!==o&&void 0,s={...this.config.system.loggerOptions},a=r&&Object.keys(Ne).includes(r)?Ne[r]:void 0;a&&(s.loggerCallback=mI.loggerCallback,s.logLevel=a),void 0!==i&&(s.piiLoggingEnabled=i),this.logger=new to(s,"@azure/msal-browser",ii),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}let zP=(()=>{class t extends mI{getModuleName(){return t.MODULE_NAME}getId(){return t.ID}initialize(){var n=this;return y(function*(){return n.available=typeof window<"u",n.available})()}}return t.MODULE_NAME="",t.ID="StandardOperatingContext",t})();const GP="missing_kid_error",qP="missing_alg_error",YQ={[GP]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[qP]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class yI extends me{constructor(e,n){super(e,n),this.name="JoseHeaderError",Object.setPrototypeOf(this,yI.prototype)}}function KP(t){return new yI(t,YQ[t])}class vI{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw KP(GP);if(!e.alg)throw KP(qP);const n=new vI({typ:e.typ||"pop",kid:e.kid,alg:e.alg});return JSON.stringify(n)}}class JQ{constructor(){this.dbName=GC,this.version=1,this.tableName=o5,this.dbOpen=!1}open(){var e=this;return y(function*(){return new Promise((n,r)=>{const o=window.indexedDB.open(e.dbName,e.version);o.addEventListener("upgradeneeded",i=>{i.target.result.createObjectStore(e.tableName)}),o.addEventListener("success",i=>{e.db=i.target.result,e.dbOpen=!0,n()}),o.addEventListener("error",()=>r(M(ul)))})})()}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}validateDbIsOpen(){var e=this;return y(function*(){if(!e.dbOpen)return e.open()})()}getItem(e){var n=this;return y(function*(){return yield n.validateDbIsOpen(),new Promise((r,o)=>{if(!n.db)return o(M(ro));const a=n.db.transaction([n.tableName],"readonly").objectStore(n.tableName).get(e);a.addEventListener("success",c=>{const l=c;n.closeConnection(),r(l.target.result)}),a.addEventListener("error",c=>{n.closeConnection(),o(c)})})})()}setItem(e,n){var r=this;return y(function*(){return yield r.validateDbIsOpen(),new Promise((o,i)=>{if(!r.db)return i(M(ro));const c=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(n,e);c.addEventListener("success",()=>{r.closeConnection(),o()}),c.addEventListener("error",l=>{r.closeConnection(),i(l)})})})()}removeItem(e){var n=this;return y(function*(){return yield n.validateDbIsOpen(),new Promise((r,o)=>{if(!n.db)return o(M(ro));const a=n.db.transaction([n.tableName],"readwrite").objectStore(n.tableName).delete(e);a.addEventListener("success",()=>{n.closeConnection(),r()}),a.addEventListener("error",c=>{n.closeConnection(),o(c)})})})()}getKeys(){var e=this;return y(function*(){return yield e.validateDbIsOpen(),new Promise((n,r)=>{if(!e.db)return r(M(ro));const s=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();s.addEventListener("success",a=>{const c=a;e.closeConnection(),n(c.target.result)}),s.addEventListener("error",a=>{e.closeConnection(),r(a)})})})()}containsKey(e){var n=this;return y(function*(){return yield n.validateDbIsOpen(),new Promise((r,o)=>{if(!n.db)return o(M(ro));const a=n.db.transaction([n.tableName],"readonly").objectStore(n.tableName).count(e);a.addEventListener("success",c=>{const l=c;n.closeConnection(),r(1===l.target.result)}),a.addEventListener("error",c=>{n.closeConnection(),o(c)})})})()}deleteDatabase(){var e=this;return y(function*(){return e.db&&e.dbOpen&&e.closeConnection(),new Promise((n,r)=>{const o=window.indexedDB.deleteDatabase(GC),i=setTimeout(()=>r(!1),200);o.addEventListener("success",()=>(clearTimeout(i),n(!0))),o.addEventListener("blocked",()=>(clearTimeout(i),n(!0))),o.addEventListener("error",()=>(clearTimeout(i),r(!1)))})})()}}class lp{constructor(){this.cache=new Map}initialize(){return y(function*(){})()}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,n){this.cache.set(e,n)}setUserData(e,n){var r=this;return y(function*(){r.setItem(e,n)})()}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((n,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}decryptData(){return Promise.resolve(null)}}class ZQ{constructor(e){this.inMemoryCache=new lp,this.indexedDBCache=new JQ,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof fl&&e.errorCode===ul))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}getItem(e){var n=this;return y(function*(){const r=n.inMemoryCache.getItem(e);if(!r)try{return n.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),yield n.indexedDBCache.getItem(e)}catch(o){n.handleDatabaseAccessError(o)}return r})()}setItem(e,n){var r=this;return y(function*(){r.inMemoryCache.setItem(e,n);try{yield r.indexedDBCache.setItem(e,n)}catch(o){r.handleDatabaseAccessError(o)}})()}removeItem(e){var n=this;return y(function*(){n.inMemoryCache.removeItem(e);try{yield n.indexedDBCache.removeItem(e)}catch(r){n.handleDatabaseAccessError(r)}})()}getKeys(){var e=this;return y(function*(){const n=e.inMemoryCache.getKeys();if(0===n.length)try{return e.logger.verbose("In-memory cache is empty, now querying persistent storage."),yield e.indexedDBCache.getKeys()}catch(r){e.handleDatabaseAccessError(r)}return n})()}containsKey(e){var n=this;return y(function*(){const r=n.inMemoryCache.containsKey(e);if(!r)try{return n.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),yield n.indexedDBCache.containsKey(e)}catch(o){n.handleDatabaseAccessError(o)}return r})()}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}clearPersistent(){var e=this;return y(function*(){try{e.logger.verbose("Deleting persistent keystore");const n=yield e.indexedDBCache.deleteDatabase();return n&&e.logger.verbose("Persistent keystore deleted"),n}catch(n){return e.handleDatabaseAccessError(n),!1}})()}}let up=(()=>{class t{constructor(n,r,o){this.logger=n,function bQ(t){if(!window)throw M(Us);if(!window.crypto)throw M(sl);if(!t&&!window.crypto.subtle)throw M(sl,"crypto_subtle_undefined")}(o??!1),this.cache=new ZQ(this.logger),this.performanceClient=r}createNewGuid(){return bn()}base64Encode(n){return gl(n)}base64Decode(n){return An(n)}base64UrlEncode(n){return sp(n)}encodeKid(n){return this.base64UrlEncode(JSON.stringify({kid:n}))}getPublicKeyThumbprint(n){var r=this;return y(function*(){const o=r.performanceClient?.startMeasurement("cryptoOptsGetPublicKeyThumbprint",n.correlationId),i=yield function MQ(t,e){return qE.apply(this,arguments)}(t.EXTRACTABLE,t.POP_KEY_USAGES),s=yield KE(i.publicKey),c=WP({e:s.e,kty:s.kty,n:s.n}),l=yield r.hashString(c),u=yield KE(i.privateKey),d=yield function NQ(t,e,n){return QE.apply(this,arguments)}(u,!1,["sign"]);return yield r.cache.setItem(l,{privateKey:d,publicKey:i.publicKey,requestMethod:n.resourceRequestMethod,requestUri:n.resourceRequestUri}),o&&o.end({success:!0}),l})()}removeTokenBindingKey(n){var r=this;return y(function*(){if(yield r.cache.removeItem(n),yield r.cache.containsKey(n))throw b(oh)})()}clearKeystore(){var n=this;return y(function*(){n.cache.clearInMemory();try{return yield n.cache.clearPersistent(),!0}catch(r){return r instanceof Error?n.logger.error(`Clearing keystore failed with error: ${r.message}`):n.logger.error("Clearing keystore failed with unknown error"),!1}})()}signJwt(n,r,o,i){var s=this;return y(function*(){const a=s.performanceClient?.startMeasurement("cryptoOptsSignJwt",i),c=yield s.cache.getItem(r);if(!c)throw M(ll);const l=yield KE(c.publicKey),u=WP(l),d=sp(JSON.stringify({kid:r})),h=sp(vI.getShrHeaderString({...o?.header,alg:l.alg,kid:d}));n.cnf={jwk:JSON.parse(u)};const m=`${h}.${sp(JSON.stringify(n))}`,E=(new TextEncoder).encode(m),C=yield function kQ(t,e){return YE.apply(this,arguments)}(c.privateKey,E),P=`${m}.${io(new Uint8Array(C))}`;return a&&a.end({success:!0}),P})()}hashString(n){return y(function*(){return PP(n)})()}}return t.POP_KEY_USAGES=["sign","verify"],t.EXTRACTABLE=!0,t})();function WP(t){return JSON.stringify(t,Object.keys(t).sort())}const Xt=(t,e,n,r,o)=>(...i)=>{n.trace(`Executing function ${e}`);const s=r?.startMeasurement(e,o);if(o){const a=e+"CallCount";r?.incrementFields({[a]:1},o)}try{const a=t(...i);return s?.end({success:!0}),n.trace(`Returning result from ${e}`),a}catch(a){n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(a))}catch{n.trace("Unable to print error message.")}throw s?.end({success:!1},a),a}},T=(t,e,n,r,o)=>(...i)=>{n.trace(`Executing function ${e}`);const s=r?.startMeasurement(e,o);if(o){const a=e+"CallCount";r?.incrementFields({[a]:1},o)}return r?.setPreQueueTime(e,o),t(...i).then(a=>(n.trace(`Returning result from ${e}`),s?.end({success:!0}),a)).catch(a=>{n.trace(`Error occurred in ${e}`);try{n.trace(JSON.stringify(a))}catch{n.trace("Unable to print error message.")}throw s?.end({success:!1},a),a})};let nY=(()=>{class t{constructor(n,r,o,i){this.networkInterface=n,this.logger=r,this.performanceClient=o,this.correlationId=i}detectRegion(n,r){var o=this;return y(function*(){o.performanceClient?.addQueueMeasurement("regionDiscoveryDetectRegion",o.correlationId);let i=n;if(i)r.region_source="3";else{const s=t.IMDS_OPTIONS;try{const a=yield T(o.getRegionFromIMDS.bind(o),"regionDiscoveryGetRegionFromIMDS",o.logger,o.performanceClient,o.correlationId)(w.IMDS_VERSION,s);if(200===a.status&&(i=a.body,r.region_source="4"),400===a.status){const c=yield T(o.getCurrentVersion.bind(o),"regionDiscoveryGetCurrentVersion",o.logger,o.performanceClient,o.correlationId)(s);if(!c)return r.region_source="1",null;const l=yield T(o.getRegionFromIMDS.bind(o),"regionDiscoveryGetRegionFromIMDS",o.logger,o.performanceClient,o.correlationId)(c,s);200===l.status&&(i=l.body,r.region_source="4")}}catch{return r.region_source="1",null}}return i||(r.region_source="1"),i||null})()}getRegionFromIMDS(n,r){var o=this;return y(function*(){return o.performanceClient?.addQueueMeasurement("regionDiscoveryGetRegionFromIMDS",o.correlationId),o.networkInterface.sendGetRequestAsync(`${w.IMDS_ENDPOINT}?api-version=${n}&format=text`,r,w.IMDS_TIMEOUT)})()}getCurrentVersion(n){var r=this;return y(function*(){r.performanceClient?.addQueueMeasurement("regionDiscoveryGetCurrentVersion",r.correlationId);try{const o=yield r.networkInterface.sendGetRequestAsync(`${w.IMDS_ENDPOINT}?format=json`,n);return 400===o.status&&o.body&&o.body["newest-versions"]&&o.body["newest-versions"].length>0?o.body["newest-versions"][0]:null}catch{return null}})()}}return t.IMDS_OPTIONS={headers:{Metadata:"true"}},t})();function $t(){return Math.round((new Date).getTime()/1e3)}function QP(t){return t.getTime()/1e3}function js(t){return t?new Date(1e3*Number(t)):new Date}function dp(t,e){const n=Number(t)||0;return $t()+e>n}function rY(t,e){const n=Number(t)+24*e*60*60*1e3;return Date.now()>n}function fp(t,e,n,r,o){return{credentialType:ct.ID_TOKEN,homeAccountId:t,environment:e,clientId:r,secret:n,realm:o,lastUpdatedAt:Date.now().toString()}}function hp(t,e,n,r,o,i,s,a,c,l,u,d,f,h,p){const m={homeAccountId:t,credentialType:ct.ACCESS_TOKEN,secret:n,cachedAt:$t().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:r,realm:o,target:i,tokenType:u||de.BEARER,lastUpdatedAt:Date.now().toString()};if(d&&(m.userAssertionHash=d),l&&(m.refreshOn=l.toString()),h&&(m.requestedClaims=h,m.requestedClaimsHash=p),m.tokenType?.toLowerCase()!==de.BEARER.toLowerCase())switch(m.credentialType=ct.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case de.POP:const v=Ps(n,c);if(!v?.cnf?.kid)throw b(nh);m.keyId=v.cnf.kid;break;case de.SSH:m.keyId=f}return m}function YP(t,e,n,r,o,i,s){const a={credentialType:ct.REFRESH_TOKEN,homeAccountId:t,environment:e,clientId:r,secret:n,lastUpdatedAt:Date.now().toString()};return i&&(a.userAssertionHash=i),o&&(a.familyId=o),s&&(a.expiresOn=s.toString()),a}function CI(t){return t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")}function JP(t){return!!t&&CI(t)&&t.hasOwnProperty("realm")&&t.hasOwnProperty("target")&&(t.credentialType===ct.ACCESS_TOKEN||t.credentialType===ct.ACCESS_TOKEN_WITH_AUTH_SCHEME)}function ZP(t){return!!t&&CI(t)&&t.credentialType===ct.REFRESH_TOKEN}function XP(){return $t()+86400}function pp(t,e,n){t.authorization_endpoint=e.authorization_endpoint,t.token_endpoint=e.token_endpoint,t.end_session_endpoint=e.end_session_endpoint,t.issuer=e.issuer,t.endpointsFromNetwork=n,t.jwks_uri=e.jwks_uri}function EI(t,e,n){t.aliases=e.aliases,t.preferred_cache=e.preferred_cache,t.preferred_network=e.preferred_network,t.aliasesFromNetwork=n}function e0(t){return t.expiresAt<=$t()}class pt{constructor(e,n,r,o,i,s,a,c){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=n,this.cacheManager=r,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=a,this.correlationId=s,this.managedIdentity=c||!1,this.regionDiscovery=new nY(n,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(w.CIAM_AUTH_URL))return 3;const n=e.PathSegments;if(n.length)switch(n[0].toLowerCase()){case w.ADFS:return 1;case w.DSTS:return 2}return 0}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new se(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw b(Dn)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw b(Dn)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw b(Dn)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw b(ih);return this.replacePath(this.metadata.end_session_endpoint)}throw b(Dn)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw b(Dn)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw b(Dn)}canReplaceTenant(e){return 1===e.PathSegments.length&&!pt.reservedTenantDomains.has(e.PathSegments[0])&&0===this.getAuthorityType(e)&&"OIDC"!==this.protocolMode}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let n=e;const o=new se(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,c)=>{let l=i[c];if(0===c&&this.canReplaceTenant(o)){const u=new se(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];l!==u&&(this.logger.verbose(`Replacing tenant domain name ${l} with id ${u}`),l=u)}a!==l&&(n=n.replace(`/${l}/`,`/${a}/`))}),this.replaceTenant(n)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||1===this.authorityType||"OIDC"===this.protocolMode&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}resolveEndpointsAsync(){var e=this;return y(function*(){e.performanceClient?.addQueueMeasurement("authorityResolveEndpointsAsync",e.correlationId);const n=e.getCurrentMetadataEntity(),r=yield T(e.updateCloudDiscoveryMetadata.bind(e),"authorityUpdateCloudDiscoveryMetadata",e.logger,e.performanceClient,e.correlationId)(n);e.canonicalAuthority=e.canonicalAuthority.replace(e.hostnameAndPort,n.preferred_network);const o=yield T(e.updateEndpointMetadata.bind(e),"authorityUpdateEndpointMetadata",e.logger,e.performanceClient,e.correlationId)(n);e.updateCachedMetadata(n,r,{source:o}),e.performanceClient?.addFields({cloudDiscoverySource:r,authorityEndpointSource:o},e.correlationId)})()}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:XP(),jwks_uri:""}),e}updateCachedMetadata(e,n,r){"cache"!==n&&"cache"!==r?.source&&(e.expiresAt=XP(),e.canonical_authority=this.canonicalAuthority);const o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}updateEndpointMetadata(e){var n=this;return y(function*(){n.performanceClient?.addQueueMeasurement("authorityUpdateEndpointMetadata",n.correlationId);const r=n.updateEndpointMetadataFromLocalSources(e);if(r){if("hardcoded_values"===r.source&&n.authorityOptions.azureRegionConfiguration?.azureRegion&&r.metadata){const i=yield T(n.updateMetadataWithRegionalInformation.bind(n),"authorityUpdateMetadataWithRegionalInformation",n.logger,n.performanceClient,n.correlationId)(r.metadata);pp(e,i,!1),e.canonical_authority=n.canonicalAuthority}return r.source}let o=yield T(n.getEndpointMetadataFromNetwork.bind(n),"authorityGetEndpointMetadataFromNetwork",n.logger,n.performanceClient,n.correlationId)();if(o)return n.authorityOptions.azureRegionConfiguration?.azureRegion&&(o=yield T(n.updateMetadataWithRegionalInformation.bind(n),"authorityUpdateMetadataWithRegionalInformation",n.logger,n.performanceClient,n.correlationId)(o)),pp(e,o,!0),"network";throw b(qf,n.defaultOpenIdConfigurationEndpoint)})()}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const n=this.getEndpointMetadataFromConfig();if(n)return this.logger.verbose("Found endpoint metadata in authority configuration"),pp(e,n,!1),{source:"config"};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const o=this.getEndpointMetadataFromHardcodedValues();if(o)return pp(e,o,!1),{source:"hardcoded_values",metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=e0(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:"cache"}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new se(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Ie(hh)}return null}getEndpointMetadataFromNetwork(){var e=this;return y(function*(){e.performanceClient?.addQueueMeasurement("authorityGetEndpointMetadataFromNetwork",e.correlationId);const n={},r=e.defaultOpenIdConfigurationEndpoint;e.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${r}`);try{const o=yield e.networkInterface.sendGetRequestAsync(r,n);return function XQ(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}(o.body)?o.body:(e.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(o){return e.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${o}`),null}})()}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in YO?YO[this.hostnameAndPort]:null}updateMetadataWithRegionalInformation(e){var n=this;return y(function*(){n.performanceClient?.addQueueMeasurement("authorityUpdateMetadataWithRegionalInformation",n.correlationId);const r=n.authorityOptions.azureRegionConfiguration?.azureRegion;if(r){if(r!==w.AZURE_REGION_AUTO_DISCOVER_FLAG)return n.regionDiscoveryMetadata.region_outcome="2",n.regionDiscoveryMetadata.region_used=r,pt.replaceWithRegionalInformation(e,r);const o=yield T(n.regionDiscovery.detectRegion.bind(n.regionDiscovery),"regionDiscoveryDetectRegion",n.logger,n.performanceClient,n.correlationId)(n.authorityOptions.azureRegionConfiguration?.environmentRegion,n.regionDiscoveryMetadata);if(o)return n.regionDiscoveryMetadata.region_outcome="4",n.regionDiscoveryMetadata.region_used=o,pt.replaceWithRegionalInformation(e,o);n.regionDiscoveryMetadata.region_outcome="5"}return e})()}updateCloudDiscoveryMetadata(e){var n=this;return y(function*(){n.performanceClient?.addQueueMeasurement("authorityUpdateCloudDiscoveryMetadata",n.correlationId);const r=n.updateCloudDiscoveryMetadataFromLocalSources(e);if(r)return r;const o=yield T(n.getCloudDiscoveryMetadataFromNetwork.bind(n),"authorityGetCloudDiscoveryMetadataFromNetwork",n.logger,n.performanceClient,n.correlationId)();if(o)return EI(e,o,!0),"network";throw Ie(ph)})()}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||w.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||w.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||w.NOT_APPLICABLE}`);const n=this.getCloudDiscoveryMetadataFromConfig();if(n)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),EI(e,n,!1),"config";if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const o=function p5(t){return _h(vE.metadata,t)}(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),EI(e,o,!1),"hardcoded_values";this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const r=e0(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),"cache"):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(3===this.authorityType)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),pt.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const n=_h(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),n)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),n;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Ie(rl)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),pt.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}getCloudDiscoveryMetadataFromNetwork(){var e=this;return y(function*(){e.performanceClient?.addQueueMeasurement("authorityGetCloudDiscoveryMetadataFromNetwork",e.correlationId);const n=`${w.AAD_INSTANCE_DISCOVERY_ENDPT}${e.canonicalAuthority}oauth2/v2.0/authorize`,r={};let o=null;try{const i=yield e.networkInterface.sendGetRequestAsync(n,r);let s,a;if(function eY(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}(i.body))s=i.body,a=s.metadata,e.logger.verbosePii(`tenant_discovery_endpoint is: ${s.tenant_discovery_endpoint}`);else{if(!function tY(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}(i.body))return e.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(e.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),s=i.body,s.error===w.INVALID_INSTANCE)return e.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;e.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${s.error}`),e.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${s.error_description}`),e.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}e.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),o=_h(a,e.hostnameAndPort)}catch(i){return e.logger.error(i instanceof me?`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${i.errorCode}\nError Description: ${i.errorMessage}`:`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${i.name}\nError Description: ${i.message}`),null}return o||(e.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),e.logger.verbose("Creating custom Authority for custom domain scenario."),o=pt.createCloudDiscoveryMetadataFromHost(e.hostnameAndPort)),o})()}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(n=>n&&se.getDomainFromUrl(n).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,n){let r;return n&&"none"!==n.azureCloudInstance&&(r=`${n.azureCloudInstance}/${n.tenant?n.tenant:w.DEFAULT_COMMON_TENANT}/`),r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return w.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw b(Dn)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return JO.has(e)}static isPublicCloudAuthority(e){return w.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,n,r){const o=new se(e);o.validateAsUri();const i=o.getUrlComponents();let s=`${n}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(s=`${n}.${w.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=se.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:s}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,n){const r={...e};return r.authorization_endpoint=pt.buildRegionalAuthorityString(r.authorization_endpoint,n),r.token_endpoint=pt.buildRegionalAuthorityString(r.token_endpoint,n),r.end_session_endpoint&&(r.end_session_endpoint=pt.buildRegionalAuthorityString(r.end_session_endpoint,n)),r}static transformCIAMAuthority(e){let n=e;const o=new se(e).getUrlComponents();return 0===o.PathSegments.length&&o.HostNameAndPort.endsWith(w.CIAM_AUTH_URL)&&(n=`${n}${o.HostNameAndPort.split(".")[0]}${w.AAD_TENANT_DOMAIN_SUFFIX}`),n}}function t0(t){return t.endsWith(w.FORWARD_SLASH)?t:`${t}${w.FORWARD_SLASH}`}pt.reservedTenantDomains=new Set(["{tenant}","{tenantid}","common","consumers","organizations"]);const Vs="no_tokens_found",gp="native_account_unavailable",II="refresh_token_expired",_I="ux_not_allowed",$s="bad_token",n0=["interaction_required","consent_required","login_required",$s,_I],mY=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],mp={[Vs]:"No refresh token found in the cache. Please sign-in.",[gp]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[II]:"Refresh token has expired.",[$s]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[_I]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class Mn extends me{constructor(e,n,r,o,i,s,a,c){super(e,n,r),Object.setPrototypeOf(this,Mn.prototype),this.timestamp=o||w.EMPTY_STRING,this.traceId=i||w.EMPTY_STRING,this.correlationId=s||w.EMPTY_STRING,this.claims=a||w.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}}function r0(t,e,n){const r=!!t&&n0.indexOf(t)>-1,o=!!n&&mY.indexOf(n)>-1,i=!!e&&n0.some(s=>e.indexOf(s)>-1);return r||i||o}function yp(t){return new Mn(t,mp[t])}function vp(t,e){if(!t)throw b($f);try{const n=e(t);return JSON.parse(n)}catch{throw b(Gc)}}function zs(t){if(!t)throw b(Gc);const e=t.split(".",2);return{uid:e[0],utid:e.length<2?w.EMPTY_STRING:e[1]}}function o0(t){return t&&(t.tid||t.tfp||t.acr)||null}class Nn{getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,loginHint:this.loginHint,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static createAccount(e,n,r){const o=new Nn;let i;o.authorityType=1===n.authorityType?"ADFS":"OIDC"===n.protocolMode?"Generic":"MSSTS",e.clientInfo&&r&&(i=vp(e.clientInfo,r)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;const s=e.environment||n&&n.getPreferredCache();if(!s)throw b(Jc);if(o.environment=s,o.realm=i?.utid||o0(e.idTokenClaims)||"",o.localAccountId=i?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"",o.username=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn||(e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null)||"",o.loginHint=e.idTokenClaims?.login_hint,o.name=e.idTokenClaims?.name||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{const l=mE(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[l]}return o}static createFromAccountInfo(e,n,r){const o=new Nn;return o.authorityType=e.authorityType||"Generic",o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.loginHint=e.loginHint,o.cloudGraphHostName=n,o.msGraphHost=r,o.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),o}static generateHomeAccountId(e,n,r,o,i){if(1!==n&&2!==n){if(e)try{const s=vp(e,o.base64Decode);if(s.uid&&s.utid)return`${s.uid}.${s.utid}`}catch{}r.warning("No client info in response")}return i?.sub||""}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,n,r){if(!e||!n)return!1;let o=!0;if(r){const i=e.idTokenClaims||{},s=n.idTokenClaims||{};o=i.iat===s.iat&&i.nonce===s.nonce}return e.homeAccountId===n.homeAccountId&&e.localAccountId===n.localAccountId&&e.username===n.username&&e.tenantId===n.tenantId&&e.loginHint===n.loginHint&&e.environment===n.environment&&e.nativeAccountId===n.nativeAccountId&&o}}function Cp(t,e,n){return{clientId:t,authority:e.authority,scopes:e.scopes,homeAccountIdentifier:n,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,embeddedClientId:e.embeddedClientId||e.tokenBodyParameters?.clientId}}class s0{initialize(){return Promise.resolve()}getItem(e){const n=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let o=0;o<r.length;o++){const i=r[o],[s,...a]=decodeURIComponent(i).trim().split("="),c=a.join("=");if(s===n)return c}return""}getUserData(){throw b(X)}setItem(e,n,r,o=!0,i="Lax"){let s=`${encodeURIComponent(e)}=${encodeURIComponent(n)};path=/;SameSite=${i};`;if(r){s+=`expires=${function vY(t){return new Date((new Date).getTime()+864e5*t).toUTCString()}(r)};`}(o||"None"===i)&&(s+="Secure;"),document.cookie=s}setUserData(){return y(function*(){return Promise.reject(b(X))})()}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),n=[];return e.forEach(r=>{const o=decodeURIComponent(r).trim().split("=");n.push(o[0])}),n}containsKey(e){return this.getKeys().includes(e)}decryptData(){return Promise.resolve(null)}}function yl(t,e){const n=t.getItem(Yn(e));return n?JSON.parse(n):[]}function vl(t,e,n){const r=e.getItem(si(t,n));if(r){const o=JSON.parse(r);if(o&&o.hasOwnProperty("idToken")&&o.hasOwnProperty("accessToken")&&o.hasOwnProperty("refreshToken"))return o}return{idToken:[],accessToken:[],refreshToken:[]}}function wI(t){return t.hasOwnProperty("id")&&t.hasOwnProperty("nonce")&&t.hasOwnProperty("data")}const a0="msal.cache.encryption";class EY{constructor(e,n,r){if(!window.localStorage)throw lI(ml);this.memoryStorage=new lp,this.initialized=!1,this.clientId=e,this.logger=n,this.performanceClient=r,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}initialize(e){var n=this;return y(function*(){const r=new s0,o=r.getItem(a0);let i={key:"",id:""};if(o)try{i=JSON.parse(o)}catch{}if(i.key&&i.id){const s=Xt(so,"base64Decode",n.logger,n.performanceClient,e)(i.key);n.encryptionCookie={id:i.id,key:yield T(NP,"generateHKDF",n.logger,n.performanceClient,e)(s)}}else{const s=bn(),a=yield T(MP,"generateBaseKey",n.logger,n.performanceClient,e)(),c=Xt(io,"urlEncodeArr",n.logger,n.performanceClient,e)(new Uint8Array(a));n.encryptionCookie={id:s,key:yield T(NP,"generateHKDF",n.logger,n.performanceClient,e)(a)},r.setItem(a0,JSON.stringify({id:s,key:c}),0,!0,"None")}yield T(n.importExistingCache.bind(n),"importExistingCache",n.logger,n.performanceClient,e)(e),n.broadcast.addEventListener("message",n.updateCache.bind(n)),n.initialized=!0})()}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw M(ri);return this.memoryStorage.getItem(e)}decryptData(e,n,r){var o=this;return y(function*(){if(!o.initialized||!o.encryptionCookie)throw M(ri);if(n.id!==o.encryptionCookie.id)return o.performanceClient.incrementFields({encryptedCacheExpiredCount:1},r),null;const i=yield T(OP,"decrypt",o.logger,o.performanceClient,r)(o.encryptionCookie.key,n.nonce,o.getContext(e),n.data);if(!i)return null;try{return JSON.parse(i)}catch{return o.performanceClient.incrementFields({encryptedCacheCorruptionCount:1},r),null}})()}setItem(e,n){window.localStorage.setItem(e,n)}setUserData(e,n,r,o){var i=this;return y(function*(){if(!i.initialized||!i.encryptionCookie)throw M(ri);const{data:s,nonce:a}=yield T(xQ,"encrypt",i.logger,i.performanceClient,r)(i.encryptionCookie.key,n,i.getContext(e)),c={id:i.encryptionCookie.id,nonce:a,data:s,lastUpdatedAt:o};i.memoryStorage.setItem(e,n),i.setItem(e,JSON.stringify(c)),i.broadcast.postMessage({key:e,value:n,context:i.getContext(e)})})()}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),yl(this).forEach(r=>this.removeItem(r));const n=vl(this.clientId,this);n.idToken.forEach(r=>this.removeItem(r)),n.accessToken.forEach(r=>this.removeItem(r)),n.refreshToken.forEach(r=>this.removeItem(r)),this.getKeys().forEach(r=>{(r.startsWith(ot)||-1!==r.indexOf(this.clientId))&&this.removeItem(r)})}importExistingCache(e){var n=this;return y(function*(){if(!n.encryptionCookie)return;let r=yl(n);r=yield n.importArray(r,e),r.length?n.setItem(Yn(),JSON.stringify(r)):n.removeItem(Yn());const o=vl(n.clientId,n);o.idToken=yield n.importArray(o.idToken,e),o.accessToken=yield n.importArray(o.accessToken,e),o.refreshToken=yield n.importArray(o.refreshToken,e),o.idToken.length||o.accessToken.length||o.refreshToken.length?n.setItem(si(n.clientId),JSON.stringify(o)):n.removeItem(si(n.clientId))})()}getItemFromEncryptedCache(e,n){var r=this;return y(function*(){if(!r.encryptionCookie)return null;const o=r.getItem(e);if(!o)return null;let i;try{i=JSON.parse(o)}catch{return null}return wI(i)?i.id!==r.encryptionCookie.id?(r.performanceClient.incrementFields({encryptedCacheExpiredCount:1},n),null):T(OP,"decrypt",r.logger,r.performanceClient,n)(r.encryptionCookie.key,i.nonce,r.getContext(e),i.data):(r.performanceClient.incrementFields({unencryptedCacheCount:1},n),i)})()}importArray(e,n){var r=this;return y(function*(){const o=[],i=[];return e.forEach(s=>{const a=r.getItemFromEncryptedCache(s,n).then(c=>{c?(r.memoryStorage.setItem(s,c),o.push(s)):r.removeItem(s)});i.push(a)}),yield Promise.all(i),o})()}getContext(e){let n="";return e.includes(this.clientId)&&(n=this.clientId),n}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const n=this.performanceClient.startMeasurement("localStorageUpdated");n.add({isBackground:!0});const{key:r,value:o,context:i}=e.data;return r?i&&i!==this.clientId?(this.logger.trace(`Ignoring broadcast event from clientId: ${i}`),void n.end({success:!1,errorCode:"contextMismatch"})):(o?(this.memoryStorage.setItem(r,o),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(r),this.logger.verbose("Removed item from internal cache")),void n.end({success:!0})):(this.logger.error("Broadcast event missing key"),void n.end({success:!1,errorCode:"noKey"}))}}class IY{constructor(){if(!window.sessionStorage)throw lI(ml)}initialize(){return y(function*(){})()}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,n){window.sessionStorage.setItem(e,n)}setUserData(e,n){var r=this;return y(function*(){r.setItem(e,n)})()}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}decryptData(){return Promise.resolve(null)}}function c0(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class SI extends _E{constructor(e,n,r,o,i,s,a){super(e,r,o,i,a),this.cacheConfig=n,this.logger=o,this.internalStorage=new lp,this.browserStorage=l0(e,n.cacheLocation,o,i),this.temporaryCacheStorage=l0(e,n.temporaryCacheLocation,o,i),this.cookieStorage=new s0,this.eventHandler=s}initialize(e){var n=this;return y(function*(){n.performanceClient.addFields({cacheLocation:n.cacheConfig.cacheLocation,cacheRetentionDays:n.cacheConfig.cacheRetentionDays},e),yield n.browserStorage.initialize(e),yield n.migrateExistingCache(e),n.trackVersionChanges(e)})()}migrateExistingCache(e){var n=this;return y(function*(){const r=yl(n.browserStorage,0),o=vl(n.clientId,n.browserStorage,0);n.performanceClient.addFields({oldAccountCount:r.length,oldAccessCount:o.accessToken.length,oldIdCount:o.idToken.length,oldRefreshCount:o.refreshToken.length},e);const i=yl(n.browserStorage,1),s=vl(n.clientId,n.browserStorage,1);n.performanceClient.addFields({currAccountCount:i.length,currAccessCount:s.accessToken.length,currIdCount:s.idToken.length,currRefreshCount:s.refreshToken.length},e),yield Promise.all([n.updateV0ToCurrent(1,r,i,e),n.updateV0ToCurrent(1,o.idToken,s.idToken,e),n.updateV0ToCurrent(1,o.accessToken,s.accessToken,e),n.updateV0ToCurrent(1,o.refreshToken,s.refreshToken,e)]),r.length>0?n.browserStorage.setItem(Yn(0),JSON.stringify(r)):n.browserStorage.removeItem(Yn(0)),i.length>0?n.browserStorage.setItem(Yn(1),JSON.stringify(i)):n.browserStorage.removeItem(Yn(1)),n.setTokenKeys(o,e,0),n.setTokenKeys(s,e,1)})()}updateV0ToCurrent(e,n,r,o){var i=this;return y(function*(){const s=[];for(const a of[...n]){const c=i.browserStorage.getItem(a),l=i.validateAndParseJson(c||"");if(!l){c0(n,a);continue}l.lastUpdatedAt||(l.lastUpdatedAt=Date.now().toString(),i.setItem(a,JSON.stringify(l),o));const u=wI(l)?yield i.browserStorage.decryptData(a,l,o):l;let d;if(u&&(JP(u)||ZP(u))&&(d=u.expiresOn),!u||rY(l.lastUpdatedAt,i.cacheConfig.cacheRetentionDays)||d&&dp(d,300))i.browserStorage.removeItem(a),c0(n,a),i.performanceClient.incrementFields({expiredCacheRemovedCount:1},o);else if("localStorage"!==i.cacheConfig.cacheLocation||wI(l)){const f=`${ot}.${e}-${a}`,h=i.browserStorage.getItem(f);if(!h){s.push(i.setUserData(f,JSON.stringify(u),o,l.lastUpdatedAt).then(()=>{r.push(f),i.performanceClient.incrementFields({upgradedCacheCount:1},o)}));continue}{const p=i.validateAndParseJson(h);if(Number(l.lastUpdatedAt)>Number(p.lastUpdatedAt)){s.push(i.setUserData(f,JSON.stringify(u),o,l.lastUpdatedAt).then(()=>{i.performanceClient.incrementFields({updatedCacheFromV0Count:1},o)}));continue}}}}return Promise.all(s)})()}trackVersionChanges(e){const n=this.browserStorage.getItem(jP);n&&(this.logger.info(`MSAL.js was last initialized by version: ${n}`),this.performanceClient.addFields({previousLibraryVersion:n},e)),n!==ii&&this.setItem(jP,ii,e)}validateAndParseJson(e){if(!e)return null;try{const n=JSON.parse(e);return n&&"object"==typeof n?n:null}catch{return null}}setItem(e,n,r){let o=0,i=[];for(let a=0;a<=20;a++)try{this.browserStorage.setItem(e,n),a>0&&(a<=o?this.removeAccessTokenKeys(i.slice(0,a),r,0):(this.removeAccessTokenKeys(i.slice(0,o),r,0),this.removeAccessTokenKeys(i.slice(o,a),r)));break}catch(c){const l=IE(c);if(!(l.errorCode===Th&&a<20))throw l;if(!i.length){const u=e===si(this.clientId,0)?JSON.parse(n).accessToken:this.getTokenKeys(0).accessToken,d=e===si(this.clientId)?JSON.parse(n).accessToken:this.getTokenKeys().accessToken;i=[...u,...d],o=u.length}if(i.length<=a)throw l;this.removeAccessToken(i[a],r,!1)}}setUserData(e,n,r,o){var i=this;return y(function*(){let s=0,a=[];for(let l=0;l<=20;l++)try{yield T(i.browserStorage.setUserData.bind(i.browserStorage),"setUserData",i.logger,i.performanceClient)(e,n,r,o),l>0&&(l<=s?i.removeAccessTokenKeys(a.slice(0,l),r,0):(i.removeAccessTokenKeys(a.slice(0,s),r,0),i.removeAccessTokenKeys(a.slice(s,l),r)));break}catch(u){const d=IE(u);if(!(d.errorCode===Th&&l<20))throw d;if(!a.length){const f=i.getTokenKeys(0).accessToken,h=i.getTokenKeys().accessToken;a=[...f,...h],s=f.length}if(a.length<=l)throw d;i.removeAccessToken(a[l],r,!1)}})()}getAccount(e,n){this.logger.trace("BrowserCacheManager.getAccount called");const r=this.browserStorage.getUserData(e);if(!r)return this.removeAccountKeyFromMap(e,n),null;const o=this.validateAndParseJson(r);return o&&Nn.isAccountEntity(o)?_E.toObject(new Nn,o):null}setAccount(e,n){var r=this;return y(function*(){r.logger.trace("BrowserCacheManager.setAccount called");const o=r.generateAccountKey(e.getAccountInfo()),i=Date.now().toString();e.lastUpdatedAt=i,yield r.setUserData(o,JSON.stringify(e),n,i);const s=r.addAccountKeyToMap(o,n);"localStorage"===r.cacheConfig.cacheLocation&&s&&r.eventHandler.emitEvent("msal:accountAdded",void 0,e.getAccountInfo())})()}getAccountKeys(){return yl(this.browserStorage)}addAccountKeyToMap(e,n){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const r=this.getAccountKeys();return-1===r.indexOf(e)?(r.push(e),this.setItem(Yn(),JSON.stringify(r),n),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,n){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const r=this.getAccountKeys(),o=r.indexOf(e);if(o>-1){if(r.splice(o,1),0===r.length)return void this.removeItem(Yn());this.setItem(Yn(),JSON.stringify(r),n),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,n){const r=this.getActiveAccount(n);r?.homeAccountId===e.homeAccountId&&r?.environment===e.environment&&this.setActiveAccount(null,n),super.removeAccount(e,n),this.removeAccountKeyFromMap(this.generateAccountKey(e),n),this.browserStorage.getKeys().forEach(o=>{o.includes(e.homeAccountId)&&o.includes(e.environment)&&this.browserStorage.removeItem(o)}),"localStorage"===this.cacheConfig.cacheLocation&&this.eventHandler.emitEvent("msal:accountRemoved",void 0,e)}removeIdToken(e,n){super.removeIdToken(e,n);const r=this.getTokenKeys(),o=r.idToken.indexOf(e);o>-1&&(this.logger.info("idToken removed from tokenKeys map"),r.idToken.splice(o,1),this.setTokenKeys(r,n))}removeAccessToken(e,n,r=!0){super.removeAccessToken(e,n),r&&this.removeAccessTokenKeys([e],n)}removeAccessTokenKeys(e,n,r=1){this.logger.trace("removeAccessTokenKey called");const o=this.getTokenKeys(r);let i=0;if(e.forEach(s=>{const a=o.accessToken.indexOf(s);a>-1&&(o.accessToken.splice(a,1),i++)}),i>0)return this.logger.info(`removed ${i} accessToken keys from tokenKeys map`),void this.setTokenKeys(o,n,r)}removeRefreshToken(e,n){super.removeRefreshToken(e,n);const r=this.getTokenKeys(),o=r.refreshToken.indexOf(e);o>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),r.refreshToken.splice(o,1),this.setTokenKeys(r,n))}getTokenKeys(e=1){return vl(this.clientId,this.browserStorage,e)}setTokenKeys(e,n,r=1){0!==e.idToken.length||0!==e.accessToken.length||0!==e.refreshToken.length?this.setItem(si(this.clientId,r),JSON.stringify(e),n):this.removeItem(si(this.clientId,r))}getIdTokenCredential(e,n){const r=this.browserStorage.getUserData(e);if(!r)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,n),null;const o=this.validateAndParseJson(r);return o&&function iY(t){return!!t&&CI(t)&&t.hasOwnProperty("realm")&&t.credentialType===ct.ID_TOKEN}(o)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),o):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)}setIdTokenCredential(e,n){var r=this;return y(function*(){r.logger.trace("BrowserCacheManager.setIdTokenCredential called");const o=r.generateCredentialKey(e),i=Date.now().toString();e.lastUpdatedAt=i,yield r.setUserData(o,JSON.stringify(e),n,i);const s=r.getTokenKeys();-1===s.idToken.indexOf(o)&&(r.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),s.idToken.push(o),r.setTokenKeys(s,n))})()}getAccessTokenCredential(e,n){const r=this.browserStorage.getUserData(e);if(!r)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],n),null;const o=this.validateAndParseJson(r);return o&&JP(o)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),o):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)}setAccessTokenCredential(e,n){var r=this;return y(function*(){r.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const o=r.generateCredentialKey(e),i=Date.now().toString();e.lastUpdatedAt=i,yield r.setUserData(o,JSON.stringify(e),n,i);const s=r.getTokenKeys(),a=s.accessToken.indexOf(o);-1!==a&&s.accessToken.splice(a,1),r.logger.trace(`access token ${-1===a?"added to":"updated in"} map`),s.accessToken.push(o),r.setTokenKeys(s,n)})()}getRefreshTokenCredential(e,n){const r=this.browserStorage.getUserData(e);if(!r)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,n),null;const o=this.validateAndParseJson(r);return o&&ZP(o)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),o):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)}setRefreshTokenCredential(e,n){var r=this;return y(function*(){r.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const o=r.generateCredentialKey(e),i=Date.now().toString();e.lastUpdatedAt=i,yield r.setUserData(o,JSON.stringify(e),n,i);const s=r.getTokenKeys();-1===s.refreshToken.indexOf(o)&&(r.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),s.refreshToken.push(o),r.setTokenKeys(s,n))})()}getAppMetadata(e){const n=this.browserStorage.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(n);return r&&function lY(t,e){return!!e&&0===t.indexOf($C)&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment")}(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)}setAppMetadata(e,n){this.logger.trace("BrowserCacheManager.setAppMetadata called");const r=function cY({environment:t,clientId:e}){return[$C,t,e].join("-").toLowerCase()}(e);this.setItem(r,JSON.stringify(e),n)}getServerTelemetry(e){const n=this.browserStorage.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(n);return r&&function sY(t,e){const n=0===t.indexOf(lt.CACHE_KEY);let r=!0;return e&&(r=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),n&&r}(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,n,r){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(n),r)}getAuthorityMetadata(e){const n=this.internalStorage.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(n);return r&&function uY(t,e){return!!e&&0===t.indexOf("authority-metadata")&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri")}(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(n=>this.isAuthorityMetadata(n))}setWrapperMetadata(e,n){this.internalStorage.setItem("wrapper.sku",e),this.internalStorage.setItem("wrapper.version",n)}getWrapperMetadata(){return[this.internalStorage.getItem("wrapper.sku")||w.EMPTY_STRING,this.internalStorage.getItem("wrapper.version")||w.EMPTY_STRING]}setAuthorityMetadata(e,n){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(n))}getActiveAccount(e){const n=this.generateCacheKey("active-account-filters"),r=this.browserStorage.getItem(n);if(!r)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const o=this.validateAndParseJson(r);return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:o.homeAccountId,localAccountId:o.localAccountId,tenantId:o.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,n){const r=this.generateCacheKey("active-account-filters");if(e){this.logger.verbose("setActiveAccount: Active account set");const o={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:$t().toString()};this.setItem(r,JSON.stringify(o),n)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(r);this.eventHandler.emitEvent("msal:activeAccountChanged")}getThrottlingCache(e){const n=this.browserStorage.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(n);return r&&function aY(t,e){let n=!1;t&&(n=0===t.indexOf("throttling"));let r=!0;return e&&(r=e.hasOwnProperty("throttleTime")),n&&r}(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,n,r){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(n),r)}getTemporaryCache(e,n){const r=n?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const i=this.cookieStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}const o=this.temporaryCacheStorage.getItem(r);if(!o){if("localStorage"===this.cacheConfig.cacheLocation){const i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o}setTemporaryCache(e,n,r){const o=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,n),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(o,n,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(n=>{(-1!==n.indexOf(ot)||-1!==n.indexOf(this.clientId))&&this.removeTemporaryItem(n)}),this.browserStorage.getKeys().forEach(n=>{(-1!==n.indexOf(ot)||-1!==n.indexOf(this.clientId))&&this.browserStorage.removeItem(n)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement("clearTokensAndKeysWithClaims",e);const n=this.getTokenKeys();let r=0;n.accessToken.forEach(o=>{const i=this.getAccessTokenCredential(o,e);i?.requestedClaimsHash&&o.includes(i.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(o,e),r++)}),r>0&&this.logger.warning(`${r} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return Zt.startsWith(e,ot)?e:`${ot}.${this.clientId}.${e}`}generateCredentialKey(e){const n=e.credentialType===ct.REFRESH_TOKEN&&e.familyId||e.clientId,r=e.tokenType&&e.tokenType.toLowerCase()!==de.BEARER.toLowerCase()?e.tokenType.toLowerCase():"";return[`${ot}.1`,e.homeAccountId,e.environment,e.credentialType,n,e.realm||"",e.target||"",e.requestedClaimsHash||"",r].join("-").toLowerCase()}generateAccountKey(e){const n=e.homeAccountId.split(".")[1];return[`${ot}.1`,e.homeAccountId,e.environment,n||e.tenantId||""].join("-").toLowerCase()}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey("request.params")),this.removeTemporaryItem(this.generateCacheKey("code.verifier")),this.removeTemporaryItem(this.generateCacheKey("request.origin")),this.removeTemporaryItem(this.generateCacheKey("urlHash")),this.removeTemporaryItem(this.generateCacheKey("request.native")),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,n){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const r=gl(JSON.stringify(e));if(this.setTemporaryCache("request.params",r,!0),n){const o=gl(n);this.setTemporaryCache("code.verifier",o,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache("request.params",!0);if(!e)throw M(Fh);const n=this.getTemporaryCache("code.verifier",!0);let r,o="";try{r=JSON.parse(An(e)),n&&(o=An(n))}catch(i){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${i}`),M(Lh)}return[r,o]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache("request.native",!0);return e?this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)}isInteractionInProgress(e){const n=this.getInteractionInProgress()?.clientId;return e?n===this.clientId:!!n}getInteractionInProgress(){const e=`${ot}.interaction.status`,n=this.getTemporaryCache(e,!1);try{return n?JSON.parse(n):null}catch{return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),xP(window),null}}setInteractionInProgress(e,n="signin"){const r=`${ot}.interaction.status`;if(e){if(this.getInteractionInProgress())throw M(bh);this.setTemporaryCache(r,JSON.stringify({clientId:this.clientId,type:n}),!1)}else!e&&this.getInteractionInProgress()?.clientId===this.clientId&&this.removeTemporaryItem(r)}hydrateCache(e,n){var r=this;return y(function*(){const o=fp(e.account?.homeAccountId,e.account?.environment,e.idToken,r.clientId,e.tenantId);let i;n.claims&&(i=yield r.cryptoImpl.hashString(n.claims));const s=hp(e.account?.homeAccountId,e.account.environment,e.accessToken,r.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?QP(e.expiresOn):0,e.extExpiresOn?QP(e.extExpiresOn):0,An,void 0,e.tokenType,void 0,n.sshKid,n.claims,i);return r.saveCacheRecord({idToken:o,accessToken:s},e.correlationId)})()}saveCacheRecord(e,n,r){var o=()=>super.saveCacheRecord,i=this;return y(function*(){try{yield o().call(i,e,n,r)}catch(s){if(s instanceof xs&&i.performanceClient&&n)try{const a=i.getTokenKeys();i.performanceClient.addFields({cacheRtCount:a.refreshToken.length,cacheIdCount:a.idToken.length,cacheAtCount:a.accessToken.length},n)}catch{}throw s}})()}}function l0(t,e,n,r){try{switch(e){case"localStorage":return new EY(t,n,r);case"sessionStorage":return new IY}}catch(o){n.error(o)}return new lp}class NY{constructor(e){this.eventCallbacks=new Map,this.logger=e||new to({}),typeof BroadcastChannel<"u"&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,n,r){if(typeof window<"u"){const o=r||function VQ(){return bn()}();return this.eventCallbacks.has(o)?(this.logger.error(`Event callback with id: ${o} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(o,[e,n||[]]),this.logger.verbose(`Event callback registered with id: ${o}`),o)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,n,r,o){const i={eventType:e,interactionType:n||null,payload:r||null,error:o||null,timestamp:Date.now()};switch(e){case"msal:accountAdded":case"msal:accountRemoved":case"msal:activeAccountChanged":this.broadcastChannel?.postMessage(i);break;default:this.invokeCallbacks(i)}}invokeCallbacks(e){this.eventCallbacks.forEach(([n,r],o)=>{(0===r.length||r.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${o}: ${e.eventType}`),n.apply(null,[e]))})}invokeCrossTabCallbacks(e){this.invokeCallbacks(e.data)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}function u0(t,e,n,r,o,i,s){return DI.apply(this,arguments)}function DI(){return(DI=y(function*(t,e,n,r,o,i,s){s?.addQueueMeasurement("authorityFactoryCreateDiscoveredInstance",i);const a=pt.transformCIAMAuthority(t0(t)),c=new pt(a,e,n,r,o,i,s);try{return yield T(c.resolveEndpointsAsync.bind(c),"authorityResolveEndpointsAsync",o,s,i)(),c}catch{throw b(Dn)}})).apply(this,arguments)}class ai extends me{constructor(e,n,r,o,i){super(e,n,r),this.name="ServerError",this.errorNo=o,this.status=i,Object.setPrototypeOf(this,ai.prototype)}}class Jn{static generateThrottlingStorageKey(e){return`throttling.${JSON.stringify(e)}`}static preProcess(e,n,r){const o=Jn.generateThrottlingStorageKey(n),i=e.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void e.removeItem(o,r);throw new ai(i.errorCodes?.join(" ")||w.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,n,r,o){if(Jn.checkResponseStatus(r)||Jn.checkResponseForRetryAfter(r)){const i={throttleTime:Jn.calculateThrottleTime(parseInt(r.headers["Retry-After"])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(Jn.generateThrottlingStorageKey(n),i,o)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty("Retry-After")&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){const n=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(n||60),r+3600))}static removeThrottle(e,n,r,o){const i=Cp(n,r,o),s=this.generateThrottlingStorageKey(i);e.removeItem(s,r.correlationId)}}class AI{constructor(e,n){this.config=function w5({authOptions:t,systemOptions:e,loggerOptions:n,cacheOptions:r,storageInterface:o,networkInterface:i,cryptoInterface:s,clientCredentials:a,libraryInfo:c,telemetry:l,serverTelemetryManager:u,persistencePlugin:d,serializableCache:f}){const h={...y5,...n};return{authOptions:S5(t),systemOptions:{...tP,...e},loggerOptions:h,cacheOptions:{...v5,...r},storageInterface:o||new g5(t.clientId,sh,new to(h),new eP),networkInterface:i||C5,cryptoInterface:s||sh,clientCredentials:a||I5,libraryInfo:{...E5,...c},telemetry:{...T5,...l},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:f||null}}(e),this.logger=new to(this.config.loggerOptions,$O,uE),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=n}createTokenRequestHeaders(e){const n={};if(n["Content-Type"]=w.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case"home_account_id":try{const r=zs(e.credential);n["X-AnchorMailbox"]=`Oid:${r.uid}@${r.utid}`}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case"UPN":n["X-AnchorMailbox"]=`UPN: ${e.credential}`}return n}executePostToTokenEndpoint(e,n,r,o,i,s){var a=this;return y(function*(){s&&a.performanceClient?.addQueueMeasurement(s,i);const c=yield a.sendPostRequest(o,e,{body:n,headers:r},i);return a.config.serverTelemetryManager&&c.status<500&&429!==c.status&&a.config.serverTelemetryManager.clearTelemetryCache(),c})()}sendPostRequest(e,n,r,o){var i=this;return y(function*(){let s;Jn.preProcess(i.cacheManager,e,o);try{s=yield T(i.networkClient.sendPostRequestAsync.bind(i.networkClient),"networkClientSendPostRequestAsync",i.logger,i.performanceClient,o)(n,r);const a=s.headers||{};i.performanceClient?.addFields({refreshTokenSize:s.body.refresh_token?.length||0,httpVerToken:a["x-ms-httpver"]||"",requestId:a["x-ms-request-id"]||""},o)}catch(a){if(a instanceof Xh){const c=a.responseHeaders;throw c&&i.performanceClient?.addFields({httpVerToken:c["x-ms-httpver"]||"",requestId:c["x-ms-request-id"]||"",contentTypeHeader:c["Content-Type"]||void 0,contentLengthHeader:c["Content-Length"]||void 0,httpStatus:a.httpStatus},o),a.error}throw a instanceof me?a:b(Gf)}return Jn.postProcess(i.cacheManager,e,s,o),s})()}updateAuthority(e,n){var r=this;return y(function*(){r.performanceClient?.addQueueMeasurement("updateTokenEndpointAuthority",n);const o=`https://${e}/${r.authority.tenant}/`,i=yield u0(o,r.networkClient,r.cacheManager,r.authority.options,r.logger,n,r.performanceClient);r.authority=i})()}createTokenQueryParameters(e){const n=new Map;return e.embeddedClientId&&ip(n,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&oo(n,e.tokenQueryParameters),xE(n,e.correlationId),np(n,e.correlationId,this.performanceClient),ol(n)}}class Gs{static setRequestState(e,n,r){const o=Gs.generateLibraryState(e,r);return n?`${o}${w.RESOURCE_DELIM}${n}`:o}static generateLibraryState(e,n){if(!e)throw b(Xc);const r={id:e.createNewGuid()};n&&(r.meta=n);const o=JSON.stringify(r);return e.base64Encode(o)}static parseRequestState(e,n){if(!e)throw b(Xc);if(!n)throw b(no);try{const r=n.split(w.RESOURCE_DELIM),o=r[0],i=r.length>1?r.slice(1).join(w.RESOURCE_DELIM):w.EMPTY_STRING,s=e.base64Decode(o),a=JSON.parse(s);return{userRequestState:i||w.EMPTY_STRING,libraryState:a}}catch{throw b(no)}}}class qs{constructor(e,n){this.cryptoUtils=e,this.performanceClient=n}generateCnf(e,n){var r=this;return y(function*(){r.performanceClient?.addQueueMeasurement("popTokenGenerateCnf",e.correlationId);const o=yield T(r.generateKid.bind(r),"popTokenGenerateCnf",n,r.performanceClient,e.correlationId)(e),i=r.cryptoUtils.base64UrlEncode(JSON.stringify(o));return{kid:o.kid,reqCnfString:i}})()}generateKid(e){var n=this;return y(function*(){return n.performanceClient?.addQueueMeasurement("popTokenGenerateKid",e.correlationId),{kid:yield n.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:"sw"}})()}signPopToken(e,n,r){var o=this;return y(function*(){return o.signPayload(e,n,r)})()}signPayload(e,n,r,o){var i=this;return y(function*(){const{resourceRequestMethod:s,resourceRequestUri:a,shrClaims:c,shrNonce:l,shrOptions:u}=r,f=(a?new se(a):void 0)?.getUrlComponents();return i.cryptoUtils.signJwt({at:e,ts:$t(),m:s?.toUpperCase(),u:f?.HostNameAndPort,nonce:l||i.cryptoUtils.createNewGuid(),p:f?.AbsolutePath,q:f?.QueryString?[[],f.QueryString]:void 0,client_claims:c||void 0,...o},n,u,r.correlationId)})()}}class OY{constructor(e,n){this.cache=e,this.hasChanged=n}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class ci{constructor(e,n,r,o,i,s,a){this.clientId=e,this.cacheStorage=n,this.cryptoObj=r,this.logger=o,this.serializableCache=i,this.persistencePlugin=s,this.performanceClient=a}validateTokenResponse(e,n){if(e.error||e.error_description||e.suberror){const r=`Error(s): ${e.error_codes||w.NOT_AVAILABLE} - Timestamp: ${e.timestamp||w.NOT_AVAILABLE} - Description: ${e.error_description||w.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||w.NOT_AVAILABLE} - Trace ID: ${e.trace_id||w.NOT_AVAILABLE}`,o=e.error_codes?.length?e.error_codes[0]:void 0,i=new ai(e.error,r,e.suberror,o,e.status);if(n&&e.status&&e.status>=500&&e.status<=599)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${i}`);if(n&&e.status&&e.status>=400&&e.status<=499)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${i}`);throw r0(e.error,e.error_description,e.suberror)?new Mn(e.error,e.error_description,e.suberror,e.timestamp||w.EMPTY_STRING,e.trace_id||w.EMPTY_STRING,e.correlation_id||w.EMPTY_STRING,e.claims||w.EMPTY_STRING,o):i}}handleServerTokenResponse(e,n,r,o,i,s,a,c,l){var u=this;return y(function*(){let d,f;if(u.performanceClient?.addQueueMeasurement("handleServerTokenResponse",e.correlation_id),e.id_token){if(d=Ps(e.id_token||w.EMPTY_STRING,u.cryptoObj.base64Decode),i&&i.nonce&&d.nonce!==i.nonce)throw b(Qf);if(o.maxAge||0===o.maxAge){const m=d.auth_time;if(!m)throw b(Wc);GO(m,o.maxAge)}}u.homeAccountIdentifier=Nn.generateHomeAccountId(e.client_info||w.EMPTY_STRING,n.authorityType,u.logger,u.cryptoObj,d),i&&i.state&&(f=Gs.parseRequestState(u.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;const h=u.generateCacheRecord(e,n,r,o,d,s,i);let p;try{if(u.persistencePlugin&&u.serializableCache&&(u.logger.verbose("Persistence enabled, calling beforeCacheAccess"),p=new OY(u.serializableCache,!0),yield u.persistencePlugin.beforeCacheAccess(p)),a&&!c&&h.account){const m=u.cacheStorage.generateAccountKey(h.account.getAccountInfo());if(!u.cacheStorage.getAccount(m,o.correlationId))return u.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),yield ci.generateAuthenticationResult(u.cryptoObj,n,h,!1,o,d,f,void 0,l)}yield u.cacheStorage.saveCacheRecord(h,o.correlationId,o.storeInCache)}finally{u.persistencePlugin&&u.serializableCache&&p&&(u.logger.verbose("Persistence enabled, calling afterCacheAccess"),yield u.persistencePlugin.afterCacheAccess(p))}return ci.generateAuthenticationResult(u.cryptoObj,n,h,!1,o,d,f,e,l)})()}generateCacheRecord(e,n,r,o,i,s,a){const c=n.getPreferredCache();if(!c)throw b(Jc);const l=o0(i);let u,d;e.id_token&&i&&(u=fp(this.homeAccountIdentifier,c,e.id_token,this.clientId,l||""),d=bI(this.cacheStorage,n,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o.correlationId,i,e.client_info,c,l,a,void 0,this.logger));let f=null;if(e.access_token){const m=e.scope?Xe.fromString(e.scope):new Xe(o.scopes||[]),v=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,E=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,C=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,A=r+v,P=A+E,O=C&&C>0?r+C:void 0;f=hp(this.homeAccountIdentifier,c,e.access_token,this.clientId,l||n.tenant||"",m.printScopes(),A,P,this.cryptoObj.base64Decode,O,e.token_type,s,e.key_id,o.claims,o.requestedClaimsHash)}let h=null;if(e.refresh_token){let m;e.refresh_token_expires_in&&(m=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),h=YP(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,s,m)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:c,familyId:e.foci}),{account:d,idToken:u,accessToken:f,refreshToken:h,appMetadata:p}}static generateAuthenticationResult(e,n,r,o,i,s,a,c,l){return y(function*(){let h,p,u=w.EMPTY_STRING,d=[],f=null,m=w.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==de.POP||i.popKid)u=r.accessToken.secret;else{const A=new qs(e),{secret:P,keyId:O}=r.accessToken;if(!O)throw b(el);u=yield A.signPopToken(P,O,i)}d=Xe.fromString(r.accessToken.target).asArray(),f=js(r.accessToken.expiresOn),h=js(r.accessToken.extendedExpiresOn),r.accessToken.refreshOn&&(p=js(r.accessToken.refreshOn))}r.appMetadata&&(m="1"===r.appMetadata.familyId?"1":"");const v=s?.oid||s?.sub||"",E=s?.tid||"";c?.spa_accountid&&r.account&&(r.account.nativeAccountId=c?.spa_accountid);const C=r.account?yE(r.account.getAccountInfo(),void 0,s,r.idToken?.secret):null;return{authority:n.canonicalAuthority,uniqueId:v,tenantId:E,scopes:d,account:C,idToken:r?.idToken?.secret||"",idTokenClaims:s||{},accessToken:u,fromCache:o,expiresOn:f,extExpiresOn:h,refreshOn:p,correlationId:i.correlationId,requestId:l||w.EMPTY_STRING,familyId:m,tokenType:r.accessToken?.tokenType||w.EMPTY_STRING,state:a?a.userRequestState:w.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||w.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||w.EMPTY_STRING,code:c?.spa_code,fromNativeBroker:!1}})()}}function bI(t,e,n,r,o,i,s,a,c,l,u,d){d?.verbose("setCachedAccount called");const h=t.getAccountKeys().find(C=>C.startsWith(n));let p=null;h&&(p=t.getAccount(h,o));const m=p||Nn.createAccount({homeAccountId:n,idTokenClaims:i,clientInfo:s,environment:a,cloudGraphHostName:l?.cloud_graph_host_name,msGraphHost:l?.msgraph_host,nativeAccountId:u},e,r),v=m.tenantProfiles||[],E=c||m.realm;if(E&&!v.find(C=>C.tenantId===E)){const C=mE(n,m.localAccountId,E,i);v.push(C)}return m.tenantProfiles=v,m}function d0(t,e,n){return RI.apply(this,arguments)}function RI(){return(RI=y(function*(t,e,n){return"string"==typeof t?t:t({clientId:e,tokenEndpoint:n})})).apply(this,arguments)}class f0 extends AI{constructor(e,n){super(e,n),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}acquireToken(e,n){var r=this;return y(function*(){if(r.performanceClient?.addQueueMeasurement("authClientAcquireToken",e.correlationId),!e.code)throw b(Zf);const o=$t(),i=yield T(r.executeTokenRequest.bind(r),"authClientExecuteTokenRequest",r.logger,r.performanceClient,e.correlationId)(r.authority,e),s=i.headers?.["x-ms-request-id"],a=new ci(r.config.authOptions.clientId,r.cacheManager,r.cryptoUtils,r.logger,r.config.serializableCache,r.config.persistencePlugin,r.performanceClient);return a.validateTokenResponse(i.body),T(a.handleServerTokenResponse.bind(a),"handleServerTokenResponse",r.logger,r.performanceClient,e.correlationId)(i.body,r.authority,o,e,n,void 0,void 0,void 0,s)})()}getLogoutUri(e){if(!e)throw Ie(fh);const n=this.createLogoutUrlQueryString(e);return se.appendQueryString(this.authority.endSessionEndpoint,n)}executeTokenRequest(e,n){var r=this;return y(function*(){r.performanceClient?.addQueueMeasurement("authClientExecuteTokenRequest",n.correlationId);const o=r.createTokenQueryParameters(n),i=se.appendQueryString(e.tokenEndpoint,o),s=yield T(r.createTokenRequestBody.bind(r),"authClientCreateTokenRequestBody",r.logger,r.performanceClient,n.correlationId)(n);let a;if(n.clientInfo)try{const u=vp(n.clientInfo,r.cryptoUtils.base64Decode);a={credential:`${u.uid}.${u.utid}`,type:"home_account_id"}}catch(u){r.logger.verbose("Could not parse client info for CCS Header: "+u)}const c=r.createTokenRequestHeaders(a||n.ccsCredential),l=Cp(r.config.authOptions.clientId,n);return T(r.executePostToTokenEndpoint.bind(r),"authorizationCodeClientExecutePostToTokenEndpoint",r.logger,r.performanceClient,n.correlationId)(i,s,c,l,n.correlationId,"authorizationCodeClientExecutePostToTokenEndpoint")})()}createTokenRequestBody(e){var n=this;return y(function*(){n.performanceClient?.addQueueMeasurement("authClientCreateTokenRequestBody",e.correlationId);const r=new Map;if(kE(r,e.embeddedClientId||e.tokenBodyParameters?.[oi]||n.config.authOptions.clientId),n.includeRedirectUri)OE(r,e.redirectUri);else if(!e.redirectUri)throw Ie(ah);if(NE(r,e.scopes,!0,n.oidcDefaultScopes),function yQ(t,e){t.set("code",e)}(r,e.code),FE(r,n.config.libraryInfo),LE(r,n.config.telemetry.application),TP(r),n.serverTelemetryManager&&!nP(n.config)&&_P(r,n.serverTelemetryManager),e.codeVerifier&&function CQ(t,e){t.set("code_verifier",e)}(r,e.codeVerifier),n.config.clientCredentials.clientSecret&&gP(r,n.config.clientCredentials.clientSecret),n.config.clientCredentials.clientAssertion){const i=n.config.clientCredentials.clientAssertion;mP(r,yield d0(i.assertion,n.config.authOptions.clientId,e.resourceRequestUri)),yP(r,i.assertionType)}if(vP(r,"authorization_code"),UE(r),e.authenticationScheme===de.POP){const i=new qs(n.cryptoUtils,n.performanceClient);let s;s=e.popKid?n.cryptoUtils.encodeKid(e.popKid):(yield T(i.generateCnf.bind(i),"popTokenGenerateCnf",n.logger,n.performanceClient,e.correlationId)(e,n.logger)).reqCnfString,HE(r,s)}else if(e.authenticationScheme===de.SSH){if(!e.sshJwk)throw Ie(Os);IP(r,e.sshJwk)}let o;if((!Zt.isEmptyObj(e.claims)||n.config.authOptions.clientCapabilities&&n.config.authOptions.clientCapabilities.length>0)&&PE(r,e.claims,n.config.authOptions.clientCapabilities),e.clientInfo)try{const i=vp(e.clientInfo,n.cryptoUtils.base64Decode);o={credential:`${i.uid}.${i.utid}`,type:"home_account_id"}}catch(i){n.logger.verbose("Could not parse client info for CCS Header: "+i)}else o=e.ccsCredential;if(n.config.systemOptions.preventCorsPreflight&&o)switch(o.type){case"home_account_id":try{pl(r,zs(o.credential))}catch(i){n.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case"UPN":op(r,o.credential)}return e.embeddedClientId&&ip(r,n.config.authOptions.clientId,n.config.authOptions.redirectUri),e.tokenBodyParameters&&oo(r,e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[dP])&&oo(r,{[dP]:"1"}),np(r,e.correlationId,n.performanceClient),ol(r)})()}createLogoutUrlQueryString(e){const n=new Map;return e.postLogoutRedirectUri&&function fQ(t,e){t.set("post_logout_redirect_uri",e)}(n,e.postLogoutRedirectUri),e.correlationId&&xE(n,e.correlationId),e.idTokenHint&&function hQ(t,e){t.set("id_token_hint",e)}(n,e.idTokenHint),e.state&&hP(n,e.state),e.logoutHint&&function EQ(t,e){t.set("logout_hint",e)}(n,e.logoutHint),e.extraQueryParameters&&oo(n,e.extraQueryParameters),this.config.authOptions.instanceAware&&CP(n),ol(n,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}class Cl{constructor(e,n){this.cacheOutcome="0",this.cacheManager=n,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||w.EMPTY_STRING,this.wrapperVer=e.wrapperVer||w.EMPTY_STRING,this.telemetryCacheKey=lt.CACHE_KEY+"-"+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${lt.VALUE_SEPARATOR}${this.cacheOutcome}`,n=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&n.push(`broker_error=${r}`);const o=n.join(lt.VALUE_SEPARATOR),s=[e,this.getRegionDiscoveryFields()].join(lt.VALUE_SEPARATOR);return[lt.SCHEMA_VERSION,s,o].join(lt.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),n=Cl.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*n).join(lt.VALUE_SEPARATOR),o=e.errors.slice(0,n).join(lt.VALUE_SEPARATOR),i=e.errors.length,a=[i,n<i?lt.OVERFLOW_TRUE:lt.OVERFLOW_FALSE].join(lt.VALUE_SEPARATOR);return[lt.SCHEMA_VERSION,e.cacheHits,r,o,a].join(lt.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const n=this.getLastRequests();n.errors.length>=lt.MAX_CACHED_ERRORS&&(n.failedRequests.shift(),n.failedRequests.shift(),n.errors.shift()),n.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?n.errors.push(e instanceof me?e.subError?e.subError:e.errorCode?e.errorCode:e.toString():e.toString()):n.errors.push(lt.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),n=Cl.maxErrorsToSend(e);if(n===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const o={failedRequests:e.failedRequests.slice(2*n),errors:e.errors.slice(n),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o,this.correlationId)}}static maxErrorsToSend(e){let n,r=0,o=0;const i=e.errors.length;for(n=0;n<i;n++){const a=e.failedRequests[2*n+1]||w.EMPTY_STRING,c=e.errors[n]||w.EMPTY_STRING;if(o+=(e.failedRequests[2*n]||w.EMPTY_STRING).toString().length+a.toString().length+c.length+3,!(o<lt.MAX_LAST_HEADER_BYTES))break;r+=1}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||w.EMPTY_STRING),e.push(this.regionSource||w.EMPTY_STRING),e.push(this.regionOutcome||w.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const n=this.getLastRequests();n.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return function PY(t){const{skus:e,libraryName:n,libraryVersion:r,extensionName:o,extensionVersion:i}=t,s=new Map([[0,[n,r]],[2,[o,i]]]);let a=[];if(e?.length){if(a=e.split(","),a.length<4)return e}else a=Array.from({length:4},()=>"|");return s.forEach((c,l)=>{2===c.length&&c[0]?.length&&c[1]?.length&&function xY(t){const{skuArr:e,index:n,skuName:r,skuVersion:o}=t;n>=e.length||(e[n]=[r,o].join("|"))}({skuArr:a,index:l,skuName:c[0],skuVersion:c[1]})}),a.join(",")}(e)}}class g0{constructor(e,n,r,o,i,s,a,c,l){this.config=e,this.browserStorage=n,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=s,this.platformAuthProvider=c,this.correlationId=l||bn(),this.logger=o.clone("msal.js.browser",ii,this.correlationId),this.performanceClient=a}clearCacheOnLogout(e,n){var r=this;return y(function*(){if(n)try{r.browserStorage.removeAccount(n,e),r.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{r.logger.error("Account provided in logout request was not found. Local cache unchanged.")}else try{r.logger.verbose("No account provided in logout request, clearing all cache items.",r.correlationId),r.browserStorage.clear(e),yield r.browserCrypto.clearKeystore()}catch{r.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}})()}getRedirectUri(e){return this.logger.verbose("getRedirectUri called"),se.getAbsoluteUrl(e||this.config.auth.redirectUri,vr())}initializeServerTelemetryManager(e,n){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:n||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Cl(r,this.browserStorage)}getDiscoveredAuthority(e){var n=this;return y(function*(){const{account:r}=e,o=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;n.performanceClient.addQueueMeasurement("standardInteractionClientGetDiscoveredAuthority",n.correlationId);const i={protocolMode:n.config.auth.protocolMode,OIDCOptions:n.config.auth.OIDCOptions,knownAuthorities:n.config.auth.knownAuthorities,cloudDiscoveryMetadata:n.config.auth.cloudDiscoveryMetadata,authorityMetadata:n.config.auth.authorityMetadata,skipAuthorityMetadataCache:n.config.auth.skipAuthorityMetadataCache},s=e.requestAuthority||n.config.auth.authority,c=r&&(o?.length?"true"===o:n.config.auth.instanceAware)?n.config.auth.authority.replace(se.getDomainFromUrl(s),r.environment):s,l=pt.generateAuthority(c,e.requestAzureCloudOptions||n.config.auth.azureCloudOptions),u=yield T(u0,"authorityFactoryCreateDiscoveredInstance",n.logger,n.performanceClient,n.correlationId)(l,n.config.system.networkClient,n.browserStorage,i,n.logger,n.correlationId,n.performanceClient);if(r&&!u.isAlias(r.environment))throw Ie(vh);return u})()}}function MI(t,e,n,r){return NI.apply(this,arguments)}function NI(){return(NI=y(function*(t,e,n,r){n.addQueueMeasurement("initializeBaseRequest",t.correlationId);const o=t.authority||e.auth.authority,i=[...t&&t.scopes||[]],s={...t,correlationId:t.correlationId,authority:o,scopes:i};if(s.authenticationScheme){if(s.authenticationScheme===de.SSH){if(!t.sshJwk)throw Ie(Os);if(!t.sshKid)throw Ie(gh)}r.verbose(`Authentication Scheme set to "${s.authenticationScheme}" as configured in Auth request`)}else s.authenticationScheme=de.BEARER,r.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return e.cache.claimsBasedCachingEnabled&&t.claims&&!Zt.isEmptyObj(t.claims)&&(s.requestedClaimsHash=yield PP(t.claims)),s})).apply(this,arguments)}function FY(t,e,n,r,o){return kI.apply(this,arguments)}function kI(){return(kI=y(function*(t,e,n,r,o){r.addQueueMeasurement("initializeSilentRequest",t.correlationId);const i=yield T(MI,"initializeBaseRequest",o,r,t.correlationId)(t,n,r,o);return{...t,...i,account:e,forceRefresh:t.forceRefresh||!1}})).apply(this,arguments)}function m0(t,e){let n;const r=t.httpMethod;if("EAR"===e){if(n=r||"POST","POST"!==n)throw Ie(Ch)}else n=r||"GET";if(t.authorizePostBodyParameters&&"POST"!==n)throw Ie(Eh);return n}class Ks extends g0{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const n={correlationId:this.correlationId||bn(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),n.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",n.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",n.correlationId),n.postLogoutRedirectUri=se.getAbsoluteUrl(e.postLogoutRedirectUri,vr())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",n.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",n.correlationId),n.postLogoutRedirectUri=se.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,vr())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",n.correlationId),n.postLogoutRedirectUri=se.getAbsoluteUrl(vr(),vr())),n}getLogoutHintFromIdTokenClaims(e){const n=e.idTokenClaims;if(n){if(n.login_hint)return n.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}createAuthCodeClient(e){var n=this;return y(function*(){n.performanceClient.addQueueMeasurement("standardInteractionClientCreateAuthCodeClient",n.correlationId);const r=yield T(n.getClientConfiguration.bind(n),"standardInteractionClientGetClientConfiguration",n.logger,n.performanceClient,n.correlationId)(e);return new f0(r,n.performanceClient)})()}getClientConfiguration(e){var n=this;return y(function*(){const{serverTelemetryManager:r,requestAuthority:o,requestAzureCloudOptions:i,requestExtraQueryParameters:s,account:a}=e;n.performanceClient.addQueueMeasurement("standardInteractionClientGetClientConfiguration",n.correlationId);const c=yield T(n.getDiscoveredAuthority.bind(n),"standardInteractionClientGetDiscoveredAuthority",n.logger,n.performanceClient,n.correlationId)({requestAuthority:o,requestAzureCloudOptions:i,requestExtraQueryParameters:s,account:a}),l=n.config.system.loggerOptions;return{authOptions:{clientId:n.config.auth.clientId,authority:c,clientCapabilities:n.config.auth.clientCapabilities,redirectUri:n.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:n.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:n.correlationId},cacheOptions:{claimsBasedCachingEnabled:n.config.cache.claimsBasedCachingEnabled},cryptoInterface:n.browserCrypto,networkInterface:n.networkClient,storageInterface:n.browserStorage,serverTelemetryManager:r,libraryInfo:{sku:"msal.js.browser",version:ii,cpu:w.EMPTY_STRING,os:w.EMPTY_STRING},telemetry:n.config.telemetry}})()}initializeAuthorizationRequest(e,n){var r=this;return y(function*(){r.performanceClient.addQueueMeasurement("standardInteractionClientInitializeAuthorizationRequest",r.correlationId);const o=r.getRedirectUri(e.redirectUri),s=Gs.setRequestState(r.browserCrypto,e&&e.state||w.EMPTY_STRING,{interactionType:n}),c={...yield T(MI,"initializeBaseRequest",r.logger,r.performanceClient,r.correlationId)({...e,correlationId:r.correlationId},r.config,r.performanceClient,r.logger),redirectUri:o,state:s,nonce:e.nonce||bn(),responseMode:r.config.auth.OIDCOptions.serverResponseType},l={...c,httpMethod:m0(c,r.config.auth.protocolMode)};if(e.loginHint||e.sid)return l;const u=e.account||r.browserStorage.getActiveAccount(r.correlationId);return u&&(r.logger.verbose("Setting validated request account",r.correlationId),r.logger.verbosePii(`Setting validated request account: ${u.homeAccountId}`,r.correlationId),l.account=u),l})()}}function El(t,e,n){const r=Ih(t);if(!r)throw KO(t)?(n.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),n.errorPii(`The ${e} detected is: ${t}`),M(Sh)):(n.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),M(wh));return r}function OI(t,e,n,r){const o=ol(e,n,r);return se.appendQueryString(t.authorizationEndpoint,o)}function y0(t,e){if(!t.state||!e)throw b(Kc,t.state?"Cached State":"Server State");let n,r;try{n=decodeURIComponent(t.state)}catch{throw b(no,t.state)}try{r=decodeURIComponent(e)}catch{throw b(no,t.state)}if(n!==r)throw b(Wf);if(t.error||t.error_description||t.suberror){const o=function jY(t){const e="code=",n=t.error_uri?.lastIndexOf(e);return n&&n>=0?t.error_uri?.substring(n+5):void 0}(t);throw r0(t.error,t.error_description,t.suberror)?new Mn(t.error||"",t.error_description,t.suberror,t.timestamp||"",t.trace_id||"",t.correlation_id||"",t.claims||"",o):new ai(t.error||"",t.error_description,t.suberror,o)}}class v0{constructor(e,n,r,o,i){this.authModule=e,this.browserStorage=n,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}handleCodeResponse(e,n){var r=this;return y(function*(){let o;r.performanceClient.addQueueMeasurement("handleCodeResponse",n.correlationId);try{o=function BY(t,e){if(y0(t,e),!t.code)throw b(rh);return t}(e,n.state)}catch(i){throw i instanceof ai&&i.subError===ni?M(ni):i}return T(r.handleCodeResponseFromServer.bind(r),"handleCodeResponseFromServer",r.logger,r.performanceClient,n.correlationId)(o,n)})()}handleCodeResponseFromServer(e,n){var r=this;return y(function*(o,i,s=!0){if(r.performanceClient.addQueueMeasurement("handleCodeResponseFromServer",i.correlationId),r.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),r.authCodeRequest.code=o.code,o.cloud_instance_host_name&&(yield T(r.authModule.updateAuthority.bind(r.authModule),"updateTokenEndpointAuthority",r.logger,r.performanceClient,i.correlationId)(o.cloud_instance_host_name,i.correlationId)),s&&(o.nonce=i.nonce||void 0),o.state=i.state,o.client_info)r.authCodeRequest.clientInfo=o.client_info;else{const c=r.createCcsCredentials(i);c&&(r.authCodeRequest.ccsCredential=c)}return yield T(r.authModule.acquireToken.bind(r.authModule),"authClientAcquireToken",r.logger,r.performanceClient,i.correlationId)(r.authCodeRequest,o)}).apply(this,arguments)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:"home_account_id"}:e.loginHint?{credential:e.loginHint,type:"UPN"}:null}}const C0="user_switch",ZY={[C0]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Zn extends me{constructor(e,n,r){super(e,n),Object.setPrototypeOf(this,Zn.prototype),this.name="NativeAuthError",this.ext=r}}function Ws(t){return!!(t.ext&&t.ext.status&&"DISABLED"===t.ext.status||t.ext&&t.ext.error&&-2147186943===t.ext.error)||"ContentError"===t.errorCode}function Ep(t,e,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return yp(gp);case"USER_INTERACTION_REQUIRED":return new Mn(t,e);case"USER_CANCEL":return M(ni);case"NO_NETWORK":return M(Hs);case"UX_NOT_ALLOWED":return yp(_I)}return new Zn(t,ZY[t]||e,n)}class XY extends AI{constructor(e,n){super(e,n)}acquireCachedToken(e){var n=this;return y(function*(){n.performanceClient?.addQueueMeasurement("silentFlowClientAcquireCachedToken",e.correlationId);let r="0";if(e.forceRefresh||!n.config.cacheOptions.claimsBasedCachingEnabled&&!Zt.isEmptyObj(e.claims))throw n.setCacheOutcome("1",e.correlationId),b(Qn);if(!e.account)throw b(Yc);const o=e.account.tenantId||function dY(t){const r=new se(t).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case"common":case"organizations":case"consumers":return;default:return r}}(e.authority),i=n.cacheManager.getTokenKeys(),s=n.cacheManager.getAccessToken(e.account,e,i,o);if(!s)throw n.setCacheOutcome("2",e.correlationId),b(Qn);if(function oY(t){return Number(t)>$t()}(s.cachedAt)||dp(s.expiresOn,n.config.systemOptions.tokenRenewalOffsetSeconds))throw n.setCacheOutcome("3",e.correlationId),b(Qn);s.refreshOn&&dp(s.refreshOn,0)&&(r="4");const a=e.authority||n.authority.getPreferredCache(),c={account:n.cacheManager.getAccount(n.cacheManager.generateAccountKey(e.account),e.correlationId),accessToken:s,idToken:n.cacheManager.getIdToken(e.account,e.correlationId,i,o,n.performanceClient),refreshToken:null,appMetadata:n.cacheManager.readAppMetadataFromCache(a)};return n.setCacheOutcome(r,e.correlationId),n.config.serverTelemetryManager&&n.config.serverTelemetryManager.incrementCacheHits(),[yield T(n.generateResultFromCacheRecord.bind(n),"silentFlowClientGenerateResultFromCacheRecord",n.logger,n.performanceClient,e.correlationId)(c,e),r]})()}setCacheOutcome(e,n){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},n),"0"!==e&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}generateResultFromCacheRecord(e,n){var r=this;return y(function*(){let o;if(r.performanceClient?.addQueueMeasurement("silentFlowClientGenerateResultFromCacheRecord",n.correlationId),e.idToken&&(o=Ps(e.idToken.secret,r.config.cryptoInterface.base64Decode)),n.maxAge||0===n.maxAge){const i=o?.auth_time;if(!i)throw b(Wc);GO(i,n.maxAge)}return ci.generateAuthenticationResult(r.cryptoUtils,r.authority,e,!0,n,o)})()}}class E0 extends Ks{acquireToken(e){var n=this;return y(function*(){n.performanceClient.addQueueMeasurement("silentCacheClientAcquireToken",e.correlationId);const r=n.initializeServerTelemetryManager(61),o=yield T(n.getClientConfiguration.bind(n),"standardInteractionClientGetClientConfiguration",n.logger,n.performanceClient,n.correlationId)({serverTelemetryManager:r,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),i=new XY(o,n.performanceClient);n.logger.verbose("Silent auth client created");try{const a=(yield T(i.acquireCachedToken.bind(i),"silentFlowClientAcquireCachedToken",n.logger,n.performanceClient,e.correlationId)(e))[0];return n.performanceClient.addFields({fromCache:!0},e.correlationId),a}catch(s){throw s instanceof fl&&s.errorCode===ll&&n.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),s}})()}logout(e){this.logger.verbose("logoutRedirect called");const n=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(n.correlationId,n?.account)}}class Ip extends g0{constructor(e,n,r,o,i,s,a,c,l,u,d,f){super(e,n,r,o,i,s,c,l,f),this.apiId=a,this.accountId=u,this.platformAuthProvider=l,this.nativeStorageManager=d,this.silentCacheClient=new E0(e,this.nativeStorageManager,r,o,i,s,c,l,f);const h=this.platformAuthProvider.getExtensionName();this.skus=Cl.makeExtraSkuString({libraryName:"msal.js.browser",libraryVersion:ii,extensionName:h,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[aQ]:this.skus}}acquireToken(e,n){var r=this;return y(function*(){r.performanceClient.addQueueMeasurement("nativeInteractionClientAcquireToken",r.correlationId),r.logger.trace("NativeInteractionClient - acquireToken called.");const o=r.performanceClient.startMeasurement("nativeInteractionClientAcquireToken",r.correlationId),i=$t(),s=r.initializeServerTelemetryManager(r.apiId);try{const a=yield r.initializeNativeRequest(e);try{const l=yield r.acquireTokensFromCache(r.accountId,a);return o.end({success:!0,isNativeBroker:!1,fromCache:!0}),l}catch(l){if(1===n)throw r.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),o.end({success:!1,brokerErrorCode:"cache_request_failed"}),l;r.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const c=yield r.platformAuthProvider.sendMessage(a);return yield r.handleNativeResponse(c,a,i).then(l=>(o.end({success:!0,isNativeBroker:!0,requestId:l.requestId}),s.clearNativeBrokerErrorCode(),l)).catch(l=>{throw o.end({success:!1,errorCode:l.errorCode,subErrorCode:l.subError}),l})}catch(a){throw a instanceof Zn&&s.setNativeBrokerErrorCode(a.errorCode),o.end({success:!1}),a}})()}createSilentCacheRequest(e,n){return{authority:e.authority,correlationId:this.correlationId,scopes:Xe.fromString(e.scope).asArray(),account:n,forceRefresh:!1}}acquireTokensFromCache(e,n){var r=this;return y(function*(){if(!e)throw r.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),b(Zc);const o=r.browserStorage.getBaseAccountInfo({nativeAccountId:e},r.correlationId);if(!o)throw b(Zc);try{const i=r.createSilentCacheRequest(n,o),s=yield r.silentCacheClient.acquireToken(i),a={...o,idTokenClaims:s?.idTokenClaims,idToken:s?.idToken};return{...s,account:a}}catch(i){throw i}})()}acquireTokenRedirect(e,n){var r=this;return y(function*(){r.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...o}=e;delete o.onRedirectNavigate;const i=yield r.initializeNativeRequest(o);try{yield r.platformAuthProvider.sendMessage(i)}catch(c){if(c instanceof Zn&&(r.initializeServerTelemetryManager(r.apiId).setNativeBrokerErrorCode(c.errorCode),Ws(c)))throw c}r.browserStorage.setTemporaryCache("request.native",JSON.stringify(i),!0);const s={apiId:861,timeout:r.config.system.redirectNavigationTimeout,noHistory:!1},a=r.config.auth.navigateToLoginRequestUrl?window.location.href:r.getRedirectUri(e.redirectUri);n.end({success:!0}),yield r.navigationClient.navigateExternal(a,s)})()}handleRedirectPromise(e,n){var r=this;return y(function*(){if(r.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!r.browserStorage.isInteractionInProgress(!0))return r.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const o=r.browserStorage.getCachedNativeRequest();if(!o)return r.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&n&&e?.addFields({errorCode:"no_cached_request"},n),null;const{prompt:i,...s}=o;i&&r.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),r.browserStorage.removeItem(r.browserStorage.generateCacheKey("request.native"));const a=$t();try{r.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const c=yield r.platformAuthProvider.sendMessage(s),l=yield r.handleNativeResponse(c,s,a);return r.initializeServerTelemetryManager(r.apiId).clearNativeBrokerErrorCode(),e&&r.correlationId&&r.performanceClient.addFields({isNativeBroker:!0},r.correlationId),l}catch(c){throw c}})()}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}handleNativeResponse(e,n,r){var o=this;return y(function*(){o.logger.trace("NativeInteractionClient - handleNativeResponse called.");const i=Ps(e.id_token,An),s=o.createHomeAccountIdentifier(e,i),a=o.browserStorage.getAccountInfoFilteredBy({nativeAccountId:n.accountId},o.correlationId)?.homeAccountId;if(n.extraParameters?.child_client_id&&e.account.id!==n.accountId)o.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(s!==a&&e.account.id!==n.accountId)throw Ep(C0);const c=yield o.getDiscoveredAuthority({requestAuthority:n.authority}),l=bI(o.browserStorage,c,s,An,o.correlationId,i,e.client_info,void 0,i.tid,void 0,e.account.id,o.logger);e.expires_in=Number(e.expires_in);const u=yield o.generateAuthenticationResult(e,n,i,l,c.canonicalAuthority,r);return yield o.cacheAccount(l,o.correlationId),yield o.cacheNativeTokens(e,n,s,i,e.access_token,u.tenantId,r),u})()}createHomeAccountIdentifier(e,n){return Nn.generateHomeAccountId(e.client_info||w.EMPTY_STRING,0,this.logger,this.browserCrypto,n)}generateScopes(e,n){return Xe.fromString(n||e)}generatePopAccessToken(e,n){var r=this;return y(function*(){if(n.tokenType===de.POP&&n.signPopToken){if(e.shr)return r.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const o=new qs(r.browserCrypto),i={resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,shrNonce:n.shrNonce};if(!n.keyId)throw b(el);return o.signPopToken(e.access_token,n.keyId,i)}return e.access_token})()}generateAuthenticationResult(e,n,r,o,i,s){var a=this;return y(function*(){const c=a.addTelemetryFromNativeResponse(e.properties.MATS),l=a.generateScopes(n.scope,e.scope),u=e.account.properties||{},d=u.UID||r.oid||r.sub||w.EMPTY_STRING,f=u.TenantId||r.tid||w.EMPTY_STRING,h=yE(o.getAccountInfo(),void 0,r,e.id_token);h.nativeAccountId!==e.account.id&&(h.nativeAccountId=e.account.id);const p=yield a.generatePopAccessToken(e,n),m=n.tokenType===de.POP?de.POP:de.BEARER;return{authority:i,uniqueId:d,tenantId:f,scopes:l.asArray(),account:h,idToken:e.id_token,idTokenClaims:r,accessToken:p,fromCache:!!c&&a.isResponseFromCache(c),expiresOn:js(s+e.expires_in),tokenType:m,correlationId:a.correlationId,state:e.state,fromNativeBroker:!0}})()}cacheAccount(e,n){var r=this;return y(function*(){yield r.browserStorage.setAccount(e,r.correlationId),r.browserStorage.removeAccountContext(e.getAccountInfo(),n)})()}cacheNativeTokens(e,n,r,o,i,s,a){const c=fp(r,n.authority,e.id_token||"",n.clientId,o.tid||""),u=a+(n.tokenType===de.POP?w.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),d=this.generateScopes(e.scope,n.scope),f=hp(r,n.authority,i,n.clientId,o.tid||s,d.printScopes(),u,0,An,void 0,n.tokenType,void 0,n.keyId);return this.nativeStorageManager.saveCacheRecord({idToken:c,accessToken:f},this.correlationId,n.storeInCache)}getExpiresInValue(e,n){return e===de.POP?w.SHR_NONCE_VALIDITY:("string"==typeof n?parseInt(n,10):n)||0}addTelemetryFromNativeResponse(e){const n=this.getMATSFromResponse(e);return n?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:n.broker_version,matsAccountJoinOnStart:n.account_join_on_start,matsAccountJoinOnEnd:n.account_join_on_end,matsDeviceJoin:n.device_join,matsPromptBehavior:n.prompt_behavior,matsApiErrorCode:n.api_error_code,matsUiVisible:n.ui_visible,matsSilentCode:n.silent_code,matsSilentBiSubCode:n.silent_bi_sub_code,matsSilentMessage:n.silent_message,matsSilentStatus:n.silent_status,matsHttpStatus:n.http_status,matsHttpEventCount:n.http_event_count},this.correlationId),n):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}initializeNativeRequest(e){var n=this;return y(function*(){n.logger.trace("NativeInteractionClient - initializeNativeRequest called");const r=yield n.getCanonicalAuthority(e),{scopes:o,...i}=e,s=new Xe(o||[]);s.appendScopes(Ms);const a={...i,accountId:n.accountId,clientId:n.config.auth.clientId,authority:r.urlString,scope:s.printScopes(),redirectUri:n.getRedirectUri(e.redirectUri),prompt:n.getPrompt(e.prompt),correlationId:n.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(a.signPopToken&&e.popKid)throw M(Qh);if(n.handleExtraBrokerParams(a),a.extraParameters=a.extraParameters||{},a.extraParameters.telemetry="MATS",e.authenticationScheme===de.POP){const c={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},l=new qs(n.browserCrypto);let u;if(a.keyId)u=n.browserCrypto.base64UrlEncode(JSON.stringify({kid:a.keyId})),a.signPopToken=!1;else{const d=yield T(l.generateCnf.bind(l),"popTokenGenerateCnf",n.logger,n.performanceClient,n.correlationId)(c,n.logger);u=d.reqCnfString,a.keyId=d.kid,a.signPopToken=!0}a.reqCnf=u}return n.addRequestSKUs(a),a})()}getCanonicalAuthority(e){var n=this;return y(function*(){const r=e.authority||n.config.auth.authority;e.account&&(yield n.getDiscoveredAuthority({requestAuthority:r,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}));const o=new se(r);return o.validateAsUri(),o})()}getPrompt(e){switch(this.apiId){case 863:case 61:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),"none"}if(e)switch(e){case"none":case"consent":case"login":return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e} is not compatible with native flow`),M(Kh)}else this.logger.trace("initializeNativeRequest: prompt was not provided")}handleExtraBrokerParams(e){const n=e.extraParameters&&e.extraParameters.hasOwnProperty(ep)&&e.extraParameters.hasOwnProperty(tp)&&e.extraParameters.hasOwnProperty(oi);if(!e.embeddedClientId&&!n)return;let r="";const o=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[tp],r=e.extraParameters[oi]),e.extraParameters={child_client_id:r,child_redirect_uri:o},this.performanceClient?.addFields({embeddedClientId:r,embeddedRedirectUri:o},this.correlationId)}}function PI(t,e,n,r,o){return xI.apply(this,arguments)}function xI(){return(xI=y(function*(t,e,n,r,o){const i=function HY(t,e,n,r){const o=e.correlationId,i=new Map;if(kE(i,e.embeddedClientId||e.extraQueryParameters?.[oi]||t.clientId),NE(i,[...e.scopes||[],...e.extraScopesToConsent||[]],!0,t.authority.options.OIDCOptions?.defaultScopes),OE(i,e.redirectUri),xE(i,o),function uQ(t,e){t.set("response_mode",e||"query")}(i,e.responseMode),UE(i),e.prompt&&(function gQ(t,e){t.set("prompt",e)}(i,e.prompt),r?.addFields({prompt:e.prompt},o)),e.domainHint&&(function pQ(t,e){t.set("domain_hint",e)}(i,e.domainHint),r?.addFields({domainHintFromRequest:!0},o)),"select_account"!==e.prompt)if(e.sid&&"none"===e.prompt)n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),fP(i,e.sid),r?.addFields({sidFromRequest:!0},o);else if(e.account){const a=function VY(t){return t.idTokenClaims?.sid||null}(e.account);let c=function $Y(t){return t.loginHint||t.idTokenClaims?.login_hint||null}(e.account);if(c&&e.domainHint&&(n.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),c=null),c){n.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),rp(i,c),r?.addFields({loginHintFromClaim:!0},o);try{pl(i,zs(e.account.homeAccountId))}catch{n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&"none"===e.prompt){n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),fP(i,a),r?.addFields({sidFromClaim:!0},o);try{pl(i,zs(e.account.homeAccountId))}catch{n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)n.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),rp(i,e.loginHint),op(i,e.loginHint),r?.addFields({loginHintFromRequest:!0},o);else if(e.account.username){n.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),rp(i,e.account.username),r?.addFields({loginHintFromUpn:!0},o);try{pl(i,zs(e.account.homeAccountId))}catch{n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(n.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),rp(i,e.loginHint),op(i,e.loginHint),r?.addFields({loginHintFromRequest:!0},o));else n.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&function mQ(t,e){t.set("nonce",e)}(i,e.nonce),e.state&&hP(i,e.state),(e.claims||t.clientCapabilities&&t.clientCapabilities.length>0)&&PE(i,e.claims,t.clientCapabilities),e.embeddedClientId&&ip(i,t.clientId,t.redirectUri),t.instanceAware&&(!e.extraQueryParameters||!Object.keys(e.extraQueryParameters).includes(RE))&&CP(i),i}({...t.auth,authority:e},n,r,o);if(FE(i,{sku:"msal.js.browser",version:ii,os:"",cpu:""}),"OIDC"!==t.auth.protocolMode&&LE(i,t.telemetry.application),n.platformBroker&&(function dQ(t){t.set("nativebroker","1")}(i),o.addFields({isPlatformAuthorizeRequest:!0},n.correlationId),n.authenticationScheme===de.POP)){const s=new up(r,o),a=new qs(s);let c;c=n.popKid?s.encodeKid(n.popKid):(yield T(a.generateCnf.bind(a),"popTokenGenerateCnf",r,o,n.correlationId)(n,r)).reqCnfString,HE(i,c)}return np(i,n.correlationId,o),i})).apply(this,arguments)}function FI(t,e,n,r,o){return LI.apply(this,arguments)}function LI(){return(LI=y(function*(t,e,n,r,o){if(!n.codeChallenge)throw Ie(nl);const i=yield T(PI,"getStandardParams",r,o,n.correlationId)(t,e,n,r,o);return ME(i,"code"),pP(i,n.codeChallenge,w.S256_CODE_CHALLENGE_METHOD),oo(i,n.extraQueryParameters||{}),OI(e,i,t.auth.encodeExtraQueryParams,n.extraQueryParameters)})).apply(this,arguments)}function UI(t,e,n,r,o,i){return HI.apply(this,arguments)}function HI(){return(HI=y(function*(t,e,n,r,o,i){if(!r.earJwk)throw M(TE);const s=yield PI(e,n,r,o,i);ME(s,"id_token token refresh_token"),function IQ(t,e){t.set("ear_jwk",encodeURIComponent(e)),t.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(s,r.earJwk);const a=new Map;return oo(a,r.extraQueryParameters||{}),I0(t,OI(n,a,e.auth.encodeExtraQueryParams,r.extraQueryParameters),s)})).apply(this,arguments)}function BI(t,e,n,r,o,i){return jI.apply(this,arguments)}function jI(){return(jI=y(function*(t,e,n,r,o,i){const s=yield PI(e,n,r,o,i);ME(s,"code"),pP(s,r.codeChallenge,r.codeChallengeMethod||w.S256_CODE_CHALLENGE_METHOD),function _Q(t,e){Object.entries(e).forEach(([n,r])=>{r&&t.set(n,r)})}(s,r.authorizePostBodyParameters||{});const a=new Map;return oo(a,r.extraQueryParameters||{}),I0(t,OI(n,a,e.auth.encodeExtraQueryParams,r.extraQueryParameters),s)})).apply(this,arguments)}function I0(t,e,n){const r=t.createElement("form");return r.method="post",r.action=e,n.forEach((o,i)=>{const s=t.createElement("input");s.hidden=!0,s.name=i,s.value=o,r.appendChild(s)}),t.body.appendChild(r),r}function _0(t,e,n,r,o,i,s,a,c,l){return VI.apply(this,arguments)}function VI(){return(VI=y(function*(t,e,n,r,o,i,s,a,c,l){if(a.verbose("Account id found, calling WAM for token"),!l)throw M(dl);const u=new up(a,c),d=new Ip(r,o,u,a,s,r.system.navigationClient,n,c,l,e,i,t.correlationId),{userRequestState:f}=Gs.parseRequestState(u,t.state);return T(d.acquireToken.bind(d),"nativeInteractionClientAcquireToken",a,c,t.correlationId)({...t,state:f,prompt:void 0})})).apply(this,arguments)}function _p(t,e,n,r,o,i,s,a,c,l,u,d){return $I.apply(this,arguments)}function $I(){return($I=y(function*(t,e,n,r,o,i,s,a,c,l,u,d){if(Jn.removeThrottle(s,o.auth.clientId,t),e.accountId)return T(_0,"handleResponsePlatformBroker",l,u,t.correlationId)(t,e.accountId,r,o,s,a,c,l,u,d);const f={...t,code:e.code||"",codeVerifier:n},h=new v0(i,s,f,l,u);return yield T(h.handleCodeResponse.bind(h),"handleCodeResponse",l,u,t.correlationId)(e,t)})).apply(this,arguments)}function zI(t,e,n,r,o,i,s,a,c,l,u){return GI.apply(this,arguments)}function GI(){return(GI=y(function*(t,e,n,r,o,i,s,a,c,l,u){if(Jn.removeThrottle(i,r.auth.clientId,t),y0(e,t.state),!e.ear_jwe)throw M(rP);if(!t.earJwk)throw M(TE);const d=JSON.parse(yield T(PQ,"decryptEarResponse",c,l,t.correlationId)(t.earJwk,e.ear_jwe));if(d.accountId)return T(_0,"handleResponsePlatformBroker",c,l,t.correlationId)(t,d.accountId,n,r,i,s,a,c,l,u);const f=new ci(r.auth.clientId,i,new up(c,l),c,null,null,l);f.validateTokenResponse(d);const h={code:"",state:t.state,nonce:t.nonce,client_info:d.client_info,cloud_graph_host_name:d.cloud_graph_host_name,cloud_instance_host_name:d.cloud_instance_host_name,cloud_instance_name:d.cloud_instance_name,msgraph_host:d.msgraph_host};return yield T(f.handleServerTokenResponse.bind(f),"handleServerTokenResponse",c,l,t.correlationId)(d,o,$t(),t,h,void 0,void 0,void 0,void 0)})).apply(this,arguments)}function Tp(t,e,n){return qI.apply(this,arguments)}function qI(){return(qI=y(function*(t,e,n){t.addQueueMeasurement("generatePkceCodes",n);const r=Xt(t9,"generateCodeVerifier",e,t,n)(t,e,n);return{verifier:r,challenge:yield T(n9,"generateCodeChallengeFromVerifier",e,t,n)(r,t,e,n)}})).apply(this,arguments)}function t9(t,e,n){try{const r=new Uint8Array(32);return Xt(RQ,"getRandomValues",e,t,n)(r),io(r)}catch{throw M(il)}}function n9(t,e,n,r){return KI.apply(this,arguments)}function KI(){return(KI=y(function*(t,e,n,r){e.addQueueMeasurement("generateCodeChallengeFromVerifier",r);try{const o=yield T(RP,"sha256Digest",n,e,r)(t,e,r);return io(new Uint8Array(o))}catch{throw M(il)}})).apply(this,arguments)}class wp{constructor(e,n,r,o){this.logger=e,this.handshakeTimeoutMs=n,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement("nativeMessageHandlerHandshake"),this.platformAuthType="PlatformAuthExtensionHandler"}sendMessage(e){var n=this;return y(function*(){n.logger.trace(n.platformAuthType+" - sendMessage called.");const r={method:"GetToken",request:e},o={channel:hn_CHANNEL_ID,extensionId:n.extensionId,responseId:bn(),body:r};n.logger.trace(n.platformAuthType+" - Sending request to browser extension"),n.logger.tracePii(n.platformAuthType+` - Sending request to browser extension: ${JSON.stringify(o)}`),n.messageChannel.port1.postMessage(o);const i=yield new Promise((a,c)=>{n.resolvers.set(o.responseId,{resolve:a,reject:c})});return n.validatePlatformBrokerResponse(i)})()}static createProvider(e,n,r){return y(function*(){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{const o=new wp(e,n,r,"ppnbnpeolgkicgegkbkbjmhlideopiji");return yield o.sendHandshakeRequest(),o}catch{const i=new wp(e,n,r);return yield i.sendHandshakeRequest(),i}})()}sendHandshakeRequest(){var e=this;return y(function*(){e.logger.trace(e.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",e.windowListener,!1);const n={channel:hn_CHANNEL_ID,extensionId:e.extensionId,responseId:bn(),body:{method:"Handshake"}};return e.handshakeEvent.add({extensionId:e.extensionId,extensionHandshakeTimeoutMs:e.handshakeTimeoutMs}),e.messageChannel.port1.onmessage=r=>{e.onChannelMessage(r)},window.postMessage(n,window.origin,[e.messageChannel.port2]),new Promise((r,o)=>{e.handshakeResolvers.set(n.responseId,{resolve:r,reject:o}),e.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",e.windowListener,!1),e.messageChannel.port1.close(),e.messageChannel.port2.close(),e.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),o(M(Gh)),e.handshakeResolvers.delete(n.responseId)},e.handshakeTimeoutMs)})})()}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source!==window)return;const n=e.data;if(n.channel&&n.channel===hn_CHANNEL_ID&&(!n.extensionId||n.extensionId===this.extensionId)&&"Handshake"===n.body.method){const r=this.handshakeResolvers.get(n.responseId);if(!r)return void this.logger.trace(this.platformAuthType+`.onWindowMessage - resolver can't be found for request ${n.responseId}`);this.logger.verbose(n.extensionId?`Extension with id: ${n.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),r.reject(M(qh))}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const n=e.data,r=this.resolvers.get(n.responseId),o=this.handshakeResolvers.get(n.responseId);try{const i=n.body.method;if("Response"===i){if(!r)return;const s=n.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+` - Received response from browser extension: ${JSON.stringify(s)}`),"Success"!==s.status)r.reject(Ep(s.code,s.description,s.ext));else{if(!s.result)throw QC(ks,"Event does not contain result.");s.result.code&&s.result.description?r.reject(Ep(s.result.code,s.result.description,s.result.ext)):r.resolve(s.result)}this.resolvers.delete(n.responseId)}else if("HandshakeResponse"===i){if(!o)return void this.logger.trace(this.platformAuthType+`.onChannelMessage - resolver can't be found for request ${n.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=n.extensionId,this.extensionVersion=n.body.version,this.logger.verbose(this.platformAuthType+` - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),o.resolve(),this.handshakeResolvers.delete(n.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(i):o&&o.reject(i)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw QC(ks,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){return"ppnbnpeolgkicgegkbkbjmhlideopiji"===this.getExtensionId()?"chrome":this.getExtensionId()?.length?"unknown":void 0}}class WI{constructor(e,n,r){this.logger=e,this.performanceClient=n,this.correlationId=r,this.platformAuthType="PlatformAuthDOMHandler"}static createProvider(e,n,r){return y(function*(){if(e.trace("PlatformAuthDOMHandler: createProvider called"),window.navigator?.platformAuthentication&&(yield window.navigator.platformAuthentication.getSupportedContracts("MicrosoftEntra"))?.includes("get-token-and-sign-out"))return e.trace("Platform auth api available in DOM"),new WI(e,n,r)})()}getExtensionId(){return"MicrosoftEntra"}getExtensionVersion(){return""}getExtensionName(){return"DOM API"}sendMessage(e){var n=this;return y(function*(){n.logger.trace(n.platformAuthType+" - Sending request to browser DOM API");try{const r=n.initializePlatformDOMRequest(e),o=yield window.navigator.platformAuthentication.executeGetToken(r);return n.validatePlatformBrokerResponse(o)}catch(r){throw n.logger.error(n.platformAuthType+" - executeGetToken DOM API error"),r}})()}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:n,clientId:r,authority:o,scope:i,redirectUri:s,correlationId:a,state:c,storeInCache:l,embeddedClientId:u,extraParameters:d,...f}=e,h=this.getDOMExtraParams(f);return{accountId:n,brokerId:this.getExtensionId(),authority:o,clientId:r,correlationId:a||this.correlationId,extraParameters:{...d,...h},isSecurityTokenService:!1,redirectUri:s,scope:i,state:c,storeInCache:l,embeddedClientId:u}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){const n=e;if(!1===n.isSuccess&&n.error&&n.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),Ep(n.error.code,n.error.description,{error:parseInt(n.error.errorCode),protocol_error:n.error.protocolError,status:n.error.status,properties:n.error.properties})}}throw QC(ks,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){return this.logger.trace(this.platformAuthType+" - convertToNativeResponse called"),{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:e.extendedLifetimeToken??!1,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return{...Object.entries(e).reduce((o,[i,s])=>(o[i]=String(s),o),{})}}}function YI(){return(YI=y(function*(t,e,n,r){t.trace("getPlatformAuthProvider called",n);const o=function r9(){let t;try{return t=window.sessionStorage,"true"===t?.getItem(QQ)}catch{return!1}}();let i;t.trace("Has client allowed platform auth via DOM API: "+o);try{o&&(i=yield WI.createProvider(t,e,n)),i||(t.trace("Platform auth via DOM API not available, checking for extension"),i=yield wp.createProvider(t,r||2e3,e))}catch(s){t.trace("Platform auth not available",s)}return i})).apply(this,arguments)}function Il(t,e,n,r){if(e.trace("isPlatformAuthAllowed called"),!t.system.allowPlatformBroker)return e.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!n)return e.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(r)switch(r){case de.BEARER:case de.POP:return e.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return e.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}class o9 extends Ks{constructor(e,n,r,o,i,s,a,c,l,u){super(e,n,r,o,i,s,a,l,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=c,this.eventHandler=i}acquireToken(e,n){let r;try{if(r={popupName:this.generatePopupName(e.scopes||Ms,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window},this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r,n);{const i={...e,httpMethod:m0(e,this.config.auth.protocolMode)};return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(i,r,n)}}catch(o){return Promise.reject(o)}}logout(e){try{this.logger.verbose("logoutPopup called");const n=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(n),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},o=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(n,r,o,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(n,r,o,i))}catch(n){return Promise.reject(n)}}acquireTokenPopupAsync(e,n,r){var o=this;return y(function*(){o.logger.verbose("acquireTokenPopupAsync called");const i=yield T(o.initializeAuthorizationRequest.bind(o),"standardInteractionClientInitializeAuthorizationRequest",o.logger,o.performanceClient,o.correlationId)(e,U.Popup);n.popup&&HP(i.authority);const s=Il(o.config,o.logger,o.platformAuthProvider,e.authenticationScheme);return i.platformBroker=s,"EAR"===o.config.auth.protocolMode?o.executeEarFlow(i,n):o.executeCodeFlow(i,n,r)})()}executeCodeFlow(e,n,r){var o=this;return y(function*(){const i=e.correlationId,s=o.initializeServerTelemetryManager(862),a=r||(yield T(Tp,"generatePkceCodes",o.logger,o.performanceClient,i)(o.performanceClient,o.logger,i)),c={...e,codeChallenge:a.challenge};try{const l=yield T(o.createAuthCodeClient.bind(o),"standardInteractionClientCreateAuthCodeClient",o.logger,o.performanceClient,i)({serverTelemetryManager:s,requestAuthority:c.authority,requestAzureCloudOptions:c.azureCloudOptions,requestExtraQueryParameters:c.extraQueryParameters,account:c.account});if("POST"===c.httpMethod)return yield o.executeCodeFlowWithPost(c,n,l,a.verifier);{const u=yield T(FI,"getAuthCodeUrl",o.logger,o.performanceClient,i)(o.config,l.authority,c,o.logger,o.performanceClient),d=o.initiateAuthRequest(u,n);o.eventHandler.emitEvent("msal:popupOpened",U.Popup,{popupWindow:d},null);const f=yield o.monitorPopupForHash(d,n.popupWindowParent),h=Xt(El,"deserializeResponse",o.logger,o.performanceClient,o.correlationId)(f,o.config.auth.OIDCOptions.serverResponseType,o.logger);return yield T(_p,"handleResponseCode",o.logger,o.performanceClient,i)(e,h,a.verifier,862,o.config,l,o.browserStorage,o.nativeStorage,o.eventHandler,o.logger,o.performanceClient,o.platformAuthProvider)}}catch(l){throw n.popup?.close(),l instanceof me&&(l.setCorrelationId(o.correlationId),s.cacheFailedRequest(l)),l}})()}executeEarFlow(e,n){var r=this;return y(function*(){const o=e.correlationId,i=yield T(r.getDiscoveredAuthority.bind(r),"standardInteractionClientGetDiscoveredAuthority",r.logger,r.performanceClient,o)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),s=yield T(JE,"generateEarKey",r.logger,r.performanceClient,o)(),a={...e,earJwk:s},c=n.popup||r.openPopup("about:blank",n);(yield UI(c.document,r.config,i,a,r.logger,r.performanceClient)).submit();const u=yield T(r.monitorPopupForHash.bind(r),"silentHandlerMonitorIframeForHash",r.logger,r.performanceClient,o)(c,n.popupWindowParent),d=Xt(El,"deserializeResponse",r.logger,r.performanceClient,r.correlationId)(u,r.config.auth.OIDCOptions.serverResponseType,r.logger);return T(zI,"handleResponseEar",r.logger,r.performanceClient,o)(a,d,862,r.config,i,r.browserStorage,r.nativeStorage,r.eventHandler,r.logger,r.performanceClient,r.platformAuthProvider)})()}executeCodeFlowWithPost(e,n,r,o){var i=this;return y(function*(){const s=e.correlationId,a=yield T(i.getDiscoveredAuthority.bind(i),"standardInteractionClientGetDiscoveredAuthority",i.logger,i.performanceClient,s)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),c=n.popup||i.openPopup("about:blank",n);(yield BI(c.document,i.config,a,e,i.logger,i.performanceClient)).submit();const u=yield T(i.monitorPopupForHash.bind(i),"silentHandlerMonitorIframeForHash",i.logger,i.performanceClient,s)(c,n.popupWindowParent),d=Xt(El,"deserializeResponse",i.logger,i.performanceClient,i.correlationId)(u,i.config.auth.OIDCOptions.serverResponseType,i.logger);return T(_p,"handleResponseCode",i.logger,i.performanceClient,s)(e,d,o,862,i.config,r,i.browserStorage,i.nativeStorage,i.eventHandler,i.logger,i.performanceClient,i.platformAuthProvider)})()}logoutPopupAsync(e,n,r,o){var i=this;return y(function*(){i.logger.verbose("logoutPopupAsync called"),i.eventHandler.emitEvent("msal:logoutStart",U.Popup,e);const s=i.initializeServerTelemetryManager(962);try{yield i.clearCacheOnLogout(i.correlationId,e.account);const c=(yield T(i.createAuthCodeClient.bind(i),"standardInteractionClientCreateAuthCodeClient",i.logger,i.performanceClient,i.correlationId)({serverTelemetryManager:s,requestAuthority:r,account:e.account||void 0})).getLogoutUri(e);i.eventHandler.emitEvent("msal:logoutSuccess",U.Popup,e);const l=i.openPopup(c,n);if(i.eventHandler.emitEvent("msal:popupOpened",U.Popup,{popupWindow:l},null),yield i.monitorPopupForHash(l,n.popupWindowParent).catch(()=>{}),o){const u={apiId:962,timeout:i.config.system.redirectNavigationTimeout,noHistory:!1},d=se.getAbsoluteUrl(o,vr());i.logger.verbose("Redirecting main window to url specified in the request"),i.logger.verbosePii(`Redirecting main window to: ${d}`),yield i.navigationClient.navigateInternal(d,u)}else i.logger.verbose("No main window navigation requested")}catch(a){throw n.popup?.close(),a instanceof me&&(a.setCorrelationId(i.correlationId),s.cacheFailedRequest(a)),i.eventHandler.emitEvent("msal:logoutFailure",U.Popup,null,a),i.eventHandler.emitEvent("msal:logoutEnd",U.Popup),a}i.eventHandler.emitEvent("msal:logoutEnd",U.Popup)})()}initiateAuthRequest(e,n){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,n);throw this.logger.error("Navigate url is empty"),M(Fs)}monitorPopupForHash(e,n){return new Promise((r,o)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const i=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(i),void o(M(ni));let s="";try{s=e.location.href}catch{}if(!s||"about:blank"===s)return;clearInterval(i);let a="";e&&(a="query"===this.config.auth.OIDCOptions.serverResponseType?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),r(a)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,n)})}openPopup(e,n){try{let r;if(n.popup?(r=n.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):typeof n.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,n)),!r)throw M(Mh);return r.focus&&r.focus(),this.currentWindow=r,n.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(r){throw this.logger.error("error opening popup "+r.message),M(Rh)}}openSizedPopup(e,{popupName:n,popupWindowAttributes:r,popupWindowParent:o}){const i=o.screenLeft?o.screenLeft:o.screenX,s=o.screenTop?o.screenTop:o.screenY,a=o.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=o.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let l=r.popupSize?.width,u=r.popupSize?.height,d=r.popupPosition?.top,f=r.popupPosition?.left;return(!l||l<0||l>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),l=483),(!u||u<0||u>c)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),u=600),(!d||d<0||d>c)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),d=Math.max(0,c/2-300+s)),(!f||f<0||f>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),f=Math.max(0,a/2-241.5+i)),o.open(e,n,`width=${l}, height=${u}, top=${d}, left=${f}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,n){e.close(),n.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,n){return`msal.${this.config.auth.clientId}.${e.join("-")}.${n}.${this.correlationId}`}generateLogoutPopupName(e){return`msal.${this.config.auth.clientId}.${e.account&&e.account.homeAccountId}.${this.correlationId}`}}class s9 extends Ks{constructor(e,n,r,o,i,s,a,c,l,u){super(e,n,r,o,i,s,a,l,u),this.nativeStorage=c}acquireToken(e){var n=this;return y(function*(){const r=yield T(n.initializeAuthorizationRequest.bind(n),"standardInteractionClientInitializeAuthorizationRequest",n.logger,n.performanceClient,n.correlationId)(e,U.Redirect);r.platformBroker=Il(n.config,n.logger,n.platformAuthProvider,e.authenticationScheme);const o=s=>{s.persisted&&(n.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),n.browserStorage.resetRequestCache(),n.eventHandler.emitEvent("msal:restoreFromBFCache",U.Redirect))},i=n.getRedirectStartPage(e.redirectStartPage);n.logger.verbosePii(`Redirect start page: ${i}`),n.browserStorage.setTemporaryCache("request.origin",i,!0),window.addEventListener("pageshow",o);try{"EAR"===n.config.auth.protocolMode?yield n.executeEarFlow(r):yield n.executeCodeFlow(r,e.onRedirectNavigate)}catch(s){throw s instanceof me&&s.setCorrelationId(n.correlationId),window.removeEventListener("pageshow",o),s}})()}executeCodeFlow(e,n){var r=this;return y(function*(){const o=e.correlationId,i=r.initializeServerTelemetryManager(861),s=yield T(Tp,"generatePkceCodes",r.logger,r.performanceClient,o)(r.performanceClient,r.logger,o),a={...e,codeChallenge:s.challenge};r.browserStorage.cacheAuthorizeRequest(a,s.verifier);try{if("POST"===a.httpMethod)return yield r.executeCodeFlowWithPost(a);{const c=yield T(r.createAuthCodeClient.bind(r),"standardInteractionClientCreateAuthCodeClient",r.logger,r.performanceClient,r.correlationId)({serverTelemetryManager:i,requestAuthority:a.authority,requestAzureCloudOptions:a.azureCloudOptions,requestExtraQueryParameters:a.extraQueryParameters,account:a.account}),l=yield T(FI,"getAuthCodeUrl",r.logger,r.performanceClient,e.correlationId)(r.config,c.authority,a,r.logger,r.performanceClient);return yield r.initiateAuthRequest(l,n)}}catch(c){throw c instanceof me&&(c.setCorrelationId(r.correlationId),i.cacheFailedRequest(c)),c}})()}executeEarFlow(e){var n=this;return y(function*(){const r=e.correlationId,o=yield T(n.getDiscoveredAuthority.bind(n),"standardInteractionClientGetDiscoveredAuthority",n.logger,n.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),i=yield T(JE,"generateEarKey",n.logger,n.performanceClient,r)(),s={...e,earJwk:i};return n.browserStorage.cacheAuthorizeRequest(s),(yield UI(document,n.config,o,s,n.logger,n.performanceClient)).submit(),new Promise((c,l)=>{setTimeout(()=>{l(M(Jh,"failed_to_redirect"))},n.config.system.redirectNavigationTimeout)})})()}executeCodeFlowWithPost(e){var n=this;return y(function*(){const r=e.correlationId,o=yield T(n.getDiscoveredAuthority.bind(n),"standardInteractionClientGetDiscoveredAuthority",n.logger,n.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return n.browserStorage.cacheAuthorizeRequest(e),(yield BI(document,n.config,o,e,n.logger,n.performanceClient)).submit(),new Promise((s,a)=>{setTimeout(()=>{a(M(Jh,"failed_to_redirect"))},n.config.system.redirectNavigationTimeout)})})()}handleRedirectPromise(){var e=this;return y(function*(n="",r,o,i){const s=e.initializeServerTelemetryManager(865);try{const[a,c]=e.getRedirectResponse(n||"");if(!a)return e.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),e.browserStorage.resetRequestCache(),"back_forward"!==function i9(){if(typeof window>"u"||typeof window.performance>"u"||"function"!=typeof window.performance.getEntriesByType)return;const t=window.performance.getEntriesByType("navigation");return(t.length?t[0]:void 0)?.type}()?i.event.errorCode="no_server_response":e.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const l=e.browserStorage.getTemporaryCache("request.origin",!0)||w.EMPTY_STRING;if(WO(l)===WO(window.location.href)&&e.config.auth.navigateToLoginRequestUrl)return e.logger.verbose("Current page is loginRequestUrl, handling response"),l.indexOf("#")>-1&&function FQ(t){const e=t.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}(l),yield e.handleResponse(a,r,o,s);if(!e.config.auth.navigateToLoginRequestUrl)return e.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),yield e.handleResponse(a,r,o,s);if(!uI()||e.config.system.allowRedirectInIframe){e.browserStorage.setTemporaryCache("urlHash",c,!0);const f={apiId:865,timeout:e.config.system.redirectNavigationTimeout,noHistory:!0};let h=!0;if(l&&"null"!==l)e.logger.verbose(`Navigating to loginRequestUrl: ${l}`),h=yield e.navigationClient.navigateInternal(l,f);else{const p=function UQ(){const e=new se(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}();e.browserStorage.setTemporaryCache("request.origin",p,!0),e.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),h=yield e.navigationClient.navigateInternal(p,f)}if(!h)return yield e.handleResponse(a,r,o,s)}return null}catch(a){throw a instanceof me&&(a.setCorrelationId(e.correlationId),s.cacheFailedRequest(a)),a}}).apply(this,arguments)}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let n=e;n||(n="query"===this.config.auth.OIDCOptions.serverResponseType?window.location.search:window.location.hash);let r=Ih(n);if(r){try{!function UY(t,e,n){if(!t.state)throw M(al);const r=function LY(t,e){if(!e)return null;try{return Gs.parseRequestState(t,e).libraryState.meta}catch{throw b(no)}}(e,t.state);if(!r)throw M(Dh);if(r.interactionType!==n)throw M(Ah)}(r,this.browserCrypto,U.Redirect)}catch(i){return i instanceof me&&this.logger.error(`Interaction type validation failed due to ${i.errorCode}: ${i.errorMessage}`),[null,""]}return xP(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,n]}const o=this.browserStorage.getTemporaryCache("urlHash",!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey("urlHash")),o&&(r=Ih(o),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,o]):[null,""]}handleResponse(e,n,r,o){var i=this;return y(function*(){if(!e.state)throw M(al);if(e.ear_jwe){const c=yield T(i.getDiscoveredAuthority.bind(i),"standardInteractionClientGetDiscoveredAuthority",i.logger,i.performanceClient,n.correlationId)({requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account});return T(zI,"handleResponseEar",i.logger,i.performanceClient,n.correlationId)(n,e,861,i.config,c,i.browserStorage,i.nativeStorage,i.eventHandler,i.logger,i.performanceClient,i.platformAuthProvider)}const a=yield T(i.createAuthCodeClient.bind(i),"standardInteractionClientCreateAuthCodeClient",i.logger,i.performanceClient,i.correlationId)({serverTelemetryManager:o,requestAuthority:n.authority});return T(_p,"handleResponseCode",i.logger,i.performanceClient,n.correlationId)(n,e,r,861,i.config,a,i.browserStorage,i.nativeStorage,i.eventHandler,i.logger,i.performanceClient,i.platformAuthProvider)})()}initiateAuthRequest(e,n){var r=this;return y(function*(){if(r.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){r.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const o={apiId:861,timeout:r.config.system.redirectNavigationTimeout,noHistory:!1},i=n||r.config.auth.onRedirectNavigate;return"function"==typeof i?(r.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==i(e)?(r.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void(yield r.navigationClient.navigateExternal(e,o))):void r.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")):(r.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void(yield r.navigationClient.navigateExternal(e,o)))}throw r.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),M(Fs)})()}logout(e){var n=this;return y(function*(){n.logger.verbose("logoutRedirect called");const r=n.initializeLogoutRequest(e),o=n.initializeServerTelemetryManager(961);try{n.eventHandler.emitEvent("msal:logoutStart",U.Redirect,e),yield n.clearCacheOnLogout(n.correlationId,r.account);const i={apiId:961,timeout:n.config.system.redirectNavigationTimeout,noHistory:!1},a=(yield T(n.createAuthCodeClient.bind(n),"standardInteractionClientCreateAuthCodeClient",n.logger,n.performanceClient,n.correlationId)({serverTelemetryManager:o,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0})).getLogoutUri(r);if(n.eventHandler.emitEvent("msal:logoutSuccess",U.Redirect,r),!e||"function"!=typeof e.onRedirectNavigate)return n.browserStorage.getInteractionInProgress()||n.browserStorage.setInteractionInProgress(!0,"signout"),void(yield n.navigationClient.navigateExternal(a,i));if(!1!==e.onRedirectNavigate(a))return n.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),n.browserStorage.getInteractionInProgress()||n.browserStorage.setInteractionInProgress(!0,"signout"),void(yield n.navigationClient.navigateExternal(a,i));n.browserStorage.setInteractionInProgress(!1),n.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(i){throw i instanceof me&&(i.setCorrelationId(n.correlationId),o.cacheFailedRequest(i)),n.eventHandler.emitEvent("msal:logoutFailure",U.Redirect,null,i),n.eventHandler.emitEvent("msal:logoutEnd",U.Redirect),i}n.eventHandler.emitEvent("msal:logoutEnd",U.Redirect)})()}getRedirectStartPage(e){const n=e||window.location.href;return se.getAbsoluteUrl(n,vr())}}function a9(t,e,n,r,o){return JI.apply(this,arguments)}function JI(){return(JI=y(function*(t,e,n,r,o){if(e.addQueueMeasurement("silentHandlerInitiateAuthRequest",r),!t)throw n.info("Navigate url is empty"),M(Fs);return o?T(u9,"silentHandlerLoadFrame",n,e,r)(t,o,e,r):Xt(d9,"silentHandlerLoadFrameSync",n,e,r)(t)})).apply(this,arguments)}function c9(t,e,n,r,o){return ZI.apply(this,arguments)}function ZI(){return(ZI=y(function*(t,e,n,r,o){const i=Sp();if(!i.contentDocument)throw"No document associated with iframe!";return(yield BI(i.contentDocument,t,e,n,r,o)).submit(),i})).apply(this,arguments)}function l9(t,e,n,r,o){return XI.apply(this,arguments)}function XI(){return(XI=y(function*(t,e,n,r,o){const i=Sp();if(!i.contentDocument)throw"No document associated with iframe!";return(yield UI(i.contentDocument,t,e,n,r,o)).submit(),i})).apply(this,arguments)}function w0(t,e,n,r,o,i,s){return e_.apply(this,arguments)}function e_(){return(e_=y(function*(t,e,n,r,o,i,s){return r.addQueueMeasurement("silentHandlerMonitorIframeForHash",i),new Promise((a,c)=>{e<1e4&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (10000ms). This may result in timeouts.`);const l=window.setTimeout(()=>{window.clearInterval(u),c(M(Nh))},e),u=window.setInterval(()=>{let d="";const f=t.contentWindow;try{d=f?f.location.href:""}catch{}if(!d||"about:blank"===d)return;let h="";f&&(h="query"===s?f.location.search:f.location.hash),window.clearTimeout(l),window.clearInterval(u),a(h)},n)}).finally(()=>{Xt(f9,"removeHiddenIframe",o,r,i)(t)})})).apply(this,arguments)}function u9(t,e,n,r){return n.addQueueMeasurement("silentHandlerLoadFrame",r),new Promise((o,i)=>{const s=Sp();window.setTimeout(()=>{s?(s.src=t,o(s)):i("Unable to load iframe")},e)})}function d9(t){const e=Sp();return e.src=t,e}function Sp(){const t=document.createElement("iframe");return t.className="msalSilentIframe",t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(t),t}function f9(t){document.body===t.parentNode&&document.body.removeChild(t)}class h9 extends Ks{constructor(e,n,r,o,i,s,a,c,l,u,d){super(e,n,r,o,i,s,c,u,d),this.apiId=a,this.nativeStorage=l}acquireToken(e){var n=this;return y(function*(){n.performanceClient.addQueueMeasurement("silentIframeClientAcquireToken",e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&n.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const r={...e};r.prompt?"none"!==r.prompt&&"no_session"!==r.prompt&&(n.logger.warning(`SilentIframeClient. Replacing invalid prompt ${r.prompt} with none`),r.prompt="none"):r.prompt="none";const o=yield T(n.initializeAuthorizationRequest.bind(n),"standardInteractionClientInitializeAuthorizationRequest",n.logger,n.performanceClient,e.correlationId)(r,U.Silent);return o.platformBroker=Il(n.config,n.logger,n.platformAuthProvider,o.authenticationScheme),HP(o.authority),"EAR"===n.config.auth.protocolMode?n.executeEarFlow(o):n.executeCodeFlow(o)})()}executeCodeFlow(e){var n=this;return y(function*(){let r;const o=n.initializeServerTelemetryManager(n.apiId);try{return r=yield T(n.createAuthCodeClient.bind(n),"standardInteractionClientCreateAuthCodeClient",n.logger,n.performanceClient,e.correlationId)({serverTelemetryManager:o,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),yield T(n.silentTokenHelper.bind(n),"silentIframeClientTokenHelper",n.logger,n.performanceClient,e.correlationId)(r,e)}catch(i){if(i instanceof me&&(i.setCorrelationId(n.correlationId),o.cacheFailedRequest(i)),!(r&&i instanceof me&&"invalid_grant"===i.errorCode))throw i;return n.performanceClient.addFields({retryError:i.errorCode},n.correlationId),yield T(n.silentTokenHelper.bind(n),"silentIframeClientTokenHelper",n.logger,n.performanceClient,n.correlationId)(r,e)}})()}executeEarFlow(e){var n=this;return y(function*(){const r=e.correlationId,o=yield T(n.getDiscoveredAuthority.bind(n),"standardInteractionClientGetDiscoveredAuthority",n.logger,n.performanceClient,r)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),i=yield T(JE,"generateEarKey",n.logger,n.performanceClient,r)(),s={...e,earJwk:i},a=yield T(l9,"silentHandlerInitiateAuthRequest",n.logger,n.performanceClient,r)(n.config,o,s,n.logger,n.performanceClient),c=n.config.auth.OIDCOptions.serverResponseType,l=yield T(w0,"silentHandlerMonitorIframeForHash",n.logger,n.performanceClient,r)(a,n.config.system.iframeHashTimeout,n.config.system.pollIntervalMilliseconds,n.performanceClient,n.logger,r,c),u=Xt(El,"deserializeResponse",n.logger,n.performanceClient,r)(l,c,n.logger);return T(zI,"handleResponseEar",n.logger,n.performanceClient,r)(s,u,n.apiId,n.config,o,n.browserStorage,n.nativeStorage,n.eventHandler,n.logger,n.performanceClient,n.platformAuthProvider)})()}logout(){return Promise.reject(M(Ls))}silentTokenHelper(e,n){var r=this;return y(function*(){const o=n.correlationId;r.performanceClient.addQueueMeasurement("silentIframeClientTokenHelper",o);const i=yield T(Tp,"generatePkceCodes",r.logger,r.performanceClient,o)(r.performanceClient,r.logger,o),s={...n,codeChallenge:i.challenge};let a;if("POST"===n.httpMethod)a=yield T(c9,"silentHandlerInitiateAuthRequest",r.logger,r.performanceClient,o)(r.config,e.authority,s,r.logger,r.performanceClient);else{const d=yield T(FI,"getAuthCodeUrl",r.logger,r.performanceClient,o)(r.config,e.authority,s,r.logger,r.performanceClient);a=yield T(a9,"silentHandlerInitiateAuthRequest",r.logger,r.performanceClient,o)(d,r.performanceClient,r.logger,o,r.config.system.navigateFrameWait)}const c=r.config.auth.OIDCOptions.serverResponseType,l=yield T(w0,"silentHandlerMonitorIframeForHash",r.logger,r.performanceClient,o)(a,r.config.system.iframeHashTimeout,r.config.system.pollIntervalMilliseconds,r.performanceClient,r.logger,o,c),u=Xt(El,"deserializeResponse",r.logger,r.performanceClient,o)(l,c,r.logger);return T(_p,"handleResponseCode",r.logger,r.performanceClient,o)(n,u,i.verifier,r.apiId,r.config,e,r.browserStorage,r.nativeStorage,r.eventHandler,r.logger,r.performanceClient,r.platformAuthProvider)})()}}class g9 extends AI{constructor(e,n){super(e,n)}acquireToken(e){var n=this;return y(function*(){n.performanceClient?.addQueueMeasurement("refreshTokenClientAcquireToken",e.correlationId);const r=$t(),o=yield T(n.executeTokenRequest.bind(n),"refreshTokenClientExecuteTokenRequest",n.logger,n.performanceClient,e.correlationId)(e,n.authority),i=o.headers?.["x-ms-request-id"],s=new ci(n.config.authOptions.clientId,n.cacheManager,n.cryptoUtils,n.logger,n.config.serializableCache,n.config.persistencePlugin);return s.validateTokenResponse(o.body),T(s.handleServerTokenResponse.bind(s),"handleServerTokenResponse",n.logger,n.performanceClient,e.correlationId)(o.body,n.authority,r,e,void 0,void 0,!0,e.forceCache,i)})()}acquireTokenByRefreshToken(e){var n=this;return y(function*(){if(!e)throw Ie(dh);if(n.performanceClient?.addQueueMeasurement("refreshTokenClientAcquireTokenByRefreshToken",e.correlationId),!e.account)throw b(Yc);if(n.cacheManager.isAppMetadataFOCI(e.account.environment))try{return yield T(n.acquireTokenWithCachedRefreshToken.bind(n),"refreshTokenClientAcquireTokenWithCachedRefreshToken",n.logger,n.performanceClient,e.correlationId)(e,!0)}catch(o){if(o instanceof Mn&&o.errorCode===Vs||o instanceof ai&&"invalid_grant"===o.errorCode&&"client_mismatch"===o.subError)return T(n.acquireTokenWithCachedRefreshToken.bind(n),"refreshTokenClientAcquireTokenWithCachedRefreshToken",n.logger,n.performanceClient,e.correlationId)(e,!1);throw o}return T(n.acquireTokenWithCachedRefreshToken.bind(n),"refreshTokenClientAcquireTokenWithCachedRefreshToken",n.logger,n.performanceClient,e.correlationId)(e,!1)})()}acquireTokenWithCachedRefreshToken(e,n){var r=this;return y(function*(){r.performanceClient?.addQueueMeasurement("refreshTokenClientAcquireTokenWithCachedRefreshToken",e.correlationId);const o=Xt(r.cacheManager.getRefreshToken.bind(r.cacheManager),"cacheManagerGetRefreshToken",r.logger,r.performanceClient,e.correlationId)(e.account,n,e.correlationId,void 0,r.performanceClient);if(!o)throw yp(Vs);if(o.expiresOn&&dp(o.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw r.performanceClient?.addFields({rtExpiresOnMs:Number(o.expiresOn)},e.correlationId),yp(II);const i={...e,refreshToken:o.secret,authenticationScheme:e.authenticationScheme||de.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:"home_account_id"}};try{return yield T(r.acquireToken.bind(r),"refreshTokenClientAcquireToken",r.logger,r.performanceClient,e.correlationId)(i)}catch(s){if(s instanceof Mn&&(r.performanceClient?.addFields({rtExpiresOnMs:Number(o.expiresOn)},e.correlationId),s.subError===$s)){r.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const a=r.cacheManager.generateCredentialKey(o);r.cacheManager.removeRefreshToken(a,e.correlationId)}throw s}})()}executeTokenRequest(e,n){var r=this;return y(function*(){r.performanceClient?.addQueueMeasurement("refreshTokenClientExecuteTokenRequest",e.correlationId);const o=r.createTokenQueryParameters(e),i=se.appendQueryString(n.tokenEndpoint,o),s=yield T(r.createTokenRequestBody.bind(r),"refreshTokenClientCreateTokenRequestBody",r.logger,r.performanceClient,e.correlationId)(e),a=r.createTokenRequestHeaders(e.ccsCredential),c=Cp(r.config.authOptions.clientId,e);return T(r.executePostToTokenEndpoint.bind(r),"refreshTokenClientExecutePostToTokenEndpoint",r.logger,r.performanceClient,e.correlationId)(i,s,a,c,e.correlationId,"refreshTokenClientExecutePostToTokenEndpoint")})()}createTokenRequestBody(e){var n=this;return y(function*(){n.performanceClient?.addQueueMeasurement("refreshTokenClientCreateTokenRequestBody",e.correlationId);const r=new Map;if(kE(r,e.embeddedClientId||e.tokenBodyParameters?.[oi]||n.config.authOptions.clientId),e.redirectUri&&OE(r,e.redirectUri),NE(r,e.scopes,!0,n.config.authOptions.authority.options.OIDCOptions?.defaultScopes),vP(r,"refresh_token"),UE(r),FE(r,n.config.libraryInfo),LE(r,n.config.telemetry.application),TP(r),n.serverTelemetryManager&&!nP(n.config)&&_P(r,n.serverTelemetryManager),function vQ(t,e){t.set("refresh_token",e)}(r,e.refreshToken),n.config.clientCredentials.clientSecret&&gP(r,n.config.clientCredentials.clientSecret),n.config.clientCredentials.clientAssertion){const o=n.config.clientCredentials.clientAssertion;mP(r,yield d0(o.assertion,n.config.authOptions.clientId,e.resourceRequestUri)),yP(r,o.assertionType)}if(e.authenticationScheme===de.POP){const o=new qs(n.cryptoUtils,n.performanceClient);let i;i=e.popKid?n.cryptoUtils.encodeKid(e.popKid):(yield T(o.generateCnf.bind(o),"popTokenGenerateCnf",n.logger,n.performanceClient,e.correlationId)(e,n.logger)).reqCnfString,HE(r,i)}else if(e.authenticationScheme===de.SSH){if(!e.sshJwk)throw Ie(Os);IP(r,e.sshJwk)}if((!Zt.isEmptyObj(e.claims)||n.config.authOptions.clientCapabilities&&n.config.authOptions.clientCapabilities.length>0)&&PE(r,e.claims,n.config.authOptions.clientCapabilities),n.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case"home_account_id":try{pl(r,zs(e.ccsCredential.credential))}catch(o){n.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case"UPN":op(r,e.ccsCredential.credential)}return e.embeddedClientId&&ip(r,n.config.authOptions.clientId,n.config.authOptions.redirectUri),e.tokenBodyParameters&&oo(r,e.tokenBodyParameters),np(r,e.correlationId,n.performanceClient),ol(r)})()}}class m9 extends Ks{acquireToken(e){var n=this;return y(function*(){n.performanceClient.addQueueMeasurement("silentRefreshClientAcquireToken",e.correlationId);const r=yield T(MI,"initializeBaseRequest",n.logger,n.performanceClient,e.correlationId)(e,n.config,n.performanceClient,n.logger),o={...e,...r};e.redirectUri&&(o.redirectUri=n.getRedirectUri(e.redirectUri));const i=n.initializeServerTelemetryManager(61),s=yield n.createRefreshTokenClient({serverTelemetryManager:i,authorityUrl:o.authority,azureCloudOptions:o.azureCloudOptions,account:o.account});return T(s.acquireTokenByRefreshToken.bind(s),"refreshTokenClientAcquireTokenByRefreshToken",n.logger,n.performanceClient,e.correlationId)(o).catch(a=>{throw a.setCorrelationId(n.correlationId),i.cacheFailedRequest(a),a})})()}logout(){return Promise.reject(M(Ls))}createRefreshTokenClient(e){var n=this;return y(function*(){const r=yield T(n.getClientConfiguration.bind(n),"standardInteractionClientGetClientConfiguration",n.logger,n.performanceClient,n.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new g9(r,n.performanceClient)})()}}class y9{constructor(e,n,r,o){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=n,this.logger=r,this.cryptoObj=o}loadExternalTokens(e,n,r){var o=this;return y(function*(){if(!o.isBrowserEnvironment)throw M(Us);const i=e.correlationId||bn(),s=n.id_token?Ps(n.id_token,An):void 0,a={protocolMode:o.config.auth.protocolMode,knownAuthorities:o.config.auth.knownAuthorities,cloudDiscoveryMetadata:o.config.auth.cloudDiscoveryMetadata,authorityMetadata:o.config.auth.authorityMetadata,skipAuthorityMetadataCache:o.config.auth.skipAuthorityMetadataCache},c=e.authority?new pt(pt.generateAuthority(e.authority,e.azureCloudOptions),o.config.system.networkClient,o.storage,a,o.logger,e.correlationId||bn()):void 0,l=yield o.loadAccount(e,r.clientInfo||n.client_info||"",i,s,c),u=yield o.loadIdToken(n,l.homeAccountId,l.environment,l.realm,i),d=yield o.loadAccessToken(e,n,l.homeAccountId,l.environment,l.realm,r,i),f=yield o.loadRefreshToken(n,l.homeAccountId,l.environment,i);return o.generateAuthenticationResult(e,{account:l,idToken:u,accessToken:d,refreshToken:f},s,c)})()}loadAccount(e,n,r,o,i){var s=this;return y(function*(){if(s.logger.verbose("TokenCache - loading account"),e.account){const u=Nn.createFromAccountInfo(e.account);return yield s.storage.setAccount(u,r),u}if(!i||!n&&!o)throw s.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),M(Bh);const a=Nn.generateHomeAccountId(n,i.authorityType,s.logger,s.cryptoObj,o),c=o?.tid,l=bI(s.storage,i,a,An,r,o,n,i.hostnameAndPort,c,void 0,void 0,s.logger);return yield s.storage.setAccount(l,r),l})()}loadIdToken(e,n,r,o,i){var s=this;return y(function*(){if(!e.id_token)return s.logger.verbose("TokenCache - no id token found in response"),null;s.logger.verbose("TokenCache - loading id token");const a=fp(n,r,e.id_token,s.config.auth.clientId,o);return yield s.storage.setIdTokenCredential(a,i),a})()}loadAccessToken(e,n,r,o,i,s,a){var c=this;return y(function*(){if(!n.access_token)return c.logger.verbose("TokenCache - no access token found in response"),null;if(!n.expires_in)return c.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!(n.scope||e.scopes&&e.scopes.length))return c.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;c.logger.verbose("TokenCache - loading access token");const l=n.scope?Xe.fromString(n.scope):new Xe(e.scopes),u=s.expiresOn||n.expires_in+$t(),d=s.extendedExpiresOn||(n.ext_expires_in||n.expires_in)+$t(),f=hp(r,o,n.access_token,c.config.auth.clientId,i,l.printScopes(),u,d,An);return yield c.storage.setAccessTokenCredential(f,a),f})()}loadRefreshToken(e,n,r,o){var i=this;return y(function*(){if(!e.refresh_token)return i.logger.verbose("TokenCache - no refresh token found in response"),null;i.logger.verbose("TokenCache - loading refresh token");const s=YP(n,r,e.refresh_token,i.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return yield i.storage.setRefreshTokenCredential(s,o),s})()}generateAuthenticationResult(e,n,r,o){let c,i="",s=[],a=null;n?.accessToken&&(i=n.accessToken.secret,s=Xe.fromString(n.accessToken.target).asArray(),a=js(n.accessToken.expiresOn),c=js(n.accessToken.extendedExpiresOn));const l=n.account;return{authority:o?o.canonicalAuthority:"",uniqueId:n.account.localAccountId,tenantId:n.account.realm,scopes:s,account:l.getAccountInfo(),idToken:n.idToken?.secret||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:a,correlationId:e.correlationId||"",requestId:"",extExpiresOn:c,familyId:n.refreshToken?.familyId||"",tokenType:n?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:l.cloudGraphHostName||"",msGraphHost:l.msGraphHost||"",fromNativeBroker:!1}}}class v9 extends f0{constructor(e){super(e),this.includeRedirectUri=!1}}class C9 extends Ks{constructor(e,n,r,o,i,s,a,c,l,u){super(e,n,r,o,i,s,c,l,u),this.apiId=a}acquireToken(e){var n=this;return y(function*(){if(!e.code)throw M(jh);const r=yield T(n.initializeAuthorizationRequest.bind(n),"standardInteractionClientInitializeAuthorizationRequest",n.logger,n.performanceClient,e.correlationId)(e,U.Silent),o=n.initializeServerTelemetryManager(n.apiId);try{const i={...r,code:e.code},s=yield T(n.getClientConfiguration.bind(n),"standardInteractionClientGetClientConfiguration",n.logger,n.performanceClient,e.correlationId)({serverTelemetryManager:o,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),a=new v9(s);n.logger.verbose("Auth code client created");const c=new v0(a,n.browserStorage,i,n.logger,n.performanceClient);return yield T(c.handleCodeResponseFromServer.bind(c),"handleCodeResponseFromServer",n.logger,n.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},r,!1)}catch(i){throw i instanceof me&&(i.setCorrelationId(n.correlationId),o.cacheFailedRequest(i)),i}})()}logout(){return Promise.reject(M(Ls))}}function Xn(t){const e=t?.idTokenClaims;return e?.tfp||e?.acr?"B2C":e?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===e?.tid?"MSA":"AAD":void 0}function Dp(t,e){try{dI(t)}catch(n){throw e.end({success:!1},n),n}}class Ap{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new up(this.logger,this.performanceClient):sh,this.eventHandler=new NY(this.logger),this.browserStorage=this.isBrowserEnvironment?new SI(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,function fY(t){const e=t.cloudDiscoveryMetadata;let n;if(e)try{n=JSON.parse(e)}catch{throw Ie(rl)}return{canonicalAuthority:t.authority?t0(t.authority):void 0,knownAuthorities:t.knownAuthorities,cloudDiscoveryMetadata:n}}(this.config.auth)):(()=>new SI(this.config.auth.clientId,{cacheLocation:"memoryStorage",cacheRetentionDays:5,temporaryCacheLocation:"memoryStorage",storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},sh,this.logger,this.performanceClient,this.eventHandler))(),this.nativeInternalStorage=new SI(this.config.auth.clientId,{cacheLocation:"memoryStorage",cacheRetentionDays:5,temporaryCacheLocation:"memoryStorage",storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new y9(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static createController(e,n){return y(function*(){const r=new Ap(e);return yield r.initialize(n),r})()}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}initialize(e,n){var r=this;return y(function*(){if(r.logger.trace("initialize called"),r.initialized)return void r.logger.info("initialize has already been called, exiting early.");if(!r.isBrowserEnvironment)return r.logger.info("in non-browser environment, exiting early."),r.initialized=!0,void r.eventHandler.emitEvent("msal:initializeEnd");const o=e?.correlationId||r.getRequestCorrelationId(),i=r.config.system.allowPlatformBroker,s=r.performanceClient.startMeasurement("initializeClientApplication",o);if(r.eventHandler.emitEvent("msal:initializeStart"),!n)try{r.logMultipleInstances(s)}catch{}if(yield T(r.browserStorage.initialize.bind(r.browserStorage),"initializeCache",r.logger,r.performanceClient,o)(o),i)try{r.platformAuthProvider=yield function T0(t,e,n,r){return YI.apply(this,arguments)}(r.logger,r.performanceClient,o,r.config.system.nativeBrokerHandshakeTimeout)}catch(a){r.logger.verbose(a)}r.config.cache.claimsBasedCachingEnabled||(r.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),Xt(r.browserStorage.clearTokensAndKeysWithClaims.bind(r.browserStorage),"clearTokensAndKeysWithClaims",r.logger,r.performanceClient,o)(o)),r.config.system.asyncPopups&&(yield r.preGeneratePkceCodes(o)),r.initialized=!0,r.eventHandler.emitEvent("msal:initializeEnd"),s.end({allowPlatformBroker:i,success:!0})})()}handleRedirectPromise(e){var n=this;return y(function*(){if(n.logger.verbose("handleRedirectPromise called"),LP(n.initialized),n.isBrowserEnvironment){const r=e||"";let o=n.redirectResponse.get(r);return typeof o>"u"?(o=n.handleRedirectPromiseInternal(e),n.redirectResponse.set(r,o),n.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):n.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),o}return n.logger.verbose("handleRedirectPromise returns null, not browser environment"),null})()}handleRedirectPromiseInternal(e){var n=this;return y(function*(){if(!n.browserStorage.isInteractionInProgress(!0))return n.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;if("signout"===n.browserStorage.getInteractionInProgress()?.type)return n.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),n.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);const o=n.getAllAccounts(),i=n.browserStorage.getCachedNativeRequest(),s=i&&n.platformAuthProvider&&!e;let a,c;n.eventHandler.emitEvent("msal:handleRedirectStart",U.Redirect);try{if(s&&n.platformAuthProvider){a=n.performanceClient.startMeasurement("acquireTokenRedirect",i?.correlationId||""),n.logger.trace("handleRedirectPromise - acquiring token from native platform"),a.add({isPlatformBrokerRequest:!0});const l=new Ip(n.config,n.browserStorage,n.browserCrypto,n.logger,n.eventHandler,n.navigationClient,865,n.performanceClient,n.platformAuthProvider,i.accountId,n.nativeInternalStorage,i.correlationId);c=T(l.handleRedirectPromise.bind(l),"handleNativeRedirectPromise",n.logger,n.performanceClient,a.event.correlationId)(n.performanceClient,a.event.correlationId)}else{const[l,u]=n.browserStorage.getCachedRequest(),d=l.correlationId;a=n.performanceClient.startMeasurement("acquireTokenRedirect",d),n.logger.trace("handleRedirectPromise - acquiring token from web flow");const f=n.createRedirectClient(d);c=T(f.handleRedirectPromise.bind(f),"handleRedirectPromise",n.logger,n.performanceClient,a.event.correlationId)(e,l,u,a)}}catch(l){throw n.browserStorage.resetRequestCache(),l}return c.then(l=>(l?(n.browserStorage.resetRequestCache(),o.length<n.getAllAccounts().length?(n.eventHandler.emitEvent("msal:loginSuccess",U.Redirect,l),n.logger.verbose("handleRedirectResponse returned result, login success")):(n.eventHandler.emitEvent("msal:acquireTokenSuccess",U.Redirect,l),n.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:Xn(l.account)})):a.event.errorCode?a.end({success:!1}):a.discard(),n.eventHandler.emitEvent("msal:handleRedirectEnd",U.Redirect),l)).catch(l=>{n.browserStorage.resetRequestCache();const u=l;throw n.eventHandler.emitEvent(o.length>0?"msal:acquireTokenFailure":"msal:loginFailure",U.Redirect,null,u),n.eventHandler.emitEvent("msal:handleRedirectEnd",U.Redirect),a.end({success:!1},u),l})})()}acquireTokenRedirect(e){var n=this;return y(function*(){const r=n.getRequestCorrelationId(e);n.logger.verbose("acquireTokenRedirect called",r);const o=n.performanceClient.startMeasurement("acquireTokenPreRedirect",r);o.add({accountType:Xn(e.account),scenarioId:e.scenarioId});const i=e.onRedirectNavigate;if(i)e.onRedirectNavigate=a=>{const c="function"==typeof i?i(a):void 0;return o.add({navigateCallbackResult:!1!==c}),o.event=o.end({success:!0})||o.event,c};else{const a=n.config.auth.onRedirectNavigate;n.config.auth.onRedirectNavigate=c=>{const l="function"==typeof a?a(c):void 0;return o.add({navigateCallbackResult:!1!==l}),o.event=o.end({success:!0})||o.event,l}}const s=n.getAllAccounts().length>0;try{let a;return UP(n.initialized,n.config),n.browserStorage.setInteractionInProgress(!0,"signin"),n.eventHandler.emitEvent(s?"msal:acquireTokenStart":"msal:loginStart",U.Redirect,e),a=n.platformAuthProvider&&n.canUsePlatformBroker(e)?new Ip(n.config,n.browserStorage,n.browserCrypto,n.logger,n.eventHandler,n.navigationClient,861,n.performanceClient,n.platformAuthProvider,n.getNativeAccountId(e),n.nativeInternalStorage,r).acquireTokenRedirect(e,o).catch(l=>{if(o.add({brokerErrorName:l.name,brokerErrorCode:l.errorCode}),l instanceof Zn&&Ws(l))return n.platformAuthProvider=void 0,n.createRedirectClient(r).acquireToken(e);if(l instanceof Mn)return n.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),n.createRedirectClient(r).acquireToken(e);throw l}):n.createRedirectClient(r).acquireToken(e),yield a}catch(a){throw n.browserStorage.resetRequestCache(),2===o.event.status?n.performanceClient.startMeasurement("acquireTokenRedirect",r).end({success:!1},a):o.end({success:!1},a),n.eventHandler.emitEvent(s?"msal:acquireTokenFailure":"msal:loginFailure",U.Redirect,null,a),a}})()}acquireTokenPopup(e){var n=this;const r=this.getRequestCorrelationId(e),o=this.performanceClient.startMeasurement("acquireTokenPopup",r);o.add({scenarioId:e.scenarioId,accountType:Xn(e.account)});try{this.logger.verbose("acquireTokenPopup called",r),Dp(this.initialized,o),this.browserStorage.setInteractionInProgress(!0,"signin")}catch(c){return Promise.reject(c)}const i=this.getAllAccounts();let s;this.eventHandler.emitEvent(i.length>0?"msal:acquireTokenStart":"msal:loginStart",U.Popup,e);const a=this.getPreGeneratedPkceCodes(r);return this.canUsePlatformBroker(e)?(o.add({isPlatformBrokerRequest:!0}),s=this.acquireTokenNative({...e,correlationId:r},862).then(c=>(o.end({success:!0,accountType:Xn(c.account)}),c)).catch(c=>{if(o.add({brokerErrorName:c.name,brokerErrorCode:c.errorCode}),c instanceof Zn&&Ws(c))return this.platformAuthProvider=void 0,this.createPopupClient(r).acquireToken(e,a);if(c instanceof Mn)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(r).acquireToken(e,a);throw c})):s=this.createPopupClient(r).acquireToken(e,a),s.then(c=>(i.length<this.getAllAccounts().length?this.eventHandler.emitEvent("msal:loginSuccess",U.Popup,c):this.eventHandler.emitEvent("msal:acquireTokenSuccess",U.Popup,c),o.end({success:!0,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length,accountType:Xn(c.account)}),c)).catch(c=>(this.eventHandler.emitEvent(i.length>0?"msal:acquireTokenFailure":"msal:loginFailure",U.Popup,null,c),o.end({success:!1},c),Promise.reject(c))).finally(y(function*(){n.browserStorage.setInteractionInProgress(!1),n.config.system.asyncPopups&&(yield n.preGeneratePkceCodes(r))}))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}ssoSilent(e){var n=this;return y(function*(){const r=n.getRequestCorrelationId(e),o={...e,prompt:e.prompt,correlationId:r};let i;return n.ssoSilentMeasurement=n.performanceClient.startMeasurement("ssoSilent",r),n.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:Xn(e.account)}),Dp(n.initialized,n.ssoSilentMeasurement),n.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",n.trackPageVisibilityWithMeasurement),n.logger.verbose("ssoSilent called",r),n.eventHandler.emitEvent("msal:ssoSilentStart",U.Silent,o),n.canUsePlatformBroker(o)?(n.ssoSilentMeasurement?.add({isPlatformBrokerRequest:!0}),i=n.acquireTokenNative(o,863).catch(s=>{if(n.ssoSilentMeasurement?.add({brokerErrorName:s.name,brokerErrorCode:s.errorCode}),s instanceof Zn&&Ws(s))return n.platformAuthProvider=void 0,n.createSilentIframeClient(o.correlationId).acquireToken(o);throw s})):i=n.createSilentIframeClient(o.correlationId).acquireToken(o),i.then(s=>(n.eventHandler.emitEvent("msal:ssoSilentSuccess",U.Silent,s),n.ssoSilentMeasurement?.end({success:!0,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:Xn(s.account)}),s)).catch(s=>{throw n.eventHandler.emitEvent("msal:ssoSilentFailure",U.Silent,null,s),n.ssoSilentMeasurement?.end({success:!1},s),s}).finally(()=>{document.removeEventListener("visibilitychange",n.trackPageVisibilityWithMeasurement)})})()}acquireTokenByCode(e){var n=this;return y(function*(){const r=n.getRequestCorrelationId(e);n.logger.trace("acquireTokenByCode called",r);const o=n.performanceClient.startMeasurement("acquireTokenByCode",r);Dp(n.initialized,o),n.eventHandler.emitEvent("msal:acquireTokenByCodeStart",U.Silent,e),o.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw M($h);if(e.code){const i=e.code;let s=n.hybridAuthCodeResponses.get(i);return s?(n.logger.verbose("Existing acquireTokenByCode request found",r),o.discard()):(n.logger.verbose("Initiating new acquireTokenByCode request",r),s=n.acquireTokenByCodeAsync({...e,correlationId:r}).then(a=>(n.eventHandler.emitEvent("msal:acquireTokenByCodeSuccess",U.Silent,a),n.hybridAuthCodeResponses.delete(i),o.end({success:!0,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:Xn(a.account)}),a)).catch(a=>{throw n.hybridAuthCodeResponses.delete(i),n.eventHandler.emitEvent("msal:acquireTokenByCodeFailure",U.Silent,null,a),o.end({success:!1},a),a}),n.hybridAuthCodeResponses.set(i,s)),yield s}if(e.nativeAccountId){if(n.canUsePlatformBroker(e,e.nativeAccountId)){o.add({isPlatformBrokerRequest:!0});const i=yield n.acquireTokenNative({...e,correlationId:r},866,e.nativeAccountId).catch(s=>{throw s instanceof Zn&&Ws(s)&&(n.platformAuthProvider=void 0),o.add({brokerErrorName:s.name,brokerErrorCode:s.errorCode}),s});return o.end({accountType:Xn(i.account),success:!0}),i}throw M(zh)}throw M(Vh)}catch(i){throw n.eventHandler.emitEvent("msal:acquireTokenByCodeFailure",U.Silent,null,i),o.end({success:!1},i),i}})()}acquireTokenByCodeAsync(e){var n=this;return y(function*(){return n.logger.trace("acquireTokenByCodeAsync called",e.correlationId),n.acquireTokenByCodeAsyncMeasurement=n.performanceClient.startMeasurement("acquireTokenByCodeAsync",e.correlationId),n.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",n.trackPageVisibilityWithMeasurement),yield n.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(i=>(n.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:i.fromCache}),i)).catch(i=>{throw n.acquireTokenByCodeAsyncMeasurement?.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",n.trackPageVisibilityWithMeasurement)})})()}acquireTokenFromCache(e,n){var r=this;return y(function*(){switch(r.performanceClient.addQueueMeasurement("acquireTokenFromCache",e.correlationId),n){case 0:case 1:case 2:const o=r.createSilentCacheClient(e.correlationId);return T(o.acquireToken.bind(o),"silentCacheClientAcquireToken",r.logger,r.performanceClient,e.correlationId)(e);default:throw b(Qn)}})()}acquireTokenByRefreshToken(e,n){var r=this;return y(function*(){switch(r.performanceClient.addQueueMeasurement("acquireTokenByRefreshToken",e.correlationId),n){case 0:case 2:case 3:case 4:const o=r.createSilentRefreshClient(e.correlationId);return T(o.acquireToken.bind(o),"silentRefreshClientAcquireToken",r.logger,r.performanceClient,e.correlationId)(e);default:throw b(Qn)}})()}acquireTokenBySilentIframe(e){var n=this;return y(function*(){n.performanceClient.addQueueMeasurement("acquireTokenBySilentIframe",e.correlationId);const r=n.createSilentIframeClient(e.correlationId);return T(r.acquireToken.bind(r),"silentIframeClientAcquireToken",n.logger,n.performanceClient,e.correlationId)(e)})()}logout(e){var n=this;return y(function*(){const r=n.getRequestCorrelationId(e);return n.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",r),n.logoutRedirect({correlationId:r,...e})})()}logoutRedirect(e){var n=this;return y(function*(){const r=n.getRequestCorrelationId(e);return UP(n.initialized,n.config),n.browserStorage.setInteractionInProgress(!0,"signout"),n.createRedirectClient(r).logout(e)})()}logoutPopup(e){try{const n=this.getRequestCorrelationId(e);return dI(this.initialized),this.browserStorage.setInteractionInProgress(!0,"signout"),this.createPopupClient(n).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(n){return Promise.reject(n)}}clearCache(e){var n=this;return y(function*(){if(!n.isBrowserEnvironment)return void n.logger.info("in non-browser environment, returning early.");const r=n.getRequestCorrelationId(e);return n.createSilentCacheClient(r).logout(e)})()}getAllAccounts(e){const n=this.getRequestCorrelationId();return function TY(t,e,n,r,o){return t.verbose("getAllAccounts called"),n?e.getAllAccounts(o||{},r):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,n,e)}getAccount(e){const n=this.getRequestCorrelationId();return function wY(t,e,n,r){const o=n.getAccountInfoFilteredBy(t,r);return o?(e.verbose("getAccount: Account matching provided filter found, returning"),o):(e.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,n)}getAccountByUsername(e){const n=this.getRequestCorrelationId();return function SY(t,e,n,r){if(e.trace("getAccountByUsername called"),!t)return e.warning("getAccountByUsername: No username provided"),null;const o=n.getAccountInfoFilteredBy({username:t},r);return o?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${t}`),o):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,n)}getAccountByHomeId(e){const n=this.getRequestCorrelationId();return function DY(t,e,n,r){if(e.trace("getAccountByHomeId called"),!t)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const o=n.getAccountInfoFilteredBy({homeAccountId:t},r);return o?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${t}`),o):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,n)}getAccountByLocalId(e){const n=this.getRequestCorrelationId();return function AY(t,e,n,r){if(e.trace("getAccountByLocalId called"),!t)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const o=n.getAccountInfoFilteredBy({localAccountId:t},r);return o?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${t}`),o):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,n)}setActiveAccount(e){const n=this.getRequestCorrelationId();!function bY(t,e,n){e.setActiveAccount(t,n)}(e,this.browserStorage,n)}getActiveAccount(){const e=this.getRequestCorrelationId();return function RY(t,e){return t.getActiveAccount(e)}(this.browserStorage,e)}hydrateCache(e,n){var r=this;return y(function*(){r.logger.verbose("hydrateCache called");const o=Nn.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return yield r.browserStorage.setAccount(o,e.correlationId),e.fromNativeBroker?(r.logger.verbose("Response was from native broker, storing in-memory"),r.nativeInternalStorage.hydrateCache(e,n)):r.browserStorage.hydrateCache(e,n)})()}acquireTokenNative(e,n,r,o){var i=this;return y(function*(){if(i.logger.trace("acquireTokenNative called"),!i.platformAuthProvider)throw M(dl);return new Ip(i.config,i.browserStorage,i.browserCrypto,i.logger,i.eventHandler,i.navigationClient,n,i.performanceClient,i.platformAuthProvider,r||i.getNativeAccountId(e),i.nativeInternalStorage,e.correlationId).acquireToken(e,o)})()}canUsePlatformBroker(e,n){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!Il(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case"none":case"consent":case"login":this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!(!n&&!this.getNativeAccountId(e)&&(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),1))}getNativeAccountId(e){const n=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return n&&n.nativeAccountId||""}createPopupClient(e){return new o9(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new s9(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new h9(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,863,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new E0(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new m9(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new C9(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,866,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,n){return this.eventHandler.addEventCallback(e,n)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return FP(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){"localStorage"===this.config.cache.cacheLocation?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){"localStorage"===this.config.cache.cacheLocation?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,n){this.browserStorage.setWrapperMetadata(e,n)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?bn():w.EMPTY_STRING}loginRedirect(e){var n=this;return y(function*(){const r=n.getRequestCorrelationId(e);return n.logger.verbose("loginRedirect called",r),n.acquireTokenRedirect({correlationId:r,...e||UO})})()}loginPopup(e){const n=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",n),this.acquireTokenPopup({correlationId:n,...e||UO})}acquireTokenSilent(e){var n=this;return y(function*(){const r=n.getRequestCorrelationId(e),o=n.performanceClient.startMeasurement("acquireTokenSilent",r);o.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Dp(n.initialized,o),n.logger.verbose("acquireTokenSilent called",r);const i=e.account||n.getActiveAccount();if(!i)throw M(xh);return o.add({accountType:Xn(i)}),n.acquireTokenSilentDeduped(e,i,r).then(s=>(o.end({success:!0,fromCache:s.fromCache,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length}),{...s,state:e.state,correlationId:r})).catch(s=>{throw s instanceof me&&s.setCorrelationId(r),o.end({success:!1},s),s})})()}acquireTokenSilentDeduped(e,n,r){var o=this;return y(function*(){const i=Cp(o.config.auth.clientId,{...e,authority:e.authority||o.config.auth.authority,correlationId:r},n.homeAccountId),s=JSON.stringify(i),a=o.activeSilentTokenRequests.get(s);if(typeof a>"u"){o.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),o.performanceClient.addFields({deduped:!1},r);const c=T(o.acquireTokenSilentAsync.bind(o),"acquireTokenSilentAsync",o.logger,o.performanceClient,r)({...e,correlationId:r},n);return o.activeSilentTokenRequests.set(s,c),c.finally(()=>{o.activeSilentTokenRequests.delete(s)})}return o.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),o.performanceClient.addFields({deduped:!0},r),a})()}acquireTokenSilentAsync(e,n){var r=this;return y(function*(){const o=()=>r.trackPageVisibility(e.correlationId);r.performanceClient.addQueueMeasurement("acquireTokenSilentAsync",e.correlationId),r.eventHandler.emitEvent("msal:acquireTokenStart",U.Silent,e),e.correlationId&&r.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",o);const i=yield T(FY,"initializeSilentRequest",r.logger,r.performanceClient,e.correlationId)(e,n,r.config,r.performanceClient,r.logger),s=e.cacheLookupPolicy||0;return r.acquireTokenSilentNoIframe(i,s).catch(function(){var c=y(function*(l){if(function I9(t,e){const o=!(t instanceof Mn&&t.subError!==$s)&&("invalid_grant"===t.errorCode||t.errorCode===Qn)||t.errorCode===Vs||t.errorCode===II,i=i5.includes(e);return o&&i}(l,s)){if(r.activeIframeRequest){if(5!==s){const[d,f]=r.activeIframeRequest;r.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${f}`,i.correlationId);const h=r.performanceClient.startMeasurement("awaitConcurrentIframe",i.correlationId);h.add({awaitIframeCorrelationId:f});const p=yield d;if(h.end({success:p}),p)return r.logger.verbose(`Parallel iframe request with correlationId: ${f} succeeded. Retrying cache and/or RT redemption`,i.correlationId),r.acquireTokenSilentNoIframe(i,s);throw r.logger.info(`Iframe request with correlationId: ${f} failed. Interaction is required.`),l}return r.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",i.correlationId),T(r.acquireTokenBySilentIframe.bind(r),"acquireTokenBySilentIframe",r.logger,r.performanceClient,i.correlationId)(i)}{let d;return r.activeIframeRequest=[new Promise(f=>{d=f}),i.correlationId],r.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",i.correlationId),T(r.acquireTokenBySilentIframe.bind(r),"acquireTokenBySilentIframe",r.logger,r.performanceClient,i.correlationId)(i).then(f=>(d(!0),f)).catch(f=>{throw d(!1),f}).finally(()=>{r.activeIframeRequest=void 0})}}throw l});return function(l){return c.apply(this,arguments)}}()).then(c=>(r.eventHandler.emitEvent("msal:acquireTokenSuccess",U.Silent,c),e.correlationId&&r.performanceClient.addFields({fromCache:c.fromCache},e.correlationId),c)).catch(c=>{throw r.eventHandler.emitEvent("msal:acquireTokenFailure",U.Silent,null,c),c}).finally(()=>{document.removeEventListener("visibilitychange",o)})})()}acquireTokenSilentNoIframe(e,n){var r=this;return y(function*(){return Il(r.config,r.logger,r.platformAuthProvider,e.authenticationScheme)&&e.account.nativeAccountId?(r.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),r.performanceClient.addFields({isPlatformBrokerRequest:!0},e.correlationId),r.acquireTokenNative(e,61,e.account.nativeAccountId,n).catch(function(){var o=y(function*(i){throw r.performanceClient.addFields({brokerErrorName:i.name,brokerErrorCode:i.errorCode},e.correlationId),i instanceof Zn&&Ws(i)?(r.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),r.platformAuthProvider=void 0,b(Qn)):i});return function(i){return o.apply(this,arguments)}}())):(r.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),1===n&&r.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),T(r.acquireTokenFromCache.bind(r),"acquireTokenFromCache",r.logger,r.performanceClient,e.correlationId)(e,n).catch(o=>{if(1===n)throw o;return r.eventHandler.emitEvent("msal:acquireTokenFromNetworkStart",U.Silent,e),T(r.acquireTokenByRefreshToken.bind(r),"acquireTokenByRefreshToken",r.logger,r.performanceClient,e.correlationId)(e,n)}))})()}preGeneratePkceCodes(e){var n=this;return y(function*(){return n.logger.verbose("Generating new PKCE codes"),n.pkceCode=yield T(Tp,"generatePkceCodes",n.logger,n.performanceClient,e)(n.performanceClient,n.logger,e),Promise.resolve()})()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const n=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose((n?"Found":"Did not find")+" pre-generated PKCE codes"),this.performanceClient.addFields({usePreGeneratedPkce:!!n},e),n}logMultipleInstances(e){const n=this.config.auth.clientId;window&&(window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[],window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(n),function E9(t,e,n){const r=window.msal?.clientIds||[],o=r.length,i=r.filter(s=>s===t).length;i>1&&n.warning("There is already an instance of MSAL.js in the window with the same client id."),e.add({msalInstanceCount:o,sameClientIdInstanceCount:i})}(n,e,this.logger))}}function t_(){return(t_=y(function*(t,e){const n=new zP(t);return yield n.initialize(),Ap.createController(n,e)})).apply(this,arguments)}class _l{static createPublicClientApplication(e){return y(function*(){const n=yield function _9(t,e){return t_.apply(this,arguments)}(e);return new _l(e,n)})()}constructor(e,n){this.isBroker=!1,this.controller=n||new Ap(new zP(e))}initialize(e){var n=this;return y(function*(){return n.controller.initialize(e,n.isBroker)})()}acquireTokenPopup(e){var n=this;return y(function*(){return n.controller.acquireTokenPopup(e)})()}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,n){return this.controller.addEventCallback(e,n)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,n){return this.controller.initializeWrapperLibrary(e,n)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}hydrateCache(e,n){var r=this;return y(function*(){return r.controller.hydrateCache(e,n)})()}clearCache(e){return this.controller.clearCache(e)}}function i_(){return(i_=y(function*(){const t=new _l(J6);yield t.initialize(),yield function P8(t,e){return AG({rootComponent:t,...BN(e)})}(d5,{providers:[l3(),{provide:qC,useValue:t},VO,jO]})})).apply(this,arguments)}(function w9(){return i_.apply(this,arguments)})().catch(t=>console.error(t))}},Qs=>{Qs(Qs.s=141)}]);